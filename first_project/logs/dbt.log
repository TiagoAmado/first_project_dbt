

============================== 2022-06-04 13:42:15.174115 | 14f38ac9-5298-4ac6-a7bf-e1e684692153 ==============================
13:42:15.174126 [info ] [MainThread]: Running with dbt=1.1.0
13:42:15.174538 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
13:42:15.174770 [debug] [MainThread]: Tracking: tracking
13:42:15.185361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb604679d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb60467c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb60467a60>]}
13:42:15.252260 [debug] [MainThread]: Executing "git --help"
13:42:15.273746 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:42:15.274279 [debug] [MainThread]: STDERR: "b''"
13:42:15.281508 [debug] [MainThread]: Acquiring new postgres connection "debug"
13:42:15.281963 [debug] [MainThread]: Using postgres connection "debug"
13:42:15.282050 [debug] [MainThread]: On debug: select 1 as id
13:42:15.282118 [debug] [MainThread]: Opening a new connection, currently in state init
13:42:15.317023 [debug] [MainThread]: SQL status: SELECT 1 in 0.03 seconds
13:42:15.317887 [debug] [MainThread]: On debug: Close
13:42:15.318282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5ec67e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5ec58e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5ec58280>]}
13:42:16.370708 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-04 14:18:09.565319 | 1ba25fc6-927f-4fef-9f5d-c5d206496f8e ==============================
14:18:09.565336 [info ] [MainThread]: Running with dbt=1.1.0
14:18:09.565759 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:18:09.565856 [debug] [MainThread]: Tracking: tracking
14:18:09.568576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec56e5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec56e5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec56e50a0>]}
14:18:09.586557 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
14:18:09.586877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1ba25fc6-927f-4fef-9f5d-c5d206496f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec569e6d0>]}
14:18:09.630145 [debug] [MainThread]: Parsing macros/catalog.sql
14:18:09.634858 [debug] [MainThread]: Parsing macros/relations.sql
14:18:09.636738 [debug] [MainThread]: Parsing macros/adapters.sql
14:18:09.653709 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
14:18:09.654957 [debug] [MainThread]: Parsing macros/materializations/configs.sql
14:18:09.656581 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
14:18:09.659898 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
14:18:09.669106 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
14:18:09.680387 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
14:18:09.692766 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
14:18:09.698273 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
14:18:09.699419 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
14:18:09.700237 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
14:18:09.701724 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
14:18:09.703470 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
14:18:09.707682 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
14:18:09.712477 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
14:18:09.714352 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
14:18:09.724255 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
14:18:09.728281 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
14:18:09.729366 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
14:18:09.732106 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
14:18:09.733551 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
14:18:09.742307 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
14:18:09.753109 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
14:18:09.759546 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
14:18:09.760710 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
14:18:09.762393 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
14:18:09.763436 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
14:18:09.764244 [debug] [MainThread]: Parsing macros/adapters/columns.sql
14:18:09.771546 [debug] [MainThread]: Parsing macros/adapters/relation.sql
14:18:09.778014 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
14:18:09.779832 [debug] [MainThread]: Parsing macros/adapters/schema.sql
14:18:09.781158 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
14:18:09.782993 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
14:18:09.787329 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
14:18:09.789845 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
14:18:09.790362 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
14:18:09.790893 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
14:18:09.791361 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
14:18:09.792910 [debug] [MainThread]: Parsing macros/etc/datetime.sql
14:18:09.799218 [debug] [MainThread]: Parsing macros/etc/statement.sql
14:18:09.801930 [debug] [MainThread]: Parsing tests/generic/builtin.sql
14:18:09.945002 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
14:18:09.953756 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
14:18:09.955453 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
14:18:09.994632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ba25fc6-927f-4fef-9f5d-c5d206496f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec51f10d0>]}
14:18:09.999472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ba25fc6-927f-4fef-9f5d-c5d206496f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec74dfc10>]}
14:18:09.999755 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:18:10.000032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ba25fc6-927f-4fef-9f5d-c5d206496f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec6f607f0>]}
14:18:10.000878 [info ] [MainThread]: 
14:18:10.001210 [debug] [MainThread]: Acquiring new postgres connection "master"
14:18:10.002816 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
14:18:10.009795 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
14:18:10.010037 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
14:18:10.010483 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:18:10.018634 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
14:18:10.019660 [debug] [ThreadPool]: On list_erp_oltp: Close
14:18:10.021162 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
14:18:10.024934 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:18:10.025037 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
14:18:10.025119 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:18:10.032623 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:18:10.032832 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:18:10.032903 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:18:10.036681 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
14:18:10.037663 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
14:18:10.037871 [debug] [ThreadPool]: On list_erp_oltp_public: Close
14:18:10.040763 [debug] [MainThread]: Using postgres connection "master"
14:18:10.040919 [debug] [MainThread]: On master: BEGIN
14:18:10.040989 [debug] [MainThread]: Opening a new connection, currently in state init
14:18:10.047529 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:18:10.047719 [debug] [MainThread]: Using postgres connection "master"
14:18:10.047787 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:18:10.058270 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
14:18:10.059229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ba25fc6-927f-4fef-9f5d-c5d206496f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec56f37c0>]}
14:18:10.059525 [debug] [MainThread]: On master: ROLLBACK
14:18:10.059790 [debug] [MainThread]: Using postgres connection "master"
14:18:10.059895 [debug] [MainThread]: On master: BEGIN
14:18:10.060391 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:18:10.060523 [debug] [MainThread]: On master: COMMIT
14:18:10.060751 [debug] [MainThread]: Using postgres connection "master"
14:18:10.060859 [debug] [MainThread]: On master: COMMIT
14:18:10.061104 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:18:10.061241 [debug] [MainThread]: On master: Close
14:18:10.061667 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
14:18:10.062427 [info ] [MainThread]: 
14:18:10.069037 [debug] [Thread-1  ]: Began running node model.first_project.customers
14:18:10.069290 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
14:18:10.069637 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
14:18:10.069733 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
14:18:10.069874 [debug] [Thread-1  ]: Compiling model.first_project.customers
14:18:10.070963 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
14:18:10.071238 [debug] [Thread-1  ]: finished collecting timing info
14:18:10.071358 [debug] [Thread-1  ]: Began executing node model.first_project.customers
14:18:10.078179 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
14:18:10.078446 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
14:18:10.078751 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
14:18:10.078904 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
14:18:10.078985 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
14:18:10.080425 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
14:18:10.080668 [debug] [Thread-2  ]: finished collecting timing info
14:18:10.080761 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
14:18:10.099050 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
14:18:10.099502 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:10.099691 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
14:18:10.099778 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:18:10.108266 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
14:18:10.108798 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:10.108945 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:18:10.109093 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
14:18:10.109236 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:10.109615 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name
  from erp_oltp.public.clientes
)
select * from customers
  );
14:18:10.109481 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:18:10.115180 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
14:18:10.115434 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:10.115521 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
14:18:10.123976 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.01 seconds
14:18:10.131231 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:10.131452 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
14:18:10.131714 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
14:18:10.133552 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:10.133909 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
14:18:10.134305 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:18:10.138739 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:18:10.138939 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:10.139024 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:18:10.139219 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
14:18:10.142158 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:18:10.142289 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:10.142416 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:18:10.147169 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
14:18:10.150669 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:10.150835 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
14:18:10.150933 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
14:18:10.152043 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:10.152190 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
14:18:10.152289 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:18:10.152387 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
14:18:10.153163 [debug] [Thread-1  ]: finished collecting timing info
14:18:10.153933 [debug] [Thread-2  ]: finished collecting timing info
14:18:10.154123 [debug] [Thread-1  ]: On model.first_project.customers: Close
14:18:10.154350 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
14:18:10.156395 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba25fc6-927f-4fef-9f5d-c5d206496f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec5177ee0>]}
14:18:10.156657 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.09s]
14:18:10.156956 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba25fc6-927f-4fef-9f5d-c5d206496f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec8330220>]}
14:18:10.157226 [debug] [Thread-1  ]: Finished running node model.first_project.customers
14:18:10.157515 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.08s]
14:18:10.157899 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
14:18:10.158208 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
14:18:10.158353 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
14:18:10.158593 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
14:18:10.158673 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
14:18:10.158775 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
14:18:10.160280 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
14:18:10.160596 [debug] [Thread-4  ]: finished collecting timing info
14:18:10.160760 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
14:18:10.163449 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
14:18:10.163922 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:10.164083 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
14:18:10.164150 [debug] [Thread-4  ]: Opening a new connection, currently in state init
14:18:10.170077 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
14:18:10.170236 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:10.170307 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
14:18:10.175243 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
14:18:10.177874 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:10.178085 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
14:18:10.178858 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
14:18:10.179675 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:18:10.179765 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:10.179825 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:18:10.181533 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
14:18:10.182509 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:10.182598 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
14:18:10.182933 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
14:18:10.184645 [debug] [Thread-4  ]: finished collecting timing info
14:18:10.184778 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
14:18:10.185157 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ba25fc6-927f-4fef-9f5d-c5d206496f8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec5159580>]}
14:18:10.185449 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
14:18:10.185777 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
14:18:10.187235 [debug] [MainThread]: Acquiring new postgres connection "master"
14:18:10.187424 [debug] [MainThread]: Using postgres connection "master"
14:18:10.187524 [debug] [MainThread]: On master: BEGIN
14:18:10.187588 [debug] [MainThread]: Opening a new connection, currently in state closed
14:18:10.192112 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:18:10.192343 [debug] [MainThread]: On master: COMMIT
14:18:10.192415 [debug] [MainThread]: Using postgres connection "master"
14:18:10.192474 [debug] [MainThread]: On master: COMMIT
14:18:10.192638 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:18:10.192730 [debug] [MainThread]: On master: Close
14:18:10.193172 [info ] [MainThread]: 
14:18:10.193532 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0.19s.
14:18:10.193894 [debug] [MainThread]: Connection 'master' was properly closed.
14:18:10.194010 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
14:18:10.194103 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
14:18:10.194193 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
14:18:10.199214 [info ] [MainThread]: 
14:18:10.199413 [info ] [MainThread]: [32mCompleted successfully[0m
14:18:10.199559 [info ] [MainThread]: 
14:18:10.199684 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
14:18:10.199860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec6effd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec56f3370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcec51c8e80>]}


============================== 2022-06-04 14:30:48.362625 | 3ecda899-1998-4770-a2de-da23fcf3c0ea ==============================
14:30:48.362661 [info ] [MainThread]: Running with dbt=1.1.0
14:30:48.363163 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:30:48.363276 [debug] [MainThread]: Tracking: tracking
14:30:48.367634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e1c00a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e1c00730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e1c00df0>]}
14:30:48.393707 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:30:48.394042 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
14:30:48.405397 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
14:30:48.420050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ecda899-1998-4770-a2de-da23fcf3c0ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e16d00d0>]}
14:30:48.423585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ecda899-1998-4770-a2de-da23fcf3c0ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e1b98f10>]}
14:30:48.423839 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:30:48.423992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ecda899-1998-4770-a2de-da23fcf3c0ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e1b98e80>]}
14:30:48.425143 [info ] [MainThread]: 
14:30:48.425624 [debug] [MainThread]: Acquiring new postgres connection "master"
14:30:48.426346 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
14:30:48.433206 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
14:30:48.433516 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
14:30:48.433609 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:30:48.441722 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
14:30:48.442887 [debug] [ThreadPool]: On list_erp_oltp: Close
14:30:48.444415 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
14:30:48.449525 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:30:48.449756 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
14:30:48.449833 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:30:48.454375 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
14:30:48.454589 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:30:48.454666 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:30:48.456271 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
14:30:48.457405 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
14:30:48.457703 [debug] [ThreadPool]: On list_erp_oltp_public: Close
14:30:48.490817 [debug] [MainThread]: Using postgres connection "master"
14:30:48.490992 [debug] [MainThread]: On master: BEGIN
14:30:48.491079 [debug] [MainThread]: Opening a new connection, currently in state init
14:30:48.496927 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:30:48.497207 [debug] [MainThread]: Using postgres connection "master"
14:30:48.497289 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:30:48.508599 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
14:30:48.509604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ecda899-1998-4770-a2de-da23fcf3c0ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e16af160>]}
14:30:48.509987 [debug] [MainThread]: On master: ROLLBACK
14:30:48.510383 [debug] [MainThread]: Using postgres connection "master"
14:30:48.510474 [debug] [MainThread]: On master: BEGIN
14:30:48.510954 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:30:48.511057 [debug] [MainThread]: On master: COMMIT
14:30:48.511119 [debug] [MainThread]: Using postgres connection "master"
14:30:48.511174 [debug] [MainThread]: On master: COMMIT
14:30:48.511340 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:30:48.511423 [debug] [MainThread]: On master: Close
14:30:48.511815 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
14:30:48.511989 [info ] [MainThread]: 
14:30:48.518034 [debug] [Thread-1  ]: Began running node model.first_project.customers
14:30:48.518393 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
14:30:48.518879 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
14:30:48.519035 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
14:30:48.519186 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
14:30:48.519390 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
14:30:48.519598 [debug] [Thread-1  ]: Compiling model.first_project.customers
14:30:48.520577 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
14:30:48.520814 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
14:30:48.521028 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
14:30:48.521120 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
14:30:48.523348 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
14:30:48.524226 [debug] [Thread-2  ]: finished collecting timing info
14:30:48.524502 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
14:30:48.544426 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
14:30:48.544772 [debug] [Thread-1  ]: finished collecting timing info
14:30:48.545142 [debug] [Thread-1  ]: Began executing node model.first_project.customers
14:30:48.551018 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:48.559208 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
14:30:48.559403 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
14:30:48.559815 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:30:48.560067 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:48.560312 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
14:30:48.560435 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:48.567933 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
14:30:48.568333 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:48.568437 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
14:30:48.572513 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
14:30:48.578450 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:48.578711 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
14:30:48.579410 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:48.579566 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
14:30:48.581144 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:48.581311 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
)
select * from customers
  );
14:30:48.580886 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:48.581513 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
14:30:48.582105 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:48.592764 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:30:48.595721 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:48.595892 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
14:30:48.600615 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:30:48.600911 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:48.602898 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:48.603037 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
14:30:48.601133 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:48.603232 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:30:48.605657 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:48.607435 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:30:48.607596 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:48.607680 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:30:48.612290 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
14:30:48.617424 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:48.617606 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
14:30:48.618589 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:48.617718 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
14:30:48.618772 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
14:30:48.626869 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.01 seconds
14:30:48.628236 [debug] [Thread-2  ]: finished collecting timing info
14:30:48.628385 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:30:48.629292 [debug] [Thread-1  ]: finished collecting timing info
14:30:48.629394 [debug] [Thread-1  ]: On model.first_project.customers: Close
14:30:48.629790 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ecda899-1998-4770-a2de-da23fcf3c0ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e1697f40>]}
14:30:48.630007 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.11s]
14:30:48.630319 [debug] [Thread-1  ]: Finished running node model.first_project.customers
14:30:48.628626 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
14:30:48.632436 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ecda899-1998-4770-a2de-da23fcf3c0ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e1672d60>]}
14:30:48.632914 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
14:30:48.633401 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
14:30:48.635776 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
14:30:48.636029 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
14:30:48.636376 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
14:30:48.636560 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
14:30:48.636712 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
14:30:48.638709 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
14:30:48.639376 [debug] [Thread-4  ]: finished collecting timing info
14:30:48.639544 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
14:30:48.641346 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
14:30:48.641709 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:48.642646 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
14:30:48.642792 [debug] [Thread-4  ]: Opening a new connection, currently in state init
14:30:48.663003 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
14:30:48.663980 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:48.664447 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
14:30:48.667369 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
14:30:48.671090 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:48.671297 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
14:30:48.673641 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:48.675336 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:30:48.675503 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:48.675605 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:30:48.677249 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
14:30:48.678392 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:48.678493 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
14:30:48.678714 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
14:30:48.679631 [debug] [Thread-4  ]: finished collecting timing info
14:30:48.679753 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
14:30:48.682269 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ecda899-1998-4770-a2de-da23fcf3c0ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e05dedf0>]}
14:30:48.682832 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
14:30:48.683284 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
14:30:48.684572 [debug] [MainThread]: Acquiring new postgres connection "master"
14:30:48.684693 [debug] [MainThread]: Using postgres connection "master"
14:30:48.684755 [debug] [MainThread]: On master: BEGIN
14:30:48.684809 [debug] [MainThread]: Opening a new connection, currently in state closed
14:30:48.692058 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:30:48.692296 [debug] [MainThread]: On master: COMMIT
14:30:48.692382 [debug] [MainThread]: Using postgres connection "master"
14:30:48.692444 [debug] [MainThread]: On master: COMMIT
14:30:48.692690 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:30:48.692871 [debug] [MainThread]: On master: Close
14:30:48.693225 [info ] [MainThread]: 
14:30:48.693384 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0.27s.
14:30:48.693487 [debug] [MainThread]: Connection 'master' was properly closed.
14:30:48.693539 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
14:30:48.693587 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
14:30:48.693635 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
14:30:48.696763 [info ] [MainThread]: 
14:30:48.696995 [info ] [MainThread]: [32mCompleted successfully[0m
14:30:48.697140 [info ] [MainThread]: 
14:30:48.697246 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
14:30:48.697421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e39fd460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e39fb3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3e3d7c0d0>]}


============================== 2022-06-04 14:46:28.733880 | 69b339fc-1f8d-4e3e-806b-83896239761e ==============================
14:46:28.733896 [info ] [MainThread]: Running with dbt=1.1.0
14:46:28.734367 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:46:28.734467 [debug] [MainThread]: Tracking: tracking
14:46:28.737344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ca4c6a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ca4c6730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ca4c6df0>]}
14:46:28.763629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:46:28.764170 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
14:46:28.779546 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
14:46:28.793793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69b339fc-1f8d-4e3e-806b-83896239761e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c9f950d0>]}
14:46:28.797532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69b339fc-1f8d-4e3e-806b-83896239761e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ca45ff10>]}
14:46:28.797883 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:46:28.798040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69b339fc-1f8d-4e3e-806b-83896239761e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ca45fe80>]}
14:46:28.799075 [info ] [MainThread]: 
14:46:28.799447 [debug] [MainThread]: Acquiring new postgres connection "master"
14:46:28.800145 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
14:46:28.807207 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
14:46:28.807370 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
14:46:28.807445 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:46:28.823138 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.02 seconds
14:46:28.826227 [debug] [ThreadPool]: On list_erp_oltp: Close
14:46:28.833521 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
14:46:28.839436 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:46:28.839613 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
14:46:28.839686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:46:28.845447 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:46:28.845640 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:46:28.845712 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:46:28.848545 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
14:46:28.849525 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
14:46:28.849745 [debug] [ThreadPool]: On list_erp_oltp_public: Close
14:46:28.882036 [debug] [MainThread]: Using postgres connection "master"
14:46:28.882315 [debug] [MainThread]: On master: BEGIN
14:46:28.882404 [debug] [MainThread]: Opening a new connection, currently in state init
14:46:28.887644 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:46:28.887843 [debug] [MainThread]: Using postgres connection "master"
14:46:28.887914 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:46:28.896626 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
14:46:28.897716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69b339fc-1f8d-4e3e-806b-83896239761e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80ca3ce8e0>]}
14:46:28.898085 [debug] [MainThread]: On master: ROLLBACK
14:46:28.898410 [debug] [MainThread]: Using postgres connection "master"
14:46:28.898554 [debug] [MainThread]: On master: BEGIN
14:46:28.899083 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:46:28.899190 [debug] [MainThread]: On master: COMMIT
14:46:28.899282 [debug] [MainThread]: Using postgres connection "master"
14:46:28.899394 [debug] [MainThread]: On master: COMMIT
14:46:28.899786 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:46:28.899960 [debug] [MainThread]: On master: Close
14:46:28.900304 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
14:46:28.900490 [info ] [MainThread]: 
14:46:28.905387 [debug] [Thread-1  ]: Began running node model.first_project.customers
14:46:28.905650 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
14:46:28.905966 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
14:46:28.906063 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
14:46:28.906138 [debug] [Thread-1  ]: Compiling model.first_project.customers
14:46:28.906954 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
14:46:28.907095 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
14:46:28.907493 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
14:46:28.907796 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
14:46:28.907936 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
14:46:28.908052 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
14:46:28.910710 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
14:46:28.911268 [debug] [Thread-2  ]: finished collecting timing info
14:46:28.911474 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
14:46:28.924017 [debug] [Thread-1  ]: finished collecting timing info
14:46:28.924360 [debug] [Thread-1  ]: Began executing node model.first_project.customers
14:46:28.953722 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
14:46:28.954292 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
14:46:28.955002 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:28.955329 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:28.955502 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
14:46:28.955651 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
14:46:28.956811 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:46:28.955771 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:46:28.961546 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
14:46:28.961748 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:28.961864 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
14:46:28.962085 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:46:28.962313 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:28.962431 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
14:46:28.963392 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
14:46:28.968310 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:28.968547 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
14:46:28.969488 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:46:28.971349 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:28.971517 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
14:46:28.972144 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:46:28.979891 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
14:46:28.981919 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:28.982586 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
14:46:28.983082 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:46:28.988505 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:46:28.990627 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:28.992520 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:28.992989 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:46:28.992845 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
14:46:28.993975 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:46:28.995339 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:46:28.995452 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:28.995555 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
14:46:28.995786 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:46:28.999749 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:28.999997 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
14:46:29.002278 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
14:46:29.003701 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:29.003893 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
14:46:29.004016 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
14:46:29.005121 [debug] [Thread-2  ]: finished collecting timing info
14:46:29.005268 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
14:46:29.005781 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69b339fc-1f8d-4e3e-806b-83896239761e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c9f51d60>]}
14:46:29.007110 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.10s]
14:46:29.007505 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
14:46:29.007898 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:46:29.008232 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
14:46:29.009964 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
14:46:29.010278 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
14:46:29.010374 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
14:46:29.010494 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
14:46:29.009536 [debug] [Thread-1  ]: finished collecting timing info
14:46:29.012087 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
14:46:29.012322 [debug] [Thread-1  ]: On model.first_project.customers: Close
14:46:29.012907 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69b339fc-1f8d-4e3e-806b-83896239761e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c9f6a5e0>]}
14:46:29.013127 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.11s]
14:46:29.013449 [debug] [Thread-1  ]: Finished running node model.first_project.customers
14:46:29.013638 [debug] [Thread-4  ]: finished collecting timing info
14:46:29.013734 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
14:46:29.015669 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
14:46:29.016998 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:46:29.017210 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
14:46:29.017282 [debug] [Thread-4  ]: Opening a new connection, currently in state init
14:46:29.027438 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
14:46:29.027797 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:46:29.027891 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
14:46:29.028856 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
14:46:29.030677 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:46:29.030848 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
14:46:29.031305 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
14:46:29.032237 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:46:29.032346 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:46:29.032456 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:46:29.034311 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
14:46:29.035781 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:46:29.035912 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
14:46:29.036662 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
14:46:29.037619 [debug] [Thread-4  ]: finished collecting timing info
14:46:29.037801 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
14:46:29.038107 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69b339fc-1f8d-4e3e-806b-83896239761e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80c9f2dd00>]}
14:46:29.038362 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
14:46:29.038671 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
14:46:29.040364 [debug] [MainThread]: Acquiring new postgres connection "master"
14:46:29.040492 [debug] [MainThread]: Using postgres connection "master"
14:46:29.040556 [debug] [MainThread]: On master: BEGIN
14:46:29.040614 [debug] [MainThread]: Opening a new connection, currently in state closed
14:46:29.050237 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:46:29.050495 [debug] [MainThread]: On master: COMMIT
14:46:29.050563 [debug] [MainThread]: Using postgres connection "master"
14:46:29.050624 [debug] [MainThread]: On master: COMMIT
14:46:29.050869 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:46:29.051047 [debug] [MainThread]: On master: Close
14:46:29.051372 [info ] [MainThread]: 
14:46:29.051522 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.25s.
14:46:29.051627 [debug] [MainThread]: Connection 'master' was properly closed.
14:46:29.051681 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
14:46:29.051729 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
14:46:29.051803 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
14:46:29.055047 [info ] [MainThread]: 
14:46:29.055399 [info ] [MainThread]: [32mCompleted successfully[0m
14:46:29.055556 [info ] [MainThread]: 
14:46:29.055675 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
14:46:29.055885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80cc2c3460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80cc2c13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f80cc642cd0>]}


============================== 2022-06-04 16:30:35.061988 | 4a11ca75-e2e5-4eae-bd8e-28b75fc24189 ==============================
16:30:35.062029 [info ] [MainThread]: Running with dbt=1.1.0
16:30:35.063231 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:30:35.063329 [debug] [MainThread]: Tracking: tracking
16:30:35.065747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4dc72640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4dc72d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4dc726d0>]}
16:30:35.079784 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
16:30:35.080059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4a11ca75-e2e5-4eae-bd8e-28b75fc24189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4dc79970>]}
16:30:35.112449 [debug] [MainThread]: Parsing macros/catalog.sql
16:30:35.114991 [debug] [MainThread]: Parsing macros/relations.sql
16:30:35.116025 [debug] [MainThread]: Parsing macros/adapters.sql
16:30:35.131182 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
16:30:35.132456 [debug] [MainThread]: Parsing macros/materializations/configs.sql
16:30:35.133847 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
16:30:35.135992 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
16:30:35.141806 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
16:30:35.151189 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
16:30:35.161618 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
16:30:35.164379 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
16:30:35.165328 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
16:30:35.166110 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
16:30:35.167631 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
16:30:35.169375 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
16:30:35.173536 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
16:30:35.177990 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
16:30:35.179867 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
16:30:35.189912 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
16:30:35.194071 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
16:30:35.195879 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
16:30:35.198805 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
16:30:35.200064 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
16:30:35.207795 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
16:30:35.217961 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
16:30:35.224345 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
16:30:35.225706 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
16:30:35.228162 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
16:30:35.229647 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
16:30:35.230492 [debug] [MainThread]: Parsing macros/adapters/columns.sql
16:30:35.236298 [debug] [MainThread]: Parsing macros/adapters/relation.sql
16:30:35.242216 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
16:30:35.244424 [debug] [MainThread]: Parsing macros/adapters/schema.sql
16:30:35.245852 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
16:30:35.247647 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
16:30:35.251962 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
16:30:35.254782 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
16:30:35.255373 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
16:30:35.255882 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
16:30:35.256325 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
16:30:35.257133 [debug] [MainThread]: Parsing macros/etc/datetime.sql
16:30:35.262479 [debug] [MainThread]: Parsing macros/etc/statement.sql
16:30:35.265217 [debug] [MainThread]: Parsing tests/generic/builtin.sql
16:30:35.405426 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
16:30:35.415753 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
16:30:35.417403 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
16:30:35.452094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a11ca75-e2e5-4eae-bd8e-28b75fc24189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4dbb96a0>]}
16:30:35.455115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a11ca75-e2e5-4eae-bd8e-28b75fc24189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4d725d00>]}
16:30:35.455395 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:30:35.455570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a11ca75-e2e5-4eae-bd8e-28b75fc24189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4dbb9130>]}
16:30:35.456447 [info ] [MainThread]: 
16:30:35.456747 [debug] [MainThread]: Acquiring new postgres connection "master"
16:30:35.457497 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:30:35.464787 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:30:35.464944 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:30:35.465020 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:30:35.524836 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.06 seconds
16:30:35.525984 [debug] [ThreadPool]: On list_erp_oltp: Close
16:30:35.529397 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:30:35.533268 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:30:35.533396 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:30:35.533465 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:30:35.537524 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
16:30:35.537712 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:30:35.537793 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:30:35.559560 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.02 seconds
16:30:35.561447 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:30:35.561994 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:30:35.565085 [debug] [MainThread]: Using postgres connection "master"
16:30:35.565211 [debug] [MainThread]: On master: BEGIN
16:30:35.565279 [debug] [MainThread]: Opening a new connection, currently in state init
16:30:35.569258 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:30:35.569391 [debug] [MainThread]: Using postgres connection "master"
16:30:35.569474 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:30:35.588915 [debug] [MainThread]: SQL status: SELECT 3 in 0.02 seconds
16:30:35.589960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a11ca75-e2e5-4eae-bd8e-28b75fc24189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d508c4760>]}
16:30:35.590176 [debug] [MainThread]: On master: ROLLBACK
16:30:35.590414 [debug] [MainThread]: Using postgres connection "master"
16:30:35.590492 [debug] [MainThread]: On master: BEGIN
16:30:35.590661 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:30:35.590766 [debug] [MainThread]: On master: COMMIT
16:30:35.590830 [debug] [MainThread]: Using postgres connection "master"
16:30:35.590885 [debug] [MainThread]: On master: COMMIT
16:30:35.591012 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:30:35.591088 [debug] [MainThread]: On master: Close
16:30:35.591477 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:30:35.591643 [info ] [MainThread]: 
16:30:35.601965 [debug] [Thread-1  ]: Began running node model.first_project.customers
16:30:35.602229 [info ] [Thread-1  ]: 1 of 3 START table model public.customers ...................................... [RUN]
16:30:35.602555 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
16:30:35.602644 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
16:30:35.602744 [debug] [Thread-1  ]: Compiling model.first_project.customers
16:30:35.604090 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
16:30:35.604305 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:30:35.604496 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
16:30:35.606016 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:30:35.606121 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:30:35.606190 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:30:35.607806 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:30:35.608187 [debug] [Thread-2  ]: finished collecting timing info
16:30:35.608424 [debug] [Thread-1  ]: finished collecting timing info
16:30:35.608600 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:30:35.608938 [debug] [Thread-1  ]: Began executing node model.first_project.customers
16:30:35.638405 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:30:35.636919 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
16:30:35.638959 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:35.639209 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
16:30:35.639307 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:30:35.639690 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:35.639868 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
16:30:35.639944 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:30:35.644118 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
16:30:35.644307 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:35.644384 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:30:35.644481 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:30:35.644595 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:35.644662 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
16:30:35.661871 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.02 seconds
16:30:35.666187 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:35.666344 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:30:35.666500 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.02 seconds
16:30:35.667944 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:35.668067 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:30:35.668199 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:35.669858 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:35.670028 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:35.670273 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:30:35.671643 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:35.672036 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:30:35.672165 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:35.672262 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:35.678830 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:30:35.679946 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:30:35.680189 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:35.680386 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:35.680513 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:30:35.680629 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:30:35.683209 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
16:30:35.686469 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:35.686602 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:30:35.686727 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
16:30:35.687985 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:35.688089 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:30:35.695661 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
16:30:35.696738 [debug] [Thread-1  ]: finished collecting timing info
16:30:35.696891 [debug] [Thread-1  ]: On model.first_project.customers: Close
16:30:35.697028 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.01 seconds
16:30:35.697985 [debug] [Thread-2  ]: finished collecting timing info
16:30:35.698163 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
16:30:35.698617 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a11ca75-e2e5-4eae-bd8e-28b75fc24189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4c699ca0>]}
16:30:35.698857 [info ] [Thread-1  ]: 1 of 3 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.10s]
16:30:35.699196 [debug] [Thread-1  ]: Finished running node model.first_project.customers
16:30:35.699918 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a11ca75-e2e5-4eae-bd8e-28b75fc24189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4dbdca60>]}
16:30:35.700163 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.09s]
16:30:35.700427 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:30:35.700942 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
16:30:35.701099 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
16:30:35.701418 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:30:35.701521 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
16:30:35.701606 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
16:30:35.703071 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:30:35.703467 [debug] [Thread-4  ]: finished collecting timing info
16:30:35.703587 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
16:30:35.716100 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:30:35.716433 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:35.716552 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
16:30:35.716646 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:30:35.721551 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
16:30:35.721839 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:35.721929 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:30:35.725733 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
16:30:35.728833 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:35.729049 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:30:35.729539 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:35.730507 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:30:35.730625 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:35.730686 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:30:35.732565 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
16:30:35.733630 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:35.733723 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:30:35.733912 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
16:30:35.734693 [debug] [Thread-4  ]: finished collecting timing info
16:30:35.734914 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
16:30:35.736496 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a11ca75-e2e5-4eae-bd8e-28b75fc24189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4dc80640>]}
16:30:35.736730 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
16:30:35.736988 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
16:30:35.738831 [debug] [MainThread]: Acquiring new postgres connection "master"
16:30:35.738955 [debug] [MainThread]: Using postgres connection "master"
16:30:35.739018 [debug] [MainThread]: On master: BEGIN
16:30:35.739076 [debug] [MainThread]: Opening a new connection, currently in state closed
16:30:35.745046 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:30:35.745267 [debug] [MainThread]: On master: COMMIT
16:30:35.745339 [debug] [MainThread]: Using postgres connection "master"
16:30:35.745400 [debug] [MainThread]: On master: COMMIT
16:30:35.745741 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:30:35.745877 [debug] [MainThread]: On master: Close
16:30:35.746301 [info ] [MainThread]: 
16:30:35.746472 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0.29s.
16:30:35.746588 [debug] [MainThread]: Connection 'master' was properly closed.
16:30:35.746646 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:30:35.746698 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:30:35.746757 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:30:35.749963 [info ] [MainThread]: 
16:30:35.750213 [info ] [MainThread]: [32mCompleted successfully[0m
16:30:35.750358 [info ] [MainThread]: 
16:30:35.750468 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
16:30:35.750644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d508c4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d508c46a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d4d6ecd90>]}


============================== 2022-06-04 16:35:20.756642 | 61861f4e-54fc-4951-b7a2-9b5cd362599b ==============================
16:35:20.756656 [info ] [MainThread]: Running with dbt=1.1.0
16:35:20.757236 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:35:20.757337 [debug] [MainThread]: Tracking: tracking
16:35:20.760006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333e6804c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333e680d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333e6806d0>]}
16:35:20.784624 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
16:35:20.785056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '61861f4e-54fc-4951-b7a2-9b5cd362599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333e684490>]}
16:35:20.795913 [debug] [MainThread]: Parsing macros/catalog.sql
16:35:20.798174 [debug] [MainThread]: Parsing macros/relations.sql
16:35:20.799085 [debug] [MainThread]: Parsing macros/adapters.sql
16:35:20.814315 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
16:35:20.817511 [debug] [MainThread]: Parsing macros/materializations/configs.sql
16:35:20.819109 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
16:35:20.822102 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
16:35:20.829535 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
16:35:20.839787 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
16:35:20.850126 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
16:35:20.853130 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
16:35:20.854085 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
16:35:20.854966 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
16:35:20.856571 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
16:35:20.858251 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
16:35:20.862561 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
16:35:20.866874 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
16:35:20.868987 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
16:35:20.879695 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
16:35:20.883421 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
16:35:20.884511 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
16:35:20.887556 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
16:35:20.888730 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
16:35:20.897029 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
16:35:20.907481 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
16:35:20.913958 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
16:35:20.915116 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
16:35:20.916558 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
16:35:20.917479 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
16:35:20.918382 [debug] [MainThread]: Parsing macros/adapters/columns.sql
16:35:20.924766 [debug] [MainThread]: Parsing macros/adapters/relation.sql
16:35:20.932153 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
16:35:20.934126 [debug] [MainThread]: Parsing macros/adapters/schema.sql
16:35:20.935943 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
16:35:20.938072 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
16:35:20.942344 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
16:35:20.944996 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
16:35:20.945499 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
16:35:20.946084 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
16:35:20.946500 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
16:35:20.947333 [debug] [MainThread]: Parsing macros/etc/datetime.sql
16:35:20.952381 [debug] [MainThread]: Parsing macros/etc/statement.sql
16:35:20.955343 [debug] [MainThread]: Parsing tests/generic/builtin.sql
16:35:21.098097 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
16:35:21.107412 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
16:35:21.109320 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
16:35:21.141527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61861f4e-54fc-4951-b7a2-9b5cd362599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333e658df0>]}
16:35:21.145109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61861f4e-54fc-4951-b7a2-9b5cd362599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333e64ea00>]}
16:35:21.145394 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:35:21.145541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61861f4e-54fc-4951-b7a2-9b5cd362599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333e658df0>]}
16:35:21.146450 [info ] [MainThread]: 
16:35:21.147115 [debug] [MainThread]: Acquiring new postgres connection "master"
16:35:21.147933 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:35:21.155054 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:35:21.155232 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:35:21.155303 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:35:21.164052 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:35:21.165012 [debug] [ThreadPool]: On list_erp_oltp: Close
16:35:21.166094 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:35:21.172526 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:35:21.173087 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:35:21.173225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:35:21.180169 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
16:35:21.180324 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:35:21.180389 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:35:21.182183 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
16:35:21.183234 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:35:21.183481 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:35:21.187332 [debug] [MainThread]: Using postgres connection "master"
16:35:21.187713 [debug] [MainThread]: On master: BEGIN
16:35:21.187845 [debug] [MainThread]: Opening a new connection, currently in state init
16:35:21.195083 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:35:21.195413 [debug] [MainThread]: Using postgres connection "master"
16:35:21.195490 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:35:21.205987 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
16:35:21.206953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61861f4e-54fc-4951-b7a2-9b5cd362599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333e610dc0>]}
16:35:21.207360 [debug] [MainThread]: On master: ROLLBACK
16:35:21.207566 [debug] [MainThread]: Using postgres connection "master"
16:35:21.207652 [debug] [MainThread]: On master: BEGIN
16:35:21.207824 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:35:21.207910 [debug] [MainThread]: On master: COMMIT
16:35:21.207972 [debug] [MainThread]: Using postgres connection "master"
16:35:21.208073 [debug] [MainThread]: On master: COMMIT
16:35:21.208193 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:35:21.208274 [debug] [MainThread]: On master: Close
16:35:21.208553 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:35:21.210300 [info ] [MainThread]: 
16:35:21.222681 [debug] [Thread-1  ]: Began running node model.first_project.customers
16:35:21.222993 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
16:35:21.223331 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
16:35:21.223431 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
16:35:21.223511 [debug] [Thread-1  ]: Compiling model.first_project.customers
16:35:21.224842 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
16:35:21.225110 [debug] [Thread-1  ]: finished collecting timing info
16:35:21.225251 [debug] [Thread-1  ]: Began executing node model.first_project.customers
16:35:21.232904 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:35:21.233180 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
16:35:21.233572 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:35:21.233679 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:35:21.239617 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:35:21.247034 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:35:21.249864 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
16:35:21.250360 [debug] [Thread-2  ]: finished collecting timing info
16:35:21.250615 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:21.250845 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:35:21.251157 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
16:35:21.262096 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:35:21.272668 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:35:21.273427 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:21.273620 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:35:21.274716 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:21.274783 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
16:35:21.274604 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
16:35:21.274918 [debug] [Thread-2  ]: Opening a new connection, currently in state init
16:35:21.282936 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
16:35:21.283331 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:21.283678 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:35:21.285834 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
16:35:21.289860 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:21.289971 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
16:35:21.290085 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:35:21.291690 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:21.292012 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:35:21.292369 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:35:21.293634 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:21.294815 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:35:21.294929 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:35:21.296146 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:21.296240 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:35:21.296355 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:35:21.302223 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
16:35:21.304918 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:35:21.306037 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:35:21.306255 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:21.306476 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:21.306585 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:35:21.306693 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:35:21.308328 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
16:35:21.312322 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:21.312541 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:35:21.312696 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
16:35:21.313933 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:21.314026 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:35:21.314848 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
16:35:21.315906 [debug] [Thread-2  ]: finished collecting timing info
16:35:21.316084 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
16:35:21.317207 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
16:35:21.317994 [debug] [Thread-1  ]: finished collecting timing info
16:35:21.318152 [debug] [Thread-1  ]: On model.first_project.customers: Close
16:35:21.318943 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61861f4e-54fc-4951-b7a2-9b5cd362599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333c0a5190>]}
16:35:21.319528 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.09s]
16:35:21.319972 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:35:21.320602 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61861f4e-54fc-4951-b7a2-9b5cd362599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333e13aa60>]}
16:35:21.320938 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
16:35:21.321557 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
16:35:21.321879 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:35:21.321966 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
16:35:21.322072 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
16:35:21.323636 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:35:21.323881 [debug] [Thread-4  ]: finished collecting timing info
16:35:21.324031 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
16:35:21.326277 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:35:21.321295 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.10s]
16:35:21.326523 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:35:21.326919 [debug] [Thread-1  ]: Finished running node model.first_project.customers
16:35:21.327156 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
16:35:21.327436 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:35:21.331538 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
16:35:21.331714 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:35:21.331810 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:35:21.333050 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
16:35:21.334721 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:35:21.334871 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:35:21.335713 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
16:35:21.336858 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:35:21.337068 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:35:21.337149 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:35:21.338939 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
16:35:21.340274 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:35:21.340385 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:35:21.340711 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
16:35:21.341462 [debug] [Thread-4  ]: finished collecting timing info
16:35:21.341675 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
16:35:21.342006 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61861f4e-54fc-4951-b7a2-9b5cd362599b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333c072b20>]}
16:35:21.343385 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
16:35:21.348879 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
16:35:21.360975 [debug] [MainThread]: Acquiring new postgres connection "master"
16:35:21.361371 [debug] [MainThread]: Using postgres connection "master"
16:35:21.361478 [debug] [MainThread]: On master: BEGIN
16:35:21.361545 [debug] [MainThread]: Opening a new connection, currently in state closed
16:35:21.370913 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:35:21.371460 [debug] [MainThread]: On master: COMMIT
16:35:21.371555 [debug] [MainThread]: Using postgres connection "master"
16:35:21.371617 [debug] [MainThread]: On master: COMMIT
16:35:21.372101 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:35:21.372288 [debug] [MainThread]: On master: Close
16:35:21.372623 [info ] [MainThread]: 
16:35:21.372907 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.23s.
16:35:21.373065 [debug] [MainThread]: Connection 'master' was properly closed.
16:35:21.373125 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:35:21.373179 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:35:21.373233 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:35:21.376945 [info ] [MainThread]: 
16:35:21.377275 [info ] [MainThread]: [32mCompleted successfully[0m
16:35:21.377446 [info ] [MainThread]: 
16:35:21.377576 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
16:35:21.377828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333e610400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333e0fbb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f333e0fbd00>]}


============================== 2022-06-04 16:39:21.280214 | 3720a88c-1639-4c72-a8a7-ba7ee90c5c9d ==============================
16:39:21.280227 [info ] [MainThread]: Running with dbt=1.1.0
16:39:21.280766 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:39:21.280925 [debug] [MainThread]: Tracking: tracking
16:39:21.283745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96c9e67c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96c9e6280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96c9e69d0>]}
16:39:21.320562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
16:39:21.321110 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
16:39:21.330355 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
16:39:21.344947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3720a88c-1639-4c72-a8a7-ba7ee90c5c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96c4bb0d0>]}
16:39:21.348502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3720a88c-1639-4c72-a8a7-ba7ee90c5c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96c983d00>]}
16:39:21.348846 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:39:21.349141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3720a88c-1639-4c72-a8a7-ba7ee90c5c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96c983e80>]}
16:39:21.350124 [info ] [MainThread]: 
16:39:21.350687 [debug] [MainThread]: Acquiring new postgres connection "master"
16:39:21.354629 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:39:21.362466 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:39:21.362789 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:39:21.362907 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:39:21.368491 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:39:21.369573 [debug] [ThreadPool]: On list_erp_oltp: Close
16:39:21.370698 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:39:21.377700 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:39:21.377918 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:39:21.377987 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:39:21.382207 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
16:39:21.382417 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:39:21.382526 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:39:21.384147 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
16:39:21.385302 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:39:21.385675 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:39:21.419107 [debug] [MainThread]: Using postgres connection "master"
16:39:21.419446 [debug] [MainThread]: On master: BEGIN
16:39:21.419517 [debug] [MainThread]: Opening a new connection, currently in state init
16:39:21.423785 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:39:21.424036 [debug] [MainThread]: Using postgres connection "master"
16:39:21.424263 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:39:21.433489 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
16:39:21.434707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3720a88c-1639-4c72-a8a7-ba7ee90c5c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96c49f940>]}
16:39:21.435033 [debug] [MainThread]: On master: ROLLBACK
16:39:21.435359 [debug] [MainThread]: Using postgres connection "master"
16:39:21.435465 [debug] [MainThread]: On master: BEGIN
16:39:21.436008 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:39:21.436096 [debug] [MainThread]: On master: COMMIT
16:39:21.436177 [debug] [MainThread]: Using postgres connection "master"
16:39:21.436230 [debug] [MainThread]: On master: COMMIT
16:39:21.436444 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:39:21.436560 [debug] [MainThread]: On master: Close
16:39:21.436860 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:39:21.437070 [info ] [MainThread]: 
16:39:21.446518 [debug] [Thread-1  ]: Began running node model.first_project.customers
16:39:21.446802 [info ] [Thread-1  ]: 1 of 3 START table model public.customers ...................................... [RUN]
16:39:21.447143 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
16:39:21.447271 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
16:39:21.447876 [debug] [Thread-1  ]: Compiling model.first_project.customers
16:39:21.447426 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:39:21.449623 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
16:39:21.449398 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
16:39:21.449919 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:39:21.450307 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:39:21.450413 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:39:21.452344 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:39:21.452734 [debug] [Thread-2  ]: finished collecting timing info
16:39:21.452896 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:39:21.467968 [debug] [Thread-1  ]: finished collecting timing info
16:39:21.468212 [debug] [Thread-1  ]: Began executing node model.first_project.customers
16:39:21.490300 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:39:21.492678 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
16:39:21.493104 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:39:21.493411 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:39:21.494756 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
16:39:21.493647 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
16:39:21.494832 [debug] [Thread-2  ]: Opening a new connection, currently in state init
16:39:21.495022 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:39:21.499237 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
16:39:21.499395 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:39:21.499476 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:39:21.499692 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
16:39:21.499869 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:39:21.499996 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
16:39:21.500673 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
16:39:21.505485 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:39:21.505652 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:39:21.505964 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.01 seconds
16:39:21.507629 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:39:21.507874 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:39:21.508079 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:39:21.510898 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:39:21.511379 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:39:21.511903 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:39:21.517602 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
16:39:21.520030 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:39:21.522019 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:39:21.522325 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:39:21.522473 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:39:21.522622 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:39:21.523123 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:39:21.525466 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:39:21.525609 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:39:21.525676 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:39:21.525779 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
16:39:21.531406 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:39:21.531772 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:39:21.531986 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
16:39:21.533557 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:39:21.533672 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:39:21.534633 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
16:39:21.535658 [debug] [Thread-2  ]: finished collecting timing info
16:39:21.535889 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
16:39:21.536648 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
16:39:21.537725 [debug] [Thread-1  ]: finished collecting timing info
16:39:21.538106 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3720a88c-1639-4c72-a8a7-ba7ee90c5c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96c3d6400>]}
16:39:21.538576 [debug] [Thread-1  ]: On model.first_project.customers: Close
16:39:21.538982 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.09s]
16:39:21.539463 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:39:21.539748 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
16:39:21.539997 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
16:39:21.540301 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:39:21.540378 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
16:39:21.540455 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
16:39:21.543535 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:39:21.545418 [debug] [Thread-4  ]: finished collecting timing info
16:39:21.545721 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
16:39:21.551880 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3720a88c-1639-4c72-a8a7-ba7ee90c5c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96ebcd730>]}
16:39:21.552419 [info ] [Thread-1  ]: 1 of 3 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.10s]
16:39:21.557932 [debug] [Thread-1  ]: Finished running node model.first_project.customers
16:39:21.558840 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:39:21.560595 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:39:21.560782 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
16:39:21.560890 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:39:21.565784 [debug] [Thread-4  ]: SQL status: BEGIN in 0.0 seconds
16:39:21.565972 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:39:21.566040 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:39:21.568537 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
16:39:21.570250 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:39:21.570375 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:39:21.570714 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
16:39:21.571616 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:39:21.571713 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:39:21.571776 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:39:21.573500 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
16:39:21.575178 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:39:21.575392 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:39:21.577390 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
16:39:21.579422 [debug] [Thread-4  ]: finished collecting timing info
16:39:21.579605 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
16:39:21.580157 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3720a88c-1639-4c72-a8a7-ba7ee90c5c9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96e1be940>]}
16:39:21.580429 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
16:39:21.580861 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
16:39:21.582240 [debug] [MainThread]: Acquiring new postgres connection "master"
16:39:21.582478 [debug] [MainThread]: Using postgres connection "master"
16:39:21.582566 [debug] [MainThread]: On master: BEGIN
16:39:21.582705 [debug] [MainThread]: Opening a new connection, currently in state closed
16:39:21.586549 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:39:21.586731 [debug] [MainThread]: On master: COMMIT
16:39:21.586818 [debug] [MainThread]: Using postgres connection "master"
16:39:21.586876 [debug] [MainThread]: On master: COMMIT
16:39:21.587000 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:39:21.587105 [debug] [MainThread]: On master: Close
16:39:21.587440 [info ] [MainThread]: 
16:39:21.587645 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0.24s.
16:39:21.587789 [debug] [MainThread]: Connection 'master' was properly closed.
16:39:21.587895 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:39:21.587957 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:39:21.588023 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:39:21.592473 [info ] [MainThread]: 
16:39:21.592734 [info ] [MainThread]: [32mCompleted successfully[0m
16:39:21.593019 [info ] [MainThread]: 
16:39:21.593152 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
16:39:21.593529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96e911e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96e7e60a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff96eb67c40>]}


============================== 2022-06-04 16:42:07.286756 | 25b800ee-68d1-4e40-9677-a5462dca332f ==============================
16:42:07.286769 [info ] [MainThread]: Running with dbt=1.1.0
16:42:07.287520 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:42:07.287846 [debug] [MainThread]: Tracking: tracking
16:42:07.290564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9f969a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9f969220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9f969eb0>]}
16:42:07.310686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
16:42:07.310960 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/customers2.sql
16:42:07.311166 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
16:42:07.321504 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers2.sql
16:42:07.330701 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
16:42:07.338076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25b800ee-68d1-4e40-9677-a5462dca332f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9f42df10>]}
16:42:07.341127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25b800ee-68d1-4e40-9677-a5462dca332f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9f8fdf40>]}
16:42:07.341379 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:42:07.341550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25b800ee-68d1-4e40-9677-a5462dca332f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9f8fde50>]}
16:42:07.342579 [info ] [MainThread]: 
16:42:07.343051 [debug] [MainThread]: Acquiring new postgres connection "master"
16:42:07.345023 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:42:07.352024 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:42:07.352197 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:42:07.352266 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:42:07.359998 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:42:07.361120 [debug] [ThreadPool]: On list_erp_oltp: Close
16:42:07.362220 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:42:07.367378 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:42:07.367544 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:42:07.367608 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:42:07.373245 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
16:42:07.373450 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:42:07.373596 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:42:07.376081 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
16:42:07.377210 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:42:07.377569 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:42:07.407746 [debug] [MainThread]: Using postgres connection "master"
16:42:07.407934 [debug] [MainThread]: On master: BEGIN
16:42:07.408010 [debug] [MainThread]: Opening a new connection, currently in state init
16:42:07.412181 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:42:07.412331 [debug] [MainThread]: Using postgres connection "master"
16:42:07.412401 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:42:07.421351 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
16:42:07.422287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25b800ee-68d1-4e40-9677-a5462dca332f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9f41a070>]}
16:42:07.422547 [debug] [MainThread]: On master: ROLLBACK
16:42:07.422954 [debug] [MainThread]: Using postgres connection "master"
16:42:07.423170 [debug] [MainThread]: On master: BEGIN
16:42:07.423558 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:42:07.423751 [debug] [MainThread]: On master: COMMIT
16:42:07.423851 [debug] [MainThread]: Using postgres connection "master"
16:42:07.423933 [debug] [MainThread]: On master: COMMIT
16:42:07.424088 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:42:07.424245 [debug] [MainThread]: On master: Close
16:42:07.424660 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:42:07.424938 [info ] [MainThread]: 
16:42:07.430014 [debug] [Thread-1  ]: Began running node model.first_project.customers
16:42:07.430276 [info ] [Thread-1  ]: 1 of 4 START view model public.customers ....................................... [RUN]
16:42:07.430695 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
16:42:07.430807 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
16:42:07.430890 [debug] [Thread-1  ]: Compiling model.first_project.customers
16:42:07.431817 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
16:42:07.432027 [debug] [Thread-2  ]: Began running node model.first_project.customers2
16:42:07.432191 [info ] [Thread-2  ]: 2 of 4 START table model public.customers2 ..................................... [RUN]
16:42:07.432494 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers2"
16:42:07.432577 [debug] [Thread-2  ]: Began compiling node model.first_project.customers2
16:42:07.432646 [debug] [Thread-2  ]: Compiling model.first_project.customers2
16:42:07.434190 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers2"
16:42:07.434388 [debug] [Thread-2  ]: finished collecting timing info
16:42:07.434477 [debug] [Thread-2  ]: Began executing node model.first_project.customers2
16:42:07.441308 [debug] [Thread-3  ]: Began running node model.first_project.my_first_dbt_model
16:42:07.452188 [info ] [Thread-3  ]: 3 of 4 START table model public.my_first_dbt_model ............................. [RUN]
16:42:07.452798 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:42:07.452903 [debug] [Thread-3  ]: Began compiling node model.first_project.my_first_dbt_model
16:42:07.452978 [debug] [Thread-3  ]: Compiling model.first_project.my_first_dbt_model
16:42:07.454652 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:42:07.455088 [debug] [Thread-3  ]: finished collecting timing info
16:42:07.455503 [debug] [Thread-3  ]: Began executing node model.first_project.my_first_dbt_model
16:42:07.462065 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.customers2"
16:42:07.462509 [debug] [Thread-1  ]: finished collecting timing info
16:42:07.466247 [debug] [Thread-1  ]: Began executing node model.first_project.customers
16:42:07.465497 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:42:07.472010 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
16:42:07.472219 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:07.477831 [debug] [Thread-2  ]: On model.first_project.customers2: BEGIN
16:42:07.478103 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: BEGIN
16:42:07.478708 [debug] [Thread-3  ]: Opening a new connection, currently in state init
16:42:07.478492 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:42:07.478292 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
16:42:07.479432 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:42:07.479548 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
16:42:07.479656 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:42:07.489302 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
16:42:07.489593 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
16:42:07.489679 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
16:42:07.491672 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
16:42:07.491869 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:07.491949 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:42:07.494678 [debug] [Thread-2  ]: SQL status: SELECT 100 in 0.0 seconds
16:42:07.500210 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
16:42:07.500523 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.01 seconds
16:42:07.500705 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
16:42:07.502355 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:07.502592 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:42:07.503151 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:42:07.503557 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
16:42:07.504624 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
16:42:07.515794 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:42:07.515004 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:07.515959 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
16:42:07.512543 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
16:42:07.516165 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:42:07.518693 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
16:42:07.520470 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:42:07.520605 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:42:07.516652 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
16:42:07.520719 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
16:42:07.520993 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
16:42:07.521982 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
16:42:07.522416 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:07.522598 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
16:42:07.522883 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:42:07.525658 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:42:07.526298 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:42:07.526125 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
16:42:07.529791 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:42:07.529992 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:42:07.530209 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
16:42:07.532048 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
16:42:07.532256 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
16:42:07.532869 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
16:42:07.534679 [debug] [Thread-2  ]: finished collecting timing info
16:42:07.534815 [debug] [Thread-2  ]: On model.first_project.customers2: Close
16:42:07.535299 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25b800ee-68d1-4e40-9677-a5462dca332f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9f9581f0>]}
16:42:07.535548 [info ] [Thread-2  ]: 2 of 4 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.10s]
16:42:07.535891 [debug] [Thread-2  ]: Finished running node model.first_project.customers2
16:42:07.536617 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
16:42:07.537469 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:42:07.537631 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:42:07.537696 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:42:07.537569 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.01 seconds
16:42:07.538565 [debug] [Thread-3  ]: finished collecting timing info
16:42:07.538711 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: Close
16:42:07.539632 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25b800ee-68d1-4e40-9677-a5462dca332f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9f39e730>]}
16:42:07.539899 [info ] [Thread-3  ]: 3 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.09s]
16:42:07.540332 [debug] [Thread-3  ]: Finished running node model.first_project.my_first_dbt_model
16:42:07.540661 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
16:42:07.541738 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:42:07.541836 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:42:07.542189 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
16:42:07.542350 [info ] [Thread-5  ]: 4 of 4 START view model public.my_second_dbt_model ............................. [RUN]
16:42:07.542599 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:42:07.542766 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
16:42:07.542883 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
16:42:07.544558 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:42:07.544852 [debug] [Thread-5  ]: finished collecting timing info
16:42:07.545123 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
16:42:07.546600 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:42:07.546828 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:42:07.547057 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
16:42:07.547263 [debug] [Thread-5  ]: Opening a new connection, currently in state init
16:42:07.548574 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
16:42:07.550439 [debug] [Thread-1  ]: finished collecting timing info
16:42:07.550628 [debug] [Thread-1  ]: On model.first_project.customers: Close
16:42:07.551205 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25b800ee-68d1-4e40-9677-a5462dca332f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9f3b29a0>]}
16:42:07.551537 [info ] [Thread-1  ]: 1 of 4 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.12s]
16:42:07.551889 [debug] [Thread-1  ]: Finished running node model.first_project.customers
16:42:07.556085 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
16:42:07.556272 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:42:07.556345 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:42:07.557158 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
16:42:07.558830 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:42:07.558941 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:42:07.559306 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
16:42:07.560220 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
16:42:07.560313 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:42:07.560375 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
16:42:07.562192 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
16:42:07.563247 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:42:07.563396 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:42:07.565564 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
16:42:07.566752 [debug] [Thread-5  ]: finished collecting timing info
16:42:07.566902 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
16:42:07.567308 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25b800ee-68d1-4e40-9677-a5462dca332f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9f3c1e80>]}
16:42:07.567650 [info ] [Thread-5  ]: 4 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
16:42:07.567900 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
16:42:07.569615 [debug] [MainThread]: Acquiring new postgres connection "master"
16:42:07.569739 [debug] [MainThread]: Using postgres connection "master"
16:42:07.569804 [debug] [MainThread]: On master: BEGIN
16:42:07.569872 [debug] [MainThread]: Opening a new connection, currently in state closed
16:42:07.575756 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:42:07.575966 [debug] [MainThread]: On master: COMMIT
16:42:07.576036 [debug] [MainThread]: Using postgres connection "master"
16:42:07.576107 [debug] [MainThread]: On master: COMMIT
16:42:07.576359 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:42:07.576458 [debug] [MainThread]: On master: Close
16:42:07.576807 [info ] [MainThread]: 
16:42:07.576968 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0.23s.
16:42:07.577146 [debug] [MainThread]: Connection 'master' was properly closed.
16:42:07.577247 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
16:42:07.577325 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:42:07.577387 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:42:07.577439 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:42:07.580725 [info ] [MainThread]: 
16:42:07.581378 [info ] [MainThread]: [32mCompleted successfully[0m
16:42:07.581667 [info ] [MainThread]: 
16:42:07.581832 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
16:42:07.582147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aa1760280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aa17601c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7aa1ae1e80>]}


============================== 2022-06-04 17:02:20.350877 | 7aa31ebf-6f9f-4e0b-aa2e-c86c51ad6692 ==============================
17:02:20.350893 [info ] [MainThread]: Running with dbt=1.1.0
17:02:20.351466 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:02:20.351569 [debug] [MainThread]: Tracking: tracking
17:02:20.354437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e3a96a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e3a96220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e3a96eb0>]}
17:02:20.376071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
17:02:20.376390 [debug] [MainThread]: Partial parsing: added file: first_project://models/postgres_sample_source/schema.yml
17:02:20.400427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7aa31ebf-6f9f-4e0b-aa2e-c86c51ad6692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e396ff40>]}
17:02:20.404182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7aa31ebf-6f9f-4e0b-aa2e-c86c51ad6692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e39f3e50>]}
17:02:20.404482 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:02:20.404790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aa31ebf-6f9f-4e0b-aa2e-c86c51ad6692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e39f3df0>]}
17:02:20.405728 [info ] [MainThread]: 
17:02:20.406096 [debug] [MainThread]: Acquiring new postgres connection "master"
17:02:20.407088 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:02:20.419867 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:02:20.420133 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:02:20.420233 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:02:20.425687 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:02:20.426751 [debug] [ThreadPool]: On list_erp_oltp: Close
17:02:20.427883 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:02:20.432739 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:02:20.432971 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:02:20.433054 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:02:20.437211 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
17:02:20.437364 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:02:20.437430 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:02:20.439193 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
17:02:20.440270 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:02:20.440551 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:02:20.443835 [debug] [MainThread]: Using postgres connection "master"
17:02:20.443958 [debug] [MainThread]: On master: BEGIN
17:02:20.444030 [debug] [MainThread]: Opening a new connection, currently in state init
17:02:20.449204 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:02:20.449493 [debug] [MainThread]: Using postgres connection "master"
17:02:20.449605 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:02:20.458828 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
17:02:20.459845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aa31ebf-6f9f-4e0b-aa2e-c86c51ad6692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e3a47610>]}
17:02:20.460174 [debug] [MainThread]: On master: ROLLBACK
17:02:20.460512 [debug] [MainThread]: Using postgres connection "master"
17:02:20.460625 [debug] [MainThread]: On master: BEGIN
17:02:20.461191 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:02:20.461324 [debug] [MainThread]: On master: COMMIT
17:02:20.461416 [debug] [MainThread]: Using postgres connection "master"
17:02:20.461479 [debug] [MainThread]: On master: COMMIT
17:02:20.461754 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:02:20.461887 [debug] [MainThread]: On master: Close
17:02:20.462293 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:02:20.462469 [info ] [MainThread]: 
17:02:20.512440 [debug] [Thread-1  ]: Began running node model.first_project.customers
17:02:20.512736 [info ] [Thread-1  ]: 1 of 4 START view model public.customers ....................................... [RUN]
17:02:20.513096 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
17:02:20.513205 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
17:02:20.513332 [debug] [Thread-1  ]: Compiling model.first_project.customers
17:02:20.514768 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
17:02:20.515209 [debug] [Thread-2  ]: Began running node model.first_project.customers2
17:02:20.515455 [info ] [Thread-2  ]: 2 of 4 START table model public.customers2 ..................................... [RUN]
17:02:20.515754 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers2"
17:02:20.515876 [debug] [Thread-3  ]: Began running node model.first_project.my_first_dbt_model
17:02:20.516397 [info ] [Thread-3  ]: 3 of 4 START table model public.my_first_dbt_model ............................. [RUN]
17:02:20.516171 [debug] [Thread-2  ]: Began compiling node model.first_project.customers2
17:02:20.516842 [debug] [Thread-2  ]: Compiling model.first_project.customers2
17:02:20.516675 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:02:20.518490 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers2"
17:02:20.515989 [debug] [Thread-1  ]: finished collecting timing info
17:02:20.518946 [debug] [Thread-1  ]: Began executing node model.first_project.customers
17:02:20.519169 [debug] [Thread-2  ]: finished collecting timing info
17:02:20.531252 [debug] [Thread-2  ]: Began executing node model.first_project.customers2
17:02:20.518637 [debug] [Thread-3  ]: Began compiling node model.first_project.my_first_dbt_model
17:02:20.543998 [debug] [Thread-3  ]: Compiling model.first_project.my_first_dbt_model
17:02:20.545979 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:02:20.561185 [debug] [Thread-3  ]: finished collecting timing info
17:02:20.561482 [debug] [Thread-3  ]: Began executing node model.first_project.my_first_dbt_model
17:02:20.579586 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
17:02:20.592273 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.customers2"
17:02:20.592721 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:02:20.592902 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
17:02:20.592979 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:02:20.593208 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:02:20.593338 [debug] [Thread-2  ]: On model.first_project.customers2: BEGIN
17:02:20.593404 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:02:20.593854 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:02:20.594092 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:02:20.594254 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: BEGIN
17:02:20.594325 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:02:20.600538 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:02:20.600762 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:02:20.600842 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:02:20.603596 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
17:02:20.608424 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:02:20.610707 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:02:20.612531 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
17:02:20.612977 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:02:20.613073 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:02:20.613138 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:02:20.612785 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:02:20.613260 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:02:20.613757 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:02:20.615724 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:02:20.615926 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.0 seconds
17:02:20.616150 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:02:20.618123 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:02:20.618469 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:02:20.619262 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:02:20.623863 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
17:02:20.624037 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:02:20.624116 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
17:02:20.624258 [debug] [Thread-2  ]: SQL status: SELECT 100 in 0.01 seconds
17:02:20.629180 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:02:20.631404 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
17:02:20.624355 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
17:02:20.633404 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:02:20.633621 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:02:20.633767 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:02:20.637556 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:02:20.637906 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
17:02:20.638089 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:02:20.640633 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:02:20.641105 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
17:02:20.640922 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:02:20.644973 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:02:20.646252 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:02:20.646136 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:02:20.645349 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
17:02:20.650368 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
17:02:20.651524 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:02:20.651329 [debug] [Thread-1  ]: finished collecting timing info
17:02:20.651652 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
17:02:20.646368 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:02:20.651805 [debug] [Thread-1  ]: On model.first_project.customers: Close
17:02:20.652852 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aa31ebf-6f9f-4e0b-aa2e-c86c51ad6692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e3936cd0>]}
17:02:20.653164 [info ] [Thread-1  ]: 1 of 4 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.14s]
17:02:20.655475 [debug] [Thread-1  ]: Finished running node model.first_project.customers
17:02:20.655814 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:02:20.657128 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:02:20.657297 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
17:02:20.657234 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
17:02:20.659103 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:02:20.659365 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:02:20.660671 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
17:02:20.661938 [debug] [Thread-2  ]: finished collecting timing info
17:02:20.662099 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
17:02:20.662365 [debug] [Thread-2  ]: On model.first_project.customers2: Close
17:02:20.668363 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aa31ebf-6f9f-4e0b-aa2e-c86c51ad6692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e38bce80>]}
17:02:20.668803 [info ] [Thread-2  ]: 2 of 4 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.15s]
17:02:20.669271 [debug] [Thread-2  ]: Finished running node model.first_project.customers2
17:02:20.663292 [debug] [Thread-3  ]: finished collecting timing info
17:02:20.671162 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: Close
17:02:20.672873 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aa31ebf-6f9f-4e0b-aa2e-c86c51ad6692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e38e8640>]}
17:02:20.673204 [info ] [Thread-3  ]: 3 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.16s]
17:02:20.673494 [debug] [Thread-3  ]: Finished running node model.first_project.my_first_dbt_model
17:02:20.674009 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
17:02:20.674192 [info ] [Thread-5  ]: 4 of 4 START view model public.my_second_dbt_model ............................. [RUN]
17:02:20.674461 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:02:20.674542 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
17:02:20.674622 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
17:02:20.676248 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:02:20.676511 [debug] [Thread-5  ]: finished collecting timing info
17:02:20.676636 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
17:02:20.678175 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:02:20.678526 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:02:20.678667 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
17:02:20.678743 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:02:20.688608 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
17:02:20.688851 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:02:20.688931 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:02:20.693598 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
17:02:20.695816 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:02:20.695983 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:02:20.696582 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:02:20.697558 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:02:20.697696 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:02:20.697771 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:02:20.700737 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
17:02:20.701963 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:02:20.702076 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:02:20.702389 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
17:02:20.703144 [debug] [Thread-5  ]: finished collecting timing info
17:02:20.703291 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
17:02:20.703657 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aa31ebf-6f9f-4e0b-aa2e-c86c51ad6692', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e52ad040>]}
17:02:20.703909 [info ] [Thread-5  ]: 4 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
17:02:20.704184 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
17:02:20.705371 [debug] [MainThread]: Acquiring new postgres connection "master"
17:02:20.705484 [debug] [MainThread]: Using postgres connection "master"
17:02:20.705558 [debug] [MainThread]: On master: BEGIN
17:02:20.705618 [debug] [MainThread]: Opening a new connection, currently in state closed
17:02:20.710505 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:02:20.710721 [debug] [MainThread]: On master: COMMIT
17:02:20.710811 [debug] [MainThread]: Using postgres connection "master"
17:02:20.710878 [debug] [MainThread]: On master: COMMIT
17:02:20.711222 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:02:20.711396 [debug] [MainThread]: On master: Close
17:02:20.711822 [info ] [MainThread]: 
17:02:20.712046 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0.31s.
17:02:20.712175 [debug] [MainThread]: Connection 'master' was properly closed.
17:02:20.712236 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:02:20.712292 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
17:02:20.712346 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:02:20.712401 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:02:20.718677 [info ] [MainThread]: 
17:02:20.719036 [info ] [MainThread]: [32mCompleted successfully[0m
17:02:20.719301 [info ] [MainThread]: 
17:02:20.719428 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
17:02:20.719646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e3958f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e39f3d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8e003c8b0>]}


============================== 2022-06-04 17:09:09.120057 | 67f68884-7476-4a6b-8e37-46b05d7f7d4a ==============================
17:09:09.120070 [info ] [MainThread]: Running with dbt=1.1.0
17:09:09.120478 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:09:09.120615 [debug] [MainThread]: Tracking: tracking
17:09:09.123970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc8ac8070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc8ac8df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc8ac84c0>]}
17:09:09.146901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
17:09:09.147281 [debug] [MainThread]: Partial parsing: added file: first_project://models/postgres_sample_source/postgres_sample_source_customers.sql
17:09:09.160670 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
17:09:09.175462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67f68884-7476-4a6b-8e37-46b05d7f7d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc858b0d0>]}
17:09:09.178916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67f68884-7476-4a6b-8e37-46b05d7f7d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc8a1de20>]}
17:09:09.179244 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:09:09.179410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67f68884-7476-4a6b-8e37-46b05d7f7d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc8a1dcd0>]}
17:09:09.180426 [info ] [MainThread]: 
17:09:09.180736 [debug] [MainThread]: Acquiring new postgres connection "master"
17:09:09.185004 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:09:09.197571 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:09:09.197988 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:09:09.198127 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:09:09.204152 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:09:09.205273 [debug] [ThreadPool]: On list_erp_oltp: Close
17:09:09.207979 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:09:09.212250 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:09:09.212436 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:09:09.212526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:09:09.221407 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:09:09.221609 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:09:09.221686 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:09:09.223440 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
17:09:09.224559 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:09:09.224936 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:09:09.259552 [debug] [MainThread]: Using postgres connection "master"
17:09:09.259779 [debug] [MainThread]: On master: BEGIN
17:09:09.259901 [debug] [MainThread]: Opening a new connection, currently in state init
17:09:09.266760 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:09:09.266950 [debug] [MainThread]: Using postgres connection "master"
17:09:09.267017 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:09:09.276667 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
17:09:09.278318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67f68884-7476-4a6b-8e37-46b05d7f7d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cca349b50>]}
17:09:09.278618 [debug] [MainThread]: On master: ROLLBACK
17:09:09.278912 [debug] [MainThread]: Using postgres connection "master"
17:09:09.279040 [debug] [MainThread]: On master: BEGIN
17:09:09.279425 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:09:09.279551 [debug] [MainThread]: On master: COMMIT
17:09:09.279635 [debug] [MainThread]: Using postgres connection "master"
17:09:09.279713 [debug] [MainThread]: On master: COMMIT
17:09:09.279854 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:09:09.279961 [debug] [MainThread]: On master: Close
17:09:09.280303 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:09:09.280460 [info ] [MainThread]: 
17:09:09.290353 [debug] [Thread-1  ]: Began running node model.first_project.customers
17:09:09.290671 [info ] [Thread-1  ]: 1 of 5 START view model public.customers ....................................... [RUN]
17:09:09.291148 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
17:09:09.291261 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
17:09:09.291340 [debug] [Thread-1  ]: Compiling model.first_project.customers
17:09:09.292291 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
17:09:09.292660 [debug] [Thread-1  ]: finished collecting timing info
17:09:09.292818 [debug] [Thread-1  ]: Began executing node model.first_project.customers
17:09:09.300208 [debug] [Thread-2  ]: Began running node model.first_project.customers2
17:09:09.300495 [info ] [Thread-2  ]: 2 of 5 START table model public.customers2 ..................................... [RUN]
17:09:09.300870 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers2"
17:09:09.300964 [debug] [Thread-2  ]: Began compiling node model.first_project.customers2
17:09:09.301037 [debug] [Thread-2  ]: Compiling model.first_project.customers2
17:09:09.302699 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers2"
17:09:09.303167 [debug] [Thread-2  ]: finished collecting timing info
17:09:09.303409 [debug] [Thread-3  ]: Began running node model.first_project.my_first_dbt_model
17:09:09.303550 [debug] [Thread-2  ]: Began executing node model.first_project.customers2
17:09:09.316901 [debug] [Thread-4  ]: Began running node model.first_project.postgres_sample_source_customers
17:09:09.335116 [info ] [Thread-4  ]: 4 of 5 START view model public.postgres_sample_source_customers ................ [RUN]
17:09:09.323936 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
17:09:09.322725 [info ] [Thread-3  ]: 3 of 5 START table model public.my_first_dbt_model ............................. [RUN]
17:09:09.335761 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:09:09.341065 [debug] [Thread-4  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:09:09.340882 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:09:09.341171 [debug] [Thread-4  ]: Compiling model.first_project.postgres_sample_source_customers
17:09:09.339469 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.customers2"
17:09:09.341367 [debug] [Thread-3  ]: Began compiling node model.first_project.my_first_dbt_model
17:09:09.341634 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:09:09.343710 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:09:09.344960 [debug] [Thread-3  ]: Compiling model.first_project.my_first_dbt_model
17:09:09.345244 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
17:09:09.347453 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:09:09.347807 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:09:09.351369 [debug] [Thread-3  ]: finished collecting timing info
17:09:09.351514 [debug] [Thread-3  ]: Began executing node model.first_project.my_first_dbt_model
17:09:09.355394 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:09:09.355927 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:09:09.356062 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: BEGIN
17:09:09.356133 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:09:09.356344 [debug] [Thread-4  ]: finished collecting timing info
17:09:09.356508 [debug] [Thread-4  ]: Began executing node model.first_project.postgres_sample_source_customers
17:09:09.358205 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:09:09.358476 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:09:09.358566 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:09:09.358645 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:09:09.360597 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:09:09.360904 [debug] [Thread-2  ]: On model.first_project.customers2: BEGIN
17:09:09.360995 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:09:09.362743 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:09:09.363021 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:09:09.363131 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:09:09.365865 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
17:09:09.371267 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:09:09.371597 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
17:09:09.372757 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:09:09.372914 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:09:09.373039 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:09:09.376277 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:09:09.380523 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:09:09.380744 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.01 seconds
17:09:09.380857 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:09:09.383276 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:09:09.383360 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:09:09.383019 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:09:09.380939 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
17:09:09.383620 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:09:09.383693 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
17:09:09.381029 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:09:09.383501 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:09:09.385317 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
17:09:09.387513 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:09:09.387620 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:09:09.387842 [debug] [Thread-2  ]: SQL status: SELECT 100 in 0.0 seconds
17:09:09.387714 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:09:09.389201 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:09:09.390641 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
17:09:09.390490 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:09:09.385735 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:09:09.390790 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
17:09:09.391001 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:09:09.391155 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:09:09.398391 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:09:09.397062 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:09:09.398492 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
17:09:09.396048 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
17:09:09.398600 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:09:09.399043 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:09:09.398943 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:09:09.399366 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
17:09:09.398809 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:09:09.399448 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:09:09.405314 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
17:09:09.408968 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:09:09.410075 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
17:09:09.410184 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:09:09.414730 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:09:09.415068 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:09:09.416321 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
17:09:09.416188 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:09:09.414967 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:09:09.416681 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
17:09:09.416067 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:09:09.418316 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:09:09.418112 [debug] [Thread-4  ]: finished collecting timing info
17:09:09.418224 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:09:09.420357 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:09:09.419094 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: Close
17:09:09.420459 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
17:09:09.416796 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:09:09.421927 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
17:09:09.420831 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67f68884-7476-4a6b-8e37-46b05d7f7d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc8aba8b0>]}
17:09:09.422820 [debug] [Thread-1  ]: finished collecting timing info
17:09:09.423247 [info ] [Thread-4  ]: 4 of 5 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.09s]
17:09:09.423476 [debug] [Thread-1  ]: On model.first_project.customers: Close
17:09:09.423950 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67f68884-7476-4a6b-8e37-46b05d7f7d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc8a70910>]}
17:09:09.424275 [info ] [Thread-1  ]: 1 of 5 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.13s]
17:09:09.426036 [debug] [Thread-4  ]: Finished running node model.first_project.postgres_sample_source_customers
17:09:09.426293 [debug] [Thread-1  ]: Finished running node model.first_project.customers
17:09:09.453296 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.03 seconds
17:09:09.454753 [debug] [Thread-2  ]: finished collecting timing info
17:09:09.454932 [debug] [Thread-2  ]: On model.first_project.customers2: Close
17:09:09.455402 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67f68884-7476-4a6b-8e37-46b05d7f7d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc8aad5e0>]}
17:09:09.455663 [info ] [Thread-2  ]: 2 of 5 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.15s]
17:09:09.455995 [debug] [Thread-2  ]: Finished running node model.first_project.customers2
17:09:09.456212 [debug] [Thread-3  ]: SQL status: COMMIT in 0.03 seconds
17:09:09.457434 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:09:09.457526 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:09:09.459838 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
17:09:09.460897 [debug] [Thread-3  ]: finished collecting timing info
17:09:09.461136 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: Close
17:09:09.461610 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67f68884-7476-4a6b-8e37-46b05d7f7d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc8a26250>]}
17:09:09.461927 [info ] [Thread-3  ]: 3 of 5 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.12s]
17:09:09.462912 [debug] [Thread-3  ]: Finished running node model.first_project.my_first_dbt_model
17:09:09.466154 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
17:09:09.466615 [info ] [Thread-6  ]: 5 of 5 START view model public.my_second_dbt_model ............................. [RUN]
17:09:09.467000 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:09:09.467309 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
17:09:09.467400 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
17:09:09.469397 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:09:09.469648 [debug] [Thread-6  ]: finished collecting timing info
17:09:09.469758 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
17:09:09.471406 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:09:09.471684 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:09:09.471795 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
17:09:09.471873 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:09:09.476283 [debug] [Thread-6  ]: SQL status: BEGIN in 0.0 seconds
17:09:09.476601 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:09:09.476721 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:09:09.480040 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
17:09:09.481720 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:09:09.481842 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:09:09.482452 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:09:09.484926 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
17:09:09.485059 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:09:09.485132 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
17:09:09.486856 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
17:09:09.488012 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:09:09.488102 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:09:09.488422 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
17:09:09.489088 [debug] [Thread-6  ]: finished collecting timing info
17:09:09.489197 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
17:09:09.489545 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67f68884-7476-4a6b-8e37-46b05d7f7d4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc841bf40>]}
17:09:09.489771 [info ] [Thread-6  ]: 5 of 5 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
17:09:09.490011 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
17:09:09.491151 [debug] [MainThread]: Acquiring new postgres connection "master"
17:09:09.491355 [debug] [MainThread]: Using postgres connection "master"
17:09:09.491430 [debug] [MainThread]: On master: BEGIN
17:09:09.491518 [debug] [MainThread]: Opening a new connection, currently in state closed
17:09:09.503090 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:09:09.503394 [debug] [MainThread]: On master: COMMIT
17:09:09.503558 [debug] [MainThread]: Using postgres connection "master"
17:09:09.503640 [debug] [MainThread]: On master: COMMIT
17:09:09.504711 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:09:09.504935 [debug] [MainThread]: On master: Close
17:09:09.505766 [info ] [MainThread]: 
17:09:09.506013 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0.33s.
17:09:09.506152 [debug] [MainThread]: Connection 'master' was properly closed.
17:09:09.506216 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:09:09.506336 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
17:09:09.506422 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:09:09.506478 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:09:09.506529 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:09:09.509844 [info ] [MainThread]: 
17:09:09.510130 [info ] [MainThread]: [32mCompleted successfully[0m
17:09:09.510364 [info ] [MainThread]: 
17:09:09.510518 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
17:09:09.510824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cc8abaca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5cca2d5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ccac36f10>]}


============================== 2022-06-04 17:20:09.119823 | 65ae4020-a6cb-4352-bf26-67eaa550cb1f ==============================
17:20:09.119844 [info ] [MainThread]: Running with dbt=1.1.0
17:20:09.120582 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:20:09.120753 [debug] [MainThread]: Tracking: tracking
17:20:09.125194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f100c02ea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f100c02e220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f100c02eeb0>]}
17:20:09.150570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
17:20:09.151374 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/stag_customers.sql
17:20:09.151741 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
17:20:09.163514 [debug] [MainThread]: 1699: static parser successfully parsed erp/stag_customers.sql
17:20:09.172777 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
17:20:09.174145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f100bf28ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f100bf33340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f100bae8fa0>]}


============================== 2022-06-04 17:22:39.290696 | 52e6dd3b-a148-41df-8263-0f857921c2e9 ==============================
17:22:39.290712 [info ] [MainThread]: Running with dbt=1.1.0
17:22:39.291245 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:22:39.291380 [debug] [MainThread]: Tracking: tracking
17:22:39.294100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f438167e4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f438167ed90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f438167e6d0>]}
17:22:39.321677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
17:22:39.322031 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/stg_customers.sql
17:22:39.322201 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
17:22:39.336156 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
17:22:39.345841 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
17:22:39.353634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52e6dd3b-a148-41df-8263-0f857921c2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43811540d0>]}
17:22:39.357508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52e6dd3b-a148-41df-8263-0f857921c2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43815ef970>]}
17:22:39.357899 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:22:39.358068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52e6dd3b-a148-41df-8263-0f857921c2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43815efbe0>]}
17:22:39.359690 [info ] [MainThread]: 
17:22:39.360094 [debug] [MainThread]: Acquiring new postgres connection "master"
17:22:39.360950 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:22:39.367896 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:22:39.368039 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:22:39.368154 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:22:39.378191 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:22:39.379413 [debug] [ThreadPool]: On list_erp_oltp: Close
17:22:39.380418 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:22:39.395986 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:22:39.396194 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:22:39.396268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:22:39.407495 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:22:39.407716 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:22:39.407789 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:22:39.409652 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
17:22:39.410661 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:22:39.410937 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:22:39.445273 [debug] [MainThread]: Using postgres connection "master"
17:22:39.445458 [debug] [MainThread]: On master: BEGIN
17:22:39.445527 [debug] [MainThread]: Opening a new connection, currently in state init
17:22:39.449962 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:22:39.450137 [debug] [MainThread]: Using postgres connection "master"
17:22:39.450208 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:22:39.459117 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
17:22:39.460338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52e6dd3b-a148-41df-8263-0f857921c2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4382f14700>]}
17:22:39.460644 [debug] [MainThread]: On master: ROLLBACK
17:22:39.460980 [debug] [MainThread]: Using postgres connection "master"
17:22:39.461107 [debug] [MainThread]: On master: BEGIN
17:22:39.461596 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:22:39.461703 [debug] [MainThread]: On master: COMMIT
17:22:39.461792 [debug] [MainThread]: Using postgres connection "master"
17:22:39.461854 [debug] [MainThread]: On master: COMMIT
17:22:39.462144 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:22:39.462254 [debug] [MainThread]: On master: Close
17:22:39.462686 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:22:39.463053 [info ] [MainThread]: 
17:22:39.469034 [debug] [Thread-1  ]: Began running node model.first_project.customers2
17:22:39.469533 [info ] [Thread-1  ]: 1 of 6 START table model public.customers2 ..................................... [RUN]
17:22:39.470038 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers2"
17:22:39.470194 [debug] [Thread-1  ]: Began compiling node model.first_project.customers2
17:22:39.470361 [debug] [Thread-1  ]: Compiling model.first_project.customers2
17:22:39.472074 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers2"
17:22:39.472382 [debug] [Thread-1  ]: finished collecting timing info
17:22:39.472489 [debug] [Thread-1  ]: Began executing node model.first_project.customers2
17:22:39.480870 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
17:22:39.481125 [info ] [Thread-2  ]: 2 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:22:39.481413 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:22:39.481492 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
17:22:39.481557 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
17:22:39.483035 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:22:39.483265 [debug] [Thread-3  ]: Began running node model.first_project.postgres_sample_source_customers
17:22:39.492928 [info ] [Thread-3  ]: 3 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:22:39.493300 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:22:39.493395 [debug] [Thread-3  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:22:39.493508 [debug] [Thread-3  ]: Compiling model.first_project.postgres_sample_source_customers
17:22:39.483673 [debug] [Thread-4  ]: Began running node model.first_project.stg_customers
17:22:39.495678 [info ] [Thread-4  ]: 4 of 6 START view model public.stg_customers ................................... [RUN]
17:22:39.495318 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:22:39.492467 [debug] [Thread-2  ]: finished collecting timing info
17:22:39.496060 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:22:39.496452 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
17:22:39.496811 [debug] [Thread-3  ]: finished collecting timing info
17:22:39.496972 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_customers
17:22:39.513144 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:22:39.513621 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers2"
17:22:39.513883 [debug] [Thread-3  ]: Began executing node model.first_project.postgres_sample_source_customers
17:22:39.514069 [debug] [Thread-4  ]: Compiling model.first_project.stg_customers
17:22:39.520700 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:22:39.528756 [debug] [Thread-4  ]: finished collecting timing info
17:22:39.529251 [debug] [Thread-4  ]: Began executing node model.first_project.stg_customers
17:22:39.546040 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:22:39.548579 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:22:39.549107 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:39.549835 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
17:22:39.549958 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:22:39.550272 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:22:39.550403 [debug] [Thread-4  ]: On model.first_project.stg_customers: BEGIN
17:22:39.550483 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:22:39.549315 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
17:22:39.551502 [debug] [Thread-1  ]: On model.first_project.customers2: BEGIN
17:22:39.551585 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:22:39.552599 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:39.552767 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:22:39.552844 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:22:39.556730 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
17:22:39.556900 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:39.557062 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
17:22:39.560693 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
17:22:39.565303 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:39.565526 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:22:39.565961 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:39.567998 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:39.568237 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:22:39.569410 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:39.575425 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
17:22:39.576194 [debug] [Thread-4  ]: SQL status: BEGIN in 0.03 seconds
17:22:39.576328 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:39.577066 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:22:39.576911 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:22:39.577217 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
   select
     codigo_cliente as customer_id,
     nome as first_name,
     sobrenome as last_name,
     codigo_regiao as region_code
   from erp_oltp.public.clientes
)
select * from customers
  );
17:22:39.576763 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:22:39.577397 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:39.577832 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:22:39.578266 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
17:22:39.580450 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:39.580580 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
17:22:39.580726 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:22:39.582025 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:22:39.582234 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
17:22:39.582642 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
17:22:39.582488 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:22:39.582725 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:22:39.582905 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:39.584982 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:39.585182 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:39.586292 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:22:39.587576 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
17:22:39.587813 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:22:39.587907 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
17:22:39.588079 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
17:22:39.590146 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
17:22:39.590363 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
17:22:39.590532 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
17:22:39.590624 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:39.598314 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:22:39.593797 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:22:39.599286 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:22:39.598909 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:39.601399 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
17:22:39.602242 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
17:22:39.602685 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:39.601964 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
17:22:39.590693 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
17:22:39.606257 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:39.606364 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:22:39.604949 [debug] [Thread-4  ]: finished collecting timing info
17:22:39.606535 [debug] [Thread-4  ]: On model.first_project.stg_customers: Close
17:22:39.606957 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52e6dd3b-a148-41df-8263-0f857921c2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f438158cbb0>]}
17:22:39.603824 [debug] [Thread-1  ]: On model.first_project.customers2: COMMIT
17:22:39.609122 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
17:22:39.607299 [info ] [Thread-4  ]: 4 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.11s]
17:22:39.609289 [debug] [Thread-1  ]: On model.first_project.customers2: COMMIT
17:22:39.599108 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:39.609750 [debug] [Thread-4  ]: Finished running node model.first_project.stg_customers
17:22:39.609997 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
17:22:39.611868 [debug] [Thread-3  ]: finished collecting timing info
17:22:39.610935 [debug] [Thread-6  ]: Began running node model.first_project.customers
17:22:39.612152 [info ] [Thread-6  ]: 5 of 6 START view model public.customers ....................................... [RUN]
17:22:39.612426 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers"
17:22:39.612532 [debug] [Thread-6  ]: Began compiling node model.first_project.customers
17:22:39.612610 [debug] [Thread-6  ]: Compiling model.first_project.customers
17:22:39.614208 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers"
17:22:39.614492 [debug] [Thread-6  ]: finished collecting timing info
17:22:39.614641 [debug] [Thread-6  ]: Began executing node model.first_project.customers
17:22:39.616500 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers"
17:22:39.616940 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:39.617095 [debug] [Thread-6  ]: On model.first_project.customers: BEGIN
17:22:39.617170 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:22:39.612002 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: Close
17:22:39.621680 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52e6dd3b-a148-41df-8263-0f857921c2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43816762e0>]}
17:22:39.622545 [info ] [Thread-3  ]: 3 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.13s]
17:22:39.622087 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:22:39.624019 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
17:22:39.624766 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
17:22:39.624655 [debug] [Thread-3  ]: Finished running node model.first_project.postgres_sample_source_customers
17:22:39.610312 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:22:39.626737 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:22:39.627894 [debug] [Thread-1  ]: finished collecting timing info
17:22:39.628004 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:22:39.629057 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:39.629157 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:22:39.626958 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
17:22:39.629272 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:39.629335 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:22:39.628109 [debug] [Thread-1  ]: On model.first_project.customers2: Close
17:22:39.631170 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52e6dd3b-a148-41df-8263-0f857921c2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4382f23ee0>]}
17:22:39.631331 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
17:22:39.632373 [debug] [Thread-2  ]: finished collecting timing info
17:22:39.632500 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
17:22:39.632778 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52e6dd3b-a148-41df-8263-0f857921c2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43810c21f0>]}
17:22:39.633104 [info ] [Thread-2  ]: 2 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.15s]
17:22:39.631671 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
17:22:39.631553 [info ] [Thread-1  ]: 1 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.16s]
17:22:39.645971 [debug] [Thread-1  ]: Finished running node model.first_project.customers2
17:22:39.645216 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
17:22:39.642109 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:39.646531 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
17:22:39.647070 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
17:22:39.647367 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:22:39.647913 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:22:39.648053 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
17:22:39.648129 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
17:22:39.649879 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:22:39.650238 [debug] [Thread-8  ]: finished collecting timing info
17:22:39.650511 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
17:22:39.652238 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:22:39.652476 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.01 seconds
17:22:39.653829 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:39.653919 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:22:39.654108 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:22:39.654293 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
17:22:39.654369 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:22:39.654595 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:39.655416 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
17:22:39.655553 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:39.655679 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
17:22:39.657370 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
17:22:39.658500 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:39.658607 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:22:39.660930 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
17:22:39.661990 [debug] [Thread-6  ]: finished collecting timing info
17:22:39.662113 [debug] [Thread-6  ]: On model.first_project.customers: Close
17:22:39.663972 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52e6dd3b-a148-41df-8263-0f857921c2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4381124fd0>]}
17:22:39.664267 [info ] [Thread-6  ]: 5 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.05s]
17:22:39.664686 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
17:22:39.664896 [debug] [Thread-6  ]: Finished running node model.first_project.customers
17:22:39.665035 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:22:39.665429 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:22:39.666343 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
17:22:39.669464 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:22:39.669690 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:22:39.671260 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:39.673004 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:22:39.673131 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:22:39.673193 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:22:39.675221 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
17:22:39.676409 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:22:39.676502 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:22:39.676752 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
17:22:39.677626 [debug] [Thread-8  ]: finished collecting timing info
17:22:39.677764 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
17:22:39.679453 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52e6dd3b-a148-41df-8263-0f857921c2e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4383862910>]}
17:22:39.679702 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
17:22:39.680002 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
17:22:39.681736 [debug] [MainThread]: Acquiring new postgres connection "master"
17:22:39.681864 [debug] [MainThread]: Using postgres connection "master"
17:22:39.681978 [debug] [MainThread]: On master: BEGIN
17:22:39.682043 [debug] [MainThread]: Opening a new connection, currently in state closed
17:22:39.690703 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:22:39.690915 [debug] [MainThread]: On master: COMMIT
17:22:39.690989 [debug] [MainThread]: Using postgres connection "master"
17:22:39.691063 [debug] [MainThread]: On master: COMMIT
17:22:39.691394 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:22:39.691530 [debug] [MainThread]: On master: Close
17:22:39.691875 [info ] [MainThread]: 
17:22:39.692042 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.33s.
17:22:39.692157 [debug] [MainThread]: Connection 'master' was properly closed.
17:22:39.692212 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
17:22:39.692264 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:22:39.692318 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:22:39.692375 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:22:39.692434 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:22:39.692484 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:22:39.696407 [info ] [MainThread]: 
17:22:39.696713 [info ] [MainThread]: [32mCompleted successfully[0m
17:22:39.696947 [info ] [MainThread]: 
17:22:39.697083 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:22:39.697385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43815919a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43837ff190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43815ef850>]}


============================== 2022-06-04 17:38:28.433737 | e3687c7e-365b-4aa3-bcd3-1a9e6d4069c6 ==============================
17:38:28.433755 [info ] [MainThread]: Running with dbt=1.1.0
17:38:28.434193 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:38:28.434275 [debug] [MainThread]: Tracking: tracking
17:38:28.437120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf913d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf913dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf913d6d0>]}
17:38:28.459718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:38:28.460141 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers2.sql
17:38:28.476564 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers2.sql
17:38:28.491861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3687c7e-365b-4aa3-bcd3-1a9e6d4069c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf8c130d0>]}
17:38:28.495660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3687c7e-365b-4aa3-bcd3-1a9e6d4069c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf90b4e80>]}
17:38:28.495947 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:38:28.496208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3687c7e-365b-4aa3-bcd3-1a9e6d4069c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf90b4d90>]}
17:38:28.497169 [info ] [MainThread]: 
17:38:28.497491 [debug] [MainThread]: Acquiring new postgres connection "master"
17:38:28.498323 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:38:28.505736 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:38:28.506003 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:38:28.506076 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:38:28.517340 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:38:28.517798 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:38:28.517924 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:38:28.520373 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:38:28.521764 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:38:28.522242 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:38:28.527854 [debug] [MainThread]: Using postgres connection "master"
17:38:28.528035 [debug] [MainThread]: On master: BEGIN
17:38:28.528226 [debug] [MainThread]: Opening a new connection, currently in state init
17:38:28.538370 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:38:28.538575 [debug] [MainThread]: Using postgres connection "master"
17:38:28.538649 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:38:28.548351 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:38:28.549382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3687c7e-365b-4aa3-bcd3-1a9e6d4069c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf905d730>]}
17:38:28.549685 [debug] [MainThread]: On master: ROLLBACK
17:38:28.550161 [debug] [MainThread]: Using postgres connection "master"
17:38:28.550307 [debug] [MainThread]: On master: BEGIN
17:38:28.550864 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:38:28.551056 [debug] [MainThread]: On master: COMMIT
17:38:28.551297 [debug] [MainThread]: Using postgres connection "master"
17:38:28.551388 [debug] [MainThread]: On master: COMMIT
17:38:28.551720 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:38:28.551872 [debug] [MainThread]: On master: Close
17:38:28.552895 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:38:28.553135 [info ] [MainThread]: 
17:38:28.671385 [debug] [Thread-1  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:38:28.671694 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:38:28.672021 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:38:28.672123 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:38:28.672244 [debug] [Thread-1  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:38:28.685726 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:38:28.686202 [info ] [Thread-2  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:38:28.686548 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:38:28.686647 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:38:28.686726 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:38:28.690950 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:38:28.691147 [debug] [Thread-3  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:38:28.691415 [info ] [Thread-3  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
17:38:28.691717 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:38:28.691829 [debug] [Thread-3  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:38:28.691902 [debug] [Thread-3  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:38:28.691239 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:38:28.697188 [info ] [Thread-4  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
17:38:28.697494 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:38:28.697621 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:38:28.697699 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:38:28.700057 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:38:28.700567 [debug] [Thread-4  ]: finished collecting timing info
17:38:28.700699 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:38:28.696213 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:38:28.713080 [debug] [Thread-3  ]: finished collecting timing info
17:38:28.713302 [debug] [Thread-3  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:38:28.725643 [debug] [Thread-2  ]: finished collecting timing info
17:38:28.725878 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:38:28.730617 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:38:28.733944 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:38:28.734286 [debug] [Thread-1  ]: finished collecting timing info
17:38:28.734422 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:38:28.735493 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:38:28.735787 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:38:28.735865 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:38:28.735923 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:38:28.732934 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:38:28.737193 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:38:28.737296 [debug] [Thread-4  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:38:28.737366 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:38:28.741541 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:38:28.741714 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:38:28.741777 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:38:28.743244 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:38:28.743572 [debug] [Thread-3  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:38:28.743662 [debug] [Thread-3  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:38:28.743721 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:38:28.758129 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
17:38:28.758332 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:38:28.758411 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:38:28.758952 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
17:38:28.760432 [debug] [Thread-1  ]: finished collecting timing info
17:38:28.760568 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:38:28.760774 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
17:38:28.760897 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:38:28.760973 [debug] [Thread-4  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:38:28.761896 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
17:38:28.762936 [debug] [Thread-4  ]: finished collecting timing info
17:38:28.763055 [debug] [Thread-4  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:38:28.763276 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:38:28.763594 [error] [Thread-1  ]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.09s]
17:38:28.763976 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:38:28.765347 [debug] [Thread-4  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:38:28.765709 [info ] [Thread-4  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.07s]
17:38:28.765997 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:38:28.771845 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
17:38:28.772068 [debug] [Thread-3  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:38:28.772143 [debug] [Thread-3  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:38:28.772290 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
17:38:28.772367 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:38:28.772428 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:38:28.773184 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:38:28.774260 [debug] [Thread-3  ]: finished collecting timing info
17:38:28.774397 [debug] [Thread-3  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:38:28.774586 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:38:28.775482 [debug] [Thread-2  ]: finished collecting timing info
17:38:28.775591 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:38:28.776281 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:38:28.776659 [info ] [Thread-2  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.09s]
17:38:28.776911 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:38:28.779120 [debug] [Thread-3  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:38:28.779480 [info ] [Thread-3  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.09s]
17:38:28.779736 [debug] [Thread-3  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:38:28.781279 [debug] [MainThread]: Acquiring new postgres connection "master"
17:38:28.781459 [debug] [MainThread]: Using postgres connection "master"
17:38:28.781531 [debug] [MainThread]: On master: BEGIN
17:38:28.781593 [debug] [MainThread]: Opening a new connection, currently in state closed
17:38:28.795661 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:38:28.795883 [debug] [MainThread]: On master: COMMIT
17:38:28.796013 [debug] [MainThread]: Using postgres connection "master"
17:38:28.796084 [debug] [MainThread]: On master: COMMIT
17:38:28.796233 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:38:28.796320 [debug] [MainThread]: On master: Close
17:38:28.796612 [info ] [MainThread]: 
17:38:28.796768 [info ] [MainThread]: Finished running 4 tests in 0.30s.
17:38:28.796893 [debug] [MainThread]: Connection 'master' was properly closed.
17:38:28.796949 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:38:28.796996 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:38:28.797043 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:38:28.797089 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:38:28.800190 [info ] [MainThread]: 
17:38:28.800627 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:38:28.800997 [info ] [MainThread]: 
17:38:28.801193 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:38:28.801398 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:38:28.801622 [info ] [MainThread]: 
17:38:28.801881 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:38:28.806981 [info ] [MainThread]: 
17:38:28.807931 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
17:38:28.809429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf90457f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbf9037ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbfa95a040>]}


============================== 2022-06-04 17:44:33.198104 | 5a56b730-5d87-467e-80dd-7ac8ac515a73 ==============================
17:44:33.198117 [info ] [MainThread]: Running with dbt=1.1.0
17:44:33.198540 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:44:33.198647 [debug] [MainThread]: Tracking: tracking
17:44:33.201243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d348b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d348bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d348b6d0>]}
17:44:33.222727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
17:44:33.223148 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/schema.yml
17:44:33.257590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a56b730-5d87-467e-80dd-7ac8ac515a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d330d0d0>]}
17:44:33.261559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a56b730-5d87-467e-80dd-7ac8ac515a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d3401e50>]}
17:44:33.261883 [info ] [MainThread]: Found 6 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:44:33.262188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a56b730-5d87-467e-80dd-7ac8ac515a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d3401df0>]}
17:44:33.263397 [info ] [MainThread]: 
17:44:33.263898 [debug] [MainThread]: Acquiring new postgres connection "master"
17:44:33.268293 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:44:33.275429 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:44:33.275643 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:44:33.275714 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:44:33.282460 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:44:33.283720 [debug] [ThreadPool]: On list_erp_oltp: Close
17:44:33.284969 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:44:33.290974 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:44:33.291148 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:44:33.291243 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:44:33.297486 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:44:33.297823 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:44:33.297904 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:44:33.303560 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.01 seconds
17:44:33.304819 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:44:33.305312 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:44:33.341222 [debug] [MainThread]: Using postgres connection "master"
17:44:33.341470 [debug] [MainThread]: On master: BEGIN
17:44:33.341550 [debug] [MainThread]: Opening a new connection, currently in state init
17:44:33.348527 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:44:33.348750 [debug] [MainThread]: Using postgres connection "master"
17:44:33.348833 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:44:33.358900 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:44:33.360095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a56b730-5d87-467e-80dd-7ac8ac515a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d3490e50>]}
17:44:33.360541 [debug] [MainThread]: On master: ROLLBACK
17:44:33.361069 [debug] [MainThread]: Using postgres connection "master"
17:44:33.361305 [debug] [MainThread]: On master: BEGIN
17:44:33.362094 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:44:33.362215 [debug] [MainThread]: On master: COMMIT
17:44:33.362317 [debug] [MainThread]: Using postgres connection "master"
17:44:33.362375 [debug] [MainThread]: On master: COMMIT
17:44:33.362703 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:44:33.362849 [debug] [MainThread]: On master: Close
17:44:33.363235 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:44:33.363450 [info ] [MainThread]: 
17:44:33.369295 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
17:44:33.369509 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:44:33.369820 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:44:33.369903 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
17:44:33.369978 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
17:44:33.371525 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:44:33.371823 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
17:44:33.371991 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:44:33.372313 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:44:33.372400 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:44:33.372524 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
17:44:33.373852 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:44:33.374181 [debug] [Thread-2  ]: finished collecting timing info
17:44:33.374407 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
17:44:33.381996 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
17:44:33.387813 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_customers ................................... [RUN]
17:44:33.395104 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:44:33.398220 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:44:33.398512 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
17:44:33.399533 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
17:44:33.399331 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:44:33.400409 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:44:33.398922 [debug] [Thread-1  ]: finished collecting timing info
17:44:33.400629 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:44:33.400986 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
17:44:33.401201 [debug] [Thread-3  ]: finished collecting timing info
17:44:33.401326 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
17:44:33.409080 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
17:44:33.417058 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:44:33.423383 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:44:33.423503 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:44:33.423571 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
17:44:33.423019 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:44:33.423905 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:44:33.424090 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
17:44:33.424212 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:44:33.424730 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:44:33.424852 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
17:44:33.424942 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:44:33.429719 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:44:33.430338 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:44:33.430452 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:44:33.432197 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
17:44:33.436801 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:44:33.436946 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:44:33.437239 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:44:33.437350 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:44:33.437421 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
   select
     codigo_cliente as customer_id,
     nome as first_name,
     sobrenome as last_name,
     codigo_regiao as region_code
   from erp_oltp.public.clientes
)
select * from customers
  );
17:44:33.437544 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:44:33.439387 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:44:33.439528 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:44:33.439685 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
17:44:33.439953 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
17:44:33.441815 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:44:33.444007 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
17:44:33.443619 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:44:33.445208 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:44:33.445921 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:44:33.443797 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:44:33.447666 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:44:33.447870 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:44:33.454431 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:44:33.454532 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:44:33.452514 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:44:33.455040 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:44:33.455826 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:44:33.455916 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:44:33.456148 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:44:33.456005 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:44:33.451894 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:44:33.460244 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:44:33.460457 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:44:33.460598 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
17:44:33.460676 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:44:33.465061 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:44:33.464767 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:44:33.460929 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:44:33.465348 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:44:33.467002 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:44:33.468169 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:44:33.468260 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:44:33.472042 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
17:44:33.474759 [debug] [Thread-3  ]: finished collecting timing info
17:44:33.474916 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
17:44:33.475094 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
17:44:33.476061 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:44:33.476221 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:44:33.476323 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
17:44:33.476807 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a56b730-5d87-467e-80dd-7ac8ac515a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d32a0910>]}
17:44:33.477920 [debug] [Thread-1  ]: finished collecting timing info
17:44:33.478381 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.08s]
17:44:33.478807 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
17:44:33.478989 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
17:44:33.480207 [debug] [Thread-2  ]: finished collecting timing info
17:44:33.480309 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
17:44:33.480975 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a56b730-5d87-467e-80dd-7ac8ac515a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d33332b0>]}
17:44:33.481204 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
17:44:33.481582 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
17:44:33.482053 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a56b730-5d87-467e-80dd-7ac8ac515a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d3284fd0>]}
17:44:33.482261 [debug] [Thread-5  ]: Began running node model.first_project.customers
17:44:33.483093 [info ] [Thread-5  ]: 4 of 6 START view model public.customers ....................................... [RUN]
17:44:33.482359 [debug] [Thread-6  ]: Began running node model.first_project.customers2
17:44:33.483687 [info ] [Thread-6  ]: 5 of 6 START table model public.customers2 ..................................... [RUN]
17:44:33.483990 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
17:44:33.484110 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
17:44:33.484190 [debug] [Thread-6  ]: Compiling model.first_project.customers2
17:44:33.483385 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customers"
17:44:33.486088 [debug] [Thread-5  ]: Began compiling node model.first_project.customers
17:44:33.485899 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
17:44:33.486504 [debug] [Thread-6  ]: finished collecting timing info
17:44:33.486168 [debug] [Thread-5  ]: Compiling model.first_project.customers
17:44:33.482557 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
17:44:33.486708 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
17:44:33.489902 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
17:44:33.488046 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customers"
17:44:33.491432 [debug] [Thread-5  ]: finished collecting timing info
17:44:33.490074 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
17:44:33.490365 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:44:33.491601 [debug] [Thread-5  ]: Began executing node model.first_project.customers
17:44:33.493577 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.customers"
17:44:33.491805 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:44:33.493901 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:44:33.491960 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
17:44:33.482881 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.11s]
17:44:33.494879 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:44:33.495053 [debug] [Thread-5  ]: On model.first_project.customers: BEGIN
17:44:33.495626 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:44:33.499596 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
17:44:33.499880 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
17:44:33.500072 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:44:33.500609 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
17:44:33.502998 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:44:33.503388 [debug] [Thread-8  ]: finished collecting timing info
17:44:33.503499 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
17:44:33.507738 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:44:33.508468 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:44:33.508615 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
17:44:33.508709 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:44:33.517040 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
17:44:33.517364 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:44:33.517452 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:44:33.517853 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
17:44:33.518111 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:44:33.518208 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:44:33.519937 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
17:44:33.523266 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:44:33.523441 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
17:44:33.523606 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.01 seconds
17:44:33.525282 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:44:33.525399 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:44:33.525502 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:44:33.527368 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:44:33.527840 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
17:44:33.527601 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:44:33.528900 [debug] [Thread-5  ]: On model.first_project.customers: COMMIT
17:44:33.528995 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:44:33.529054 [debug] [Thread-5  ]: On model.first_project.customers: COMMIT
17:44:33.530206 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:44:33.532172 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
17:44:33.532301 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:44:33.532375 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
17:44:33.532700 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
17:44:33.534607 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:44:33.535244 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:44:33.534728 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
17:44:33.536366 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:44:33.536540 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
17:44:33.536751 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
17:44:33.537675 [debug] [Thread-5  ]: finished collecting timing info
17:44:33.537883 [debug] [Thread-5  ]: On model.first_project.customers: Close
17:44:33.538330 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a56b730-5d87-467e-80dd-7ac8ac515a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d3283550>]}
17:44:33.539359 [info ] [Thread-5  ]: 4 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.05s]
17:44:33.539899 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
17:44:33.541487 [debug] [Thread-6  ]: finished collecting timing info
17:44:33.541600 [debug] [Thread-8  ]: SQL status: BEGIN in 0.03 seconds
17:44:33.542211 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:44:33.541948 [debug] [Thread-6  ]: On model.first_project.customers2: Close
17:44:33.542327 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:44:33.541801 [debug] [Thread-5  ]: Finished running node model.first_project.customers
17:44:33.542771 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a56b730-5d87-467e-80dd-7ac8ac515a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d021cfa0>]}
17:44:33.543762 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
17:44:33.546173 [info ] [Thread-6  ]: 5 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.06s]
17:44:33.548061 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:44:33.548443 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
17:44:33.548532 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:44:33.549135 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:44:33.549900 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:44:33.550050 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:44:33.550137 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:44:33.552621 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
17:44:33.557834 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:44:33.558188 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:44:33.558755 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
17:44:33.560349 [debug] [Thread-8  ]: finished collecting timing info
17:44:33.560766 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
17:44:33.561447 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a56b730-5d87-467e-80dd-7ac8ac515a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d01c7f40>]}
17:44:33.563455 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
17:44:33.564669 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
17:44:33.566164 [debug] [MainThread]: Acquiring new postgres connection "master"
17:44:33.566340 [debug] [MainThread]: Using postgres connection "master"
17:44:33.566453 [debug] [MainThread]: On master: BEGIN
17:44:33.566526 [debug] [MainThread]: Opening a new connection, currently in state closed
17:44:33.571391 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:44:33.571618 [debug] [MainThread]: On master: COMMIT
17:44:33.571755 [debug] [MainThread]: Using postgres connection "master"
17:44:33.571826 [debug] [MainThread]: On master: COMMIT
17:44:33.572589 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:44:33.572849 [debug] [MainThread]: On master: Close
17:44:33.573304 [info ] [MainThread]: 
17:44:33.573519 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.31s.
17:44:33.573673 [debug] [MainThread]: Connection 'master' was properly closed.
17:44:33.573742 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:44:33.573800 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:44:33.573855 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:44:33.573926 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:44:33.573983 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
17:44:33.574048 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:44:33.587062 [info ] [MainThread]: 
17:44:33.591124 [info ] [MainThread]: [32mCompleted successfully[0m
17:44:33.591377 [info ] [MainThread]: 
17:44:33.591528 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:44:33.591830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d330d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d32a2730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5d560b190>]}


============================== 2022-06-04 17:44:40.984767 | bf67e615-4abd-418c-8540-2aeba69787eb ==============================
17:44:40.984788 [info ] [MainThread]: Running with dbt=1.1.0
17:44:40.985358 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:44:40.985474 [debug] [MainThread]: Tracking: tracking
17:44:40.988065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3ee71a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3ee71220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3ee71eb0>]}
17:44:41.017976 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:44:41.018224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:44:41.022593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf67e615-4abd-418c-8540-2aeba69787eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3ed930d0>]}
17:44:41.027676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf67e615-4abd-418c-8540-2aeba69787eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3ed64340>]}
17:44:41.028022 [info ] [MainThread]: Found 6 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:44:41.028186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf67e615-4abd-418c-8540-2aeba69787eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3ed64250>]}
17:44:41.029324 [info ] [MainThread]: 
17:44:41.029765 [debug] [MainThread]: Acquiring new postgres connection "master"
17:44:41.030686 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:44:41.038210 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:44:41.038335 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:44:41.038413 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:44:41.050834 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:44:41.051130 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:44:41.051358 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:44:41.053152 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:44:41.055572 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:44:41.055799 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:44:41.059964 [debug] [MainThread]: Using postgres connection "master"
17:44:41.060317 [debug] [MainThread]: On master: BEGIN
17:44:41.060472 [debug] [MainThread]: Opening a new connection, currently in state init
17:44:41.065205 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:44:41.065372 [debug] [MainThread]: Using postgres connection "master"
17:44:41.065436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:44:41.074997 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:44:41.076077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf67e615-4abd-418c-8540-2aeba69787eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3ee06e50>]}
17:44:41.076486 [debug] [MainThread]: On master: ROLLBACK
17:44:41.077065 [debug] [MainThread]: Using postgres connection "master"
17:44:41.077274 [debug] [MainThread]: On master: BEGIN
17:44:41.078039 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:44:41.078250 [debug] [MainThread]: On master: COMMIT
17:44:41.078373 [debug] [MainThread]: Using postgres connection "master"
17:44:41.078463 [debug] [MainThread]: On master: COMMIT
17:44:41.078887 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:44:41.079028 [debug] [MainThread]: On master: Close
17:44:41.079520 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:44:41.079876 [info ] [MainThread]: 
17:44:41.085952 [debug] [Thread-1  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:44:41.086174 [info ] [Thread-1  ]: 1 of 5 START test not_null_customers_customer_id ............................... [RUN]
17:44:41.086547 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:44:41.086664 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:44:41.086748 [debug] [Thread-1  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
17:44:41.096941 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:44:41.097338 [info ] [Thread-2  ]: 2 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:44:41.097820 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:44:41.098153 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:44:41.098321 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:44:41.105056 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:44:41.105315 [info ] [Thread-3  ]: 3 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:44:41.105598 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:44:41.105681 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:44:41.105753 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:44:41.123316 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:44:41.123707 [info ] [Thread-4  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
17:44:41.124258 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:44:41.124422 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:44:41.124527 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:44:41.133007 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:44:41.133455 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:44:41.136808 [info ] [Thread-5  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
17:44:41.137142 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:44:41.137239 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:44:41.137308 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:44:41.136580 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:44:41.136256 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:44:41.182741 [debug] [Thread-1  ]: finished collecting timing info
17:44:41.187692 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:44:41.187922 [debug] [Thread-3  ]: finished collecting timing info
17:44:41.190549 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:44:41.190028 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:44:41.190283 [debug] [Thread-2  ]: finished collecting timing info
17:44:41.189650 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:44:41.203897 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:44:41.204389 [debug] [Thread-5  ]: finished collecting timing info
17:44:41.207527 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:44:41.206305 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:44:41.207136 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:44:41.207356 [debug] [Thread-4  ]: finished collecting timing info
17:44:41.210955 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:44:41.212545 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:44:41.210427 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:44:41.205985 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:44:41.208898 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:44:41.213241 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:44:41.214256 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
17:44:41.214341 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:44:41.213655 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:44:41.214634 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:44:41.214850 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:44:41.215263 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:44:41.214094 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:44:41.215400 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:44:41.215737 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:44:41.215526 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:44:41.210779 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:44:41.216228 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:44:41.216082 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:44:41.222495 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
17:44:41.222796 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:44:41.222957 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:44:41.227377 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
17:44:41.230262 [debug] [Thread-4  ]: finished collecting timing info
17:44:41.230790 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:44:41.231047 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
17:44:41.232073 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:44:41.232259 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
17:44:41.231296 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
17:44:41.232453 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:44:41.232741 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:44:41.232957 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:44:41.233201 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:44:41.233389 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:44:41.233577 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:44:41.235168 [info ] [Thread-4  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.11s]
17:44:41.235781 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
17:44:41.239900 [debug] [Thread-1  ]: finished collecting timing info
17:44:41.238231 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:44:41.238633 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:44:41.240072 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
17:44:41.236961 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
17:44:41.241467 [debug] [Thread-2  ]: finished collecting timing info
17:44:41.242738 [debug] [Thread-5  ]: finished collecting timing info
17:44:41.243716 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:44:41.243919 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
17:44:41.244464 [info ] [Thread-1  ]: 1 of 5 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.16s]
17:44:41.243456 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
17:44:41.245078 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:44:41.244887 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:44:41.245235 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:44:41.243029 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:44:41.245357 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:44:41.246306 [info ] [Thread-5  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.11s]
17:44:41.246598 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:44:41.247225 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:44:41.253281 [debug] [Thread-3  ]: finished collecting timing info
17:44:41.253452 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:44:41.255348 [error] [Thread-2  ]: 2 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.16s]
17:44:41.255981 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:44:41.254612 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:44:41.256979 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:44:41.257415 [info ] [Thread-3  ]: 3 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.15s]
17:44:41.257764 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:44:41.263374 [debug] [MainThread]: Acquiring new postgres connection "master"
17:44:41.263744 [debug] [MainThread]: Using postgres connection "master"
17:44:41.263873 [debug] [MainThread]: On master: BEGIN
17:44:41.263957 [debug] [MainThread]: Opening a new connection, currently in state closed
17:44:41.280301 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
17:44:41.280790 [debug] [MainThread]: On master: COMMIT
17:44:41.280975 [debug] [MainThread]: Using postgres connection "master"
17:44:41.281136 [debug] [MainThread]: On master: COMMIT
17:44:41.281663 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:44:41.281959 [debug] [MainThread]: On master: Close
17:44:41.282525 [info ] [MainThread]: 
17:44:41.282758 [info ] [MainThread]: Finished running 5 tests in 0.25s.
17:44:41.282906 [debug] [MainThread]: Connection 'master' was properly closed.
17:44:41.282997 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
17:44:41.283115 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:44:41.283187 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:44:41.283246 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:44:41.283302 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:44:41.287617 [info ] [MainThread]: 
17:44:41.287853 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:44:41.288019 [info ] [MainThread]: 
17:44:41.288138 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:44:41.288272 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:44:41.288384 [info ] [MainThread]: 
17:44:41.288496 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:44:41.288616 [info ] [MainThread]: 
17:44:41.288726 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
17:44:41.288940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3ed63370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3c4b2d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdb3ee06dc0>]}


============================== 2022-06-04 17:49:34.484397 | 0240b7de-cae3-4a46-9536-06eef8a4823e ==============================
17:49:34.484414 [info ] [MainThread]: Running with dbt=1.1.0
17:49:34.485022 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:49:34.485131 [debug] [MainThread]: Tracking: tracking
17:49:34.487760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26c941a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26c941220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26c941eb0>]}
17:49:34.508154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:49:34.508636 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
17:49:34.519795 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
17:49:34.554331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0240b7de-cae3-4a46-9536-06eef8a4823e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26c3ccfa0>]}
17:49:34.559008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0240b7de-cae3-4a46-9536-06eef8a4823e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26c415460>]}
17:49:34.559616 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:49:34.559919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0240b7de-cae3-4a46-9536-06eef8a4823e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26c415490>]}
17:49:34.561091 [info ] [MainThread]: 
17:49:34.561530 [debug] [MainThread]: Acquiring new postgres connection "master"
17:49:34.562756 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:49:34.618706 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:49:34.618981 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:49:34.619058 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:49:34.624971 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:49:34.625160 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:49:34.625306 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:49:34.626905 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:49:34.627960 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:49:34.628283 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:49:34.631127 [debug] [MainThread]: Using postgres connection "master"
17:49:34.631321 [debug] [MainThread]: On master: BEGIN
17:49:34.631409 [debug] [MainThread]: Opening a new connection, currently in state init
17:49:34.635755 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:49:34.635911 [debug] [MainThread]: Using postgres connection "master"
17:49:34.636028 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:49:34.645993 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:49:34.647318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0240b7de-cae3-4a46-9536-06eef8a4823e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26c415940>]}
17:49:34.647569 [debug] [MainThread]: On master: ROLLBACK
17:49:34.647857 [debug] [MainThread]: Using postgres connection "master"
17:49:34.647944 [debug] [MainThread]: On master: BEGIN
17:49:34.648409 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:49:34.648497 [debug] [MainThread]: On master: COMMIT
17:49:34.648620 [debug] [MainThread]: Using postgres connection "master"
17:49:34.648722 [debug] [MainThread]: On master: COMMIT
17:49:34.649095 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:49:34.649253 [debug] [MainThread]: On master: Close
17:49:34.649718 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:49:34.649959 [info ] [MainThread]: 
17:49:34.655337 [debug] [Thread-1  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:49:34.655565 [info ] [Thread-1  ]: 1 of 6 START test not_null_customers_customer_id ............................... [RUN]
17:49:34.655839 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:49:34.655919 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:49:34.655993 [debug] [Thread-1  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
17:49:34.664314 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:49:34.664491 [info ] [Thread-2  ]: 2 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:49:34.664751 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:49:34.664880 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:49:34.665047 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:49:34.667262 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:49:34.669919 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:49:34.665334 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:49:34.670280 [info ] [Thread-6  ]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
17:49:34.666721 [info ] [Thread-3  ]: 3 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:49:34.665190 [debug] [Thread-4  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
17:49:34.673024 [info ] [Thread-4  ]: 4 of 6 START test unique_customers_customer_id ................................. [RUN]
17:49:34.665262 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:49:34.670924 [debug] [Thread-2  ]: finished collecting timing info
17:49:34.673785 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:49:34.672719 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:49:34.673340 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:49:34.673486 [info ] [Thread-5  ]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
17:49:34.689262 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:49:34.689368 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:49:34.689484 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:49:34.682938 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
17:49:34.688845 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:49:34.670698 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:49:34.695304 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:49:34.695419 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:49:34.682628 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:49:34.695101 [debug] [Thread-4  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
17:49:34.666557 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:49:34.694760 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:49:34.697532 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:49:34.697721 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:49:34.700152 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:49:34.700816 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:49:34.705374 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:49:34.704560 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:49:34.704799 [debug] [Thread-6  ]: finished collecting timing info
17:49:34.706275 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:49:34.707519 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:49:34.707823 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:49:34.705732 [debug] [Thread-4  ]: finished collecting timing info
17:49:34.708205 [debug] [Thread-4  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
17:49:34.707994 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:49:34.710033 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:49:34.705947 [debug] [Thread-3  ]: finished collecting timing info
17:49:34.710783 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:49:34.709617 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:49:34.705223 [debug] [Thread-5  ]: finished collecting timing info
17:49:34.713039 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:49:34.713860 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:49:34.713990 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:49:34.714064 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:49:34.713545 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:49:34.714251 [debug] [Thread-4  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: BEGIN
17:49:34.714315 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:49:34.713367 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:49:34.701149 [debug] [Thread-1  ]: finished collecting timing info
17:49:34.717290 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:49:34.705462 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:49:34.716860 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:49:34.718455 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:49:34.723435 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
17:49:34.725587 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:49:34.725818 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:49:34.719708 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:49:34.726048 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:49:34.726144 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:49:34.727023 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
17:49:34.728641 [debug] [Thread-6  ]: finished collecting timing info
17:49:34.728800 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
17:49:34.729119 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:49:34.729256 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:49:34.729767 [debug] [Thread-4  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
17:49:34.730010 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:49:34.730475 [info ] [Thread-6  ]: 6 of 6 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
17:49:34.730788 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:49:34.731557 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:49:34.731736 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
17:49:34.731811 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:49:34.732655 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
17:49:34.733668 [debug] [Thread-4  ]: finished collecting timing info
17:49:34.733805 [debug] [Thread-4  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
17:49:34.733968 [debug] [Thread-4  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: Close
17:49:34.734333 [error] [Thread-4  ]: 4 of 6 FAIL 50 unique_customers_customer_id .................................... [[31mFAIL 50[0m in 0.06s]
17:49:34.734687 [debug] [Thread-4  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
17:49:34.736257 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:49:34.736377 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:49:34.736444 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:49:34.737008 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:49:34.737995 [debug] [Thread-3  ]: finished collecting timing info
17:49:34.738126 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:49:34.738410 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
17:49:34.738527 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:49:34.738601 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:49:34.738768 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:49:34.739138 [info ] [Thread-3  ]: 3 of 6 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.07s]
17:49:34.740868 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:49:34.739291 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:49:34.746405 [debug] [Thread-2  ]: finished collecting timing info
17:49:34.746680 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:49:34.747439 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:49:34.748210 [error] [Thread-2  ]: 2 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.08s]
17:49:34.748937 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:49:34.751377 [debug] [Thread-5  ]: SQL status: BEGIN in 0.03 seconds
17:49:34.751520 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:49:34.751597 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:49:34.752827 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
17:49:34.754830 [debug] [Thread-5  ]: finished collecting timing info
17:49:34.754983 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:49:34.755322 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:49:34.755538 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
17:49:34.755638 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:49:34.755739 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
17:49:34.756032 [info ] [Thread-5  ]: 5 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.07s]
17:49:34.756296 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:49:34.757210 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
17:49:34.758265 [debug] [Thread-1  ]: finished collecting timing info
17:49:34.758384 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
17:49:34.758586 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
17:49:34.759130 [info ] [Thread-1  ]: 1 of 6 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.10s]
17:49:34.759731 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:49:34.761032 [debug] [MainThread]: Acquiring new postgres connection "master"
17:49:34.761157 [debug] [MainThread]: Using postgres connection "master"
17:49:34.761223 [debug] [MainThread]: On master: BEGIN
17:49:34.761282 [debug] [MainThread]: Opening a new connection, currently in state closed
17:49:34.766145 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:49:34.766303 [debug] [MainThread]: On master: COMMIT
17:49:34.766383 [debug] [MainThread]: Using postgres connection "master"
17:49:34.766495 [debug] [MainThread]: On master: COMMIT
17:49:34.766638 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:49:34.766728 [debug] [MainThread]: On master: Close
17:49:34.767003 [info ] [MainThread]: 
17:49:34.767194 [info ] [MainThread]: Finished running 6 tests in 0.21s.
17:49:34.767303 [debug] [MainThread]: Connection 'master' was properly closed.
17:49:34.767404 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
17:49:34.767458 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:49:34.767509 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:49:34.767559 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:49:34.767609 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
17:49:34.767659 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:49:34.770734 [info ] [MainThread]: 
17:49:34.770882 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
17:49:34.771013 [info ] [MainThread]: 
17:49:34.771208 [error] [MainThread]: [31mFailure in test unique_customers_customer_id (models/erp/schema.yml)[0m
17:49:34.771354 [error] [MainThread]:   Got 50 results, configured to fail if != 0
17:49:34.771451 [info ] [MainThread]: 
17:49:34.771549 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/unique_customers_customer_id.sql
17:49:34.771678 [info ] [MainThread]: 
17:49:34.771835 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:49:34.771951 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:49:34.772056 [info ] [MainThread]: 
17:49:34.772196 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:49:34.773658 [info ] [MainThread]: 
17:49:34.774758 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
17:49:34.774958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2713c9ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2713c9f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd26e159f40>]}


============================== 2022-06-04 17:53:11.944912 | 437e69a8-e865-41d3-9fc1-28b437e533ad ==============================
17:53:11.944936 [info ] [MainThread]: Running with dbt=1.1.0
17:53:11.945660 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:53:11.945862 [debug] [MainThread]: Tracking: tracking
17:53:11.949042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01f62745e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01f6274dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01f62746a0>]}
17:53:11.981032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:53:11.981473 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/stg_customers.sql
17:53:11.988900 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
17:53:12.002529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '437e69a8-e865-41d3-9fc1-28b437e533ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01f5cf4f70>]}
17:53:12.006593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '437e69a8-e865-41d3-9fc1-28b437e533ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01f616ef40>]}
17:53:12.006983 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:53:12.007196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '437e69a8-e865-41d3-9fc1-28b437e533ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01f616ee50>]}
17:53:12.008252 [info ] [MainThread]: 
17:53:12.008568 [debug] [MainThread]: Acquiring new postgres connection "master"
17:53:12.009356 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:53:12.019097 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:53:12.019372 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:53:12.019456 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:53:12.026517 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:53:12.027630 [debug] [ThreadPool]: On list_erp_oltp: Close
17:53:12.029258 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:53:12.035142 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:53:12.035370 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:53:12.035484 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:53:12.040198 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
17:53:12.040388 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:53:12.040458 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:53:12.041817 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:53:12.043277 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:53:12.043782 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:53:12.078278 [debug] [MainThread]: Using postgres connection "master"
17:53:12.079007 [debug] [MainThread]: On master: BEGIN
17:53:12.079213 [debug] [MainThread]: Opening a new connection, currently in state init
17:53:12.086015 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:53:12.086195 [debug] [MainThread]: Using postgres connection "master"
17:53:12.086264 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:53:12.096905 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:53:12.098724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '437e69a8-e865-41d3-9fc1-28b437e533ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01f6279340>]}
17:53:12.099016 [debug] [MainThread]: On master: ROLLBACK
17:53:12.099321 [debug] [MainThread]: Using postgres connection "master"
17:53:12.099446 [debug] [MainThread]: On master: BEGIN
17:53:12.099847 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:53:12.099933 [debug] [MainThread]: On master: COMMIT
17:53:12.099993 [debug] [MainThread]: Using postgres connection "master"
17:53:12.100051 [debug] [MainThread]: On master: COMMIT
17:53:12.100206 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:53:12.100289 [debug] [MainThread]: On master: Close
17:53:12.100602 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:53:12.100746 [info ] [MainThread]: 
17:53:12.116769 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
17:53:12.117327 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:53:12.117912 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:53:12.118066 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
17:53:12.118211 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
17:53:12.120528 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:53:12.121022 [debug] [Thread-1  ]: finished collecting timing info
17:53:12.121267 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
17:53:12.128271 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
17:53:12.128501 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:53:12.129022 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:53:12.129551 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:53:12.129720 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
17:53:12.141559 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:53:12.142333 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
17:53:12.151485 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_customers ................................... [RUN]
17:53:12.151130 [debug] [Thread-2  ]: finished collecting timing info
17:53:12.151873 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:53:12.152410 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
17:53:12.152124 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
17:53:12.152518 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
17:53:12.161054 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:53:12.150497 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:53:12.169690 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:53:12.170291 [debug] [Thread-3  ]: finished collecting timing info
17:53:12.170986 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
17:53:12.172997 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:53:12.173206 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:12.173350 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:53:12.173441 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
17:53:12.174704 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:53:12.174873 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
17:53:12.174942 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:53:12.175393 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:12.175488 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
17:53:12.175543 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:53:12.178362 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
17:53:12.178480 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:12.178544 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
17:53:12.179131 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
17:53:12.179292 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:12.179390 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:53:12.181455 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
17:53:12.186961 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
17:53:12.190743 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:12.190928 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:53:12.191611 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:12.191770 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:53:12.191997 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:12.193543 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:12.193654 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:53:12.194180 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:12.198475 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:53:12.198685 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:12.198781 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:53:12.199168 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
17:53:12.200988 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:12.201132 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:53:12.201243 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
17:53:12.204668 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:53:12.204427 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:53:12.204854 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:53:12.204759 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
   select
     codigo_cliente as customer_id,
     nome as first_name,
     sobrenome as last_name,
     codigo_regiao as region_code,
     estado as state
   from erp_oltp.public.clientes
)

select * from customers
  );
17:53:12.206179 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
17:53:12.207850 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:53:12.207958 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
17:53:12.201324 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:53:12.208065 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
17:53:12.208271 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:12.209128 [debug] [Thread-2  ]: finished collecting timing info
17:53:12.210498 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:53:12.210938 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:53:12.210715 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
17:53:12.210591 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:12.216485 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:53:12.216626 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
17:53:12.216948 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '437e69a8-e865-41d3-9fc1-28b437e533ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01f5c6abb0>]}
17:53:12.217994 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:53:12.218455 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:53:12.218326 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.09s]
17:53:12.218545 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:53:12.217213 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:12.218880 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
17:53:12.219160 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:53:12.220258 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
17:53:12.221200 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:53:12.221284 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:53:12.222614 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:53:12.225040 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:53:12.225131 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
17:53:12.226145 [debug] [Thread-3  ]: finished collecting timing info
17:53:12.225217 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:53:12.226344 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
17:53:12.226728 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '437e69a8-e865-41d3-9fc1-28b437e533ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01f4429a00>]}
17:53:12.226949 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.07s]
17:53:12.227206 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
17:53:12.228418 [debug] [Thread-5  ]: Began running node model.first_project.customers
17:53:12.228936 [info ] [Thread-5  ]: 4 of 6 START view model public.customers ....................................... [RUN]
17:53:12.229508 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customers"
17:53:12.229644 [debug] [Thread-5  ]: Began compiling node model.first_project.customers
17:53:12.229769 [debug] [Thread-5  ]: Compiling model.first_project.customers
17:53:12.231841 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customers"
17:53:12.232243 [debug] [Thread-5  ]: finished collecting timing info
17:53:12.232454 [debug] [Thread-5  ]: Began executing node model.first_project.customers
17:53:12.235748 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.customers"
17:53:12.235912 [debug] [Thread-6  ]: Began running node model.first_project.customers2
17:53:12.236373 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
17:53:12.236548 [info ] [Thread-6  ]: 5 of 6 START table model public.customers2 ..................................... [RUN]
17:53:12.236717 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:53:12.238275 [debug] [Thread-5  ]: On model.first_project.customers: BEGIN
17:53:12.238360 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:53:12.237582 [debug] [Thread-1  ]: finished collecting timing info
17:53:12.238772 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
17:53:12.240418 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '437e69a8-e865-41d3-9fc1-28b437e533ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01f7b397f0>]}
17:53:12.240652 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.12s]
17:53:12.240996 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
17:53:12.241258 [debug] [Thread-1  ]: Began running node model.first_project.my_second_dbt_model
17:53:12.241383 [info ] [Thread-1  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:53:12.241641 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:53:12.241734 [debug] [Thread-1  ]: Began compiling node model.first_project.my_second_dbt_model
17:53:12.241831 [debug] [Thread-1  ]: Compiling model.first_project.my_second_dbt_model
17:53:12.244186 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:53:12.244544 [debug] [Thread-1  ]: finished collecting timing info
17:53:12.237950 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
17:53:12.251261 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
17:53:12.251395 [debug] [Thread-6  ]: Compiling model.first_project.customers2
17:53:12.253505 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
17:53:12.244701 [debug] [Thread-1  ]: Began executing node model.first_project.my_second_dbt_model
17:53:12.257523 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:53:12.257763 [debug] [Thread-6  ]: finished collecting timing info
17:53:12.257986 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
17:53:12.260849 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
17:53:12.261115 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:53:12.261298 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:53:12.261430 [debug] [Thread-1  ]: On model.first_project.my_second_dbt_model: BEGIN
17:53:12.261855 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
17:53:12.261999 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:53:12.262250 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:53:12.262561 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
17:53:12.263073 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:53:12.263257 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:53:12.266661 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
17:53:12.268408 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:53:12.268640 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:53:12.269278 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:12.270236 [debug] [Thread-5  ]: On model.first_project.customers: COMMIT
17:53:12.270358 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:53:12.270486 [debug] [Thread-5  ]: On model.first_project.customers: COMMIT
17:53:12.270616 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
17:53:12.270735 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:53:12.270809 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:53:12.271806 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:53:12.272010 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:53:12.272112 [debug] [Thread-1  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:53:12.272279 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
17:53:12.273409 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:53:12.274240 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:53:12.273532 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
17:53:12.276293 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:53:12.276414 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
17:53:12.276532 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
17:53:12.277786 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:53:12.278129 [debug] [Thread-1  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:53:12.277898 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
17:53:12.279053 [debug] [Thread-5  ]: finished collecting timing info
17:53:12.279228 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:12.279373 [debug] [Thread-5  ]: On model.first_project.customers: Close
17:53:12.281219 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:53:12.281426 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
17:53:12.281834 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '437e69a8-e865-41d3-9fc1-28b437e533ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01f43f1ac0>]}
17:53:12.283172 [info ] [Thread-5  ]: 4 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.05s]
17:53:12.283335 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
17:53:12.285420 [debug] [Thread-1  ]: On model.first_project.my_second_dbt_model: COMMIT
17:53:12.283872 [debug] [Thread-5  ]: Finished running node model.first_project.customers
17:53:12.285527 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:53:12.285892 [debug] [Thread-1  ]: On model.first_project.my_second_dbt_model: COMMIT
17:53:12.283436 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:53:12.286866 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
17:53:12.286957 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:53:12.287024 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
17:53:12.288455 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
17:53:12.289461 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:53:12.289550 [debug] [Thread-1  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:53:12.289811 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
17:53:12.290816 [debug] [Thread-1  ]: finished collecting timing info
17:53:12.290927 [debug] [Thread-1  ]: On model.first_project.my_second_dbt_model: Close
17:53:12.291216 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '437e69a8-e865-41d3-9fc1-28b437e533ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01f441bf40>]}
17:53:12.291440 [info ] [Thread-1  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
17:53:12.291884 [debug] [Thread-1  ]: Finished running node model.first_project.my_second_dbt_model
17:53:12.292084 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
17:53:12.293130 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:53:12.293230 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
17:53:12.300039 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.01 seconds
17:53:12.301677 [debug] [Thread-6  ]: finished collecting timing info
17:53:12.301975 [debug] [Thread-6  ]: On model.first_project.customers2: Close
17:53:12.303579 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '437e69a8-e865-41d3-9fc1-28b437e533ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01f6182af0>]}
17:53:12.304078 [info ] [Thread-6  ]: 5 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.07s]
17:53:12.304538 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
17:53:12.305844 [debug] [MainThread]: Acquiring new postgres connection "master"
17:53:12.305966 [debug] [MainThread]: Using postgres connection "master"
17:53:12.306028 [debug] [MainThread]: On master: BEGIN
17:53:12.306090 [debug] [MainThread]: Opening a new connection, currently in state closed
17:53:12.312350 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:53:12.312802 [debug] [MainThread]: On master: COMMIT
17:53:12.313122 [debug] [MainThread]: Using postgres connection "master"
17:53:12.313225 [debug] [MainThread]: On master: COMMIT
17:53:12.313444 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:53:12.313574 [debug] [MainThread]: On master: Close
17:53:12.314060 [info ] [MainThread]: 
17:53:12.314285 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.31s.
17:53:12.314424 [debug] [MainThread]: Connection 'master' was properly closed.
17:53:12.314486 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:53:12.314542 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:53:12.314595 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:53:12.314647 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:53:12.314700 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
17:53:12.317839 [info ] [MainThread]: 
17:53:12.318088 [info ] [MainThread]: [32mCompleted successfully[0m
17:53:12.318250 [info ] [MainThread]: 
17:53:12.318370 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:53:12.318553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01f616eb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01f5c83cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01f8464f40>]}


============================== 2022-06-04 17:54:48.673656 | 68620973-c57d-4acb-899b-7c1803a1db3f ==============================
17:54:48.673705 [info ] [MainThread]: Running with dbt=1.1.0
17:54:48.674336 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:54:48.674422 [debug] [MainThread]: Tracking: tracking
17:54:48.677477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faedfbbaa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faedfbba220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faedfbbaeb0>]}
17:54:48.699486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:54:48.699899 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
17:54:48.713840 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
17:54:48.741853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68620973-c57d-4acb-899b-7c1803a1db3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faedf6440d0>]}
17:54:48.746989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68620973-c57d-4acb-899b-7c1803a1db3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faedf686e50>]}
17:54:48.747448 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:54:48.747737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68620973-c57d-4acb-899b-7c1803a1db3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faedf686e20>]}
17:54:48.749567 [info ] [MainThread]: 
17:54:48.750108 [debug] [MainThread]: Acquiring new postgres connection "master"
17:54:48.751131 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:54:48.801161 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:54:48.801374 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:54:48.801449 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:54:48.808886 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:54:48.809852 [debug] [ThreadPool]: On list_erp_oltp: Close
17:54:48.811328 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:54:48.816243 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:54:48.816401 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:54:48.816469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:54:48.821156 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
17:54:48.821309 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:54:48.821380 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:54:48.823209 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:54:48.825183 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:54:48.825923 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:54:48.828850 [debug] [MainThread]: Using postgres connection "master"
17:54:48.828957 [debug] [MainThread]: On master: BEGIN
17:54:48.829023 [debug] [MainThread]: Opening a new connection, currently in state init
17:54:48.833057 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:54:48.833212 [debug] [MainThread]: Using postgres connection "master"
17:54:48.833281 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:54:48.842977 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:54:48.844831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68620973-c57d-4acb-899b-7c1803a1db3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faee1d933a0>]}
17:54:48.845158 [debug] [MainThread]: On master: ROLLBACK
17:54:48.845507 [debug] [MainThread]: Using postgres connection "master"
17:54:48.845629 [debug] [MainThread]: On master: BEGIN
17:54:48.846227 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:54:48.846335 [debug] [MainThread]: On master: COMMIT
17:54:48.846405 [debug] [MainThread]: Using postgres connection "master"
17:54:48.846461 [debug] [MainThread]: On master: COMMIT
17:54:48.846774 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:54:48.846908 [debug] [MainThread]: On master: Close
17:54:48.847243 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:54:48.847458 [info ] [MainThread]: 
17:54:48.852935 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
17:54:48.853197 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:54:48.853469 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:54:48.853554 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
17:54:48.853631 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
17:54:48.855522 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:54:48.855640 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
17:54:48.856081 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:54:48.856440 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:54:48.856552 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:54:48.856695 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
17:54:48.855749 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
17:54:48.859856 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:54:48.860275 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_customers ................................... [RUN]
17:54:48.860921 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:54:48.861061 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
17:54:48.861164 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
17:54:48.862064 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:54:48.862315 [debug] [Thread-3  ]: finished collecting timing info
17:54:48.862473 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
17:54:48.875329 [debug] [Thread-1  ]: finished collecting timing info
17:54:48.876377 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
17:54:48.890647 [debug] [Thread-2  ]: finished collecting timing info
17:54:48.896570 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
17:54:48.899996 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:54:48.900931 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:54:48.901312 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:54:48.901564 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
17:54:48.901690 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:54:48.913308 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:54:48.908261 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:54:48.912900 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:54:48.913408 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:54:48.915273 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:54:48.915422 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
17:54:48.915484 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:54:48.919125 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
17:54:48.919272 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:54:48.919361 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:54:48.921071 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
17:54:48.926555 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:54:48.926750 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:54:48.926949 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
   select
     codigo_cliente as customer_id,
     nome as first_name,
     sobrenome as last_name,
     codigo_regiao as region_code,
     estado as state
   from erp_oltp.public.clientes
)

select * from customers
  );
17:54:48.928472 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:54:48.928598 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:54:48.929056 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:54:48.929141 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
17:54:48.928866 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
17:54:48.928694 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:54:48.930615 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:54:48.930909 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
17:54:48.931374 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:54:48.931507 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:54:48.933324 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:54:48.934858 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:54:48.935094 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
17:54:48.936877 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:54:48.936966 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:54:48.935289 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:54:48.935531 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:54:48.937442 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:54:48.937582 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:54:48.937717 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:54:48.948308 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:54:48.948404 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:54:48.946535 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:54:48.945517 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:54:48.948584 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:54:48.948708 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:54:48.948830 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:54:48.949412 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:54:48.948938 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:54:48.950308 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:54:48.950686 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:54:48.950818 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:54:48.951766 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
17:54:48.954814 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:54:48.955040 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:54:48.956425 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:54:48.959070 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:54:48.959435 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
17:54:48.959823 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:54:48.961659 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:54:48.962282 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:54:48.962029 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
17:54:48.964609 [debug] [Thread-3  ]: finished collecting timing info
17:54:48.965262 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
17:54:48.965405 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:54:48.967586 [debug] [Thread-1  ]: finished collecting timing info
17:54:48.967799 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
17:54:48.966871 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68620973-c57d-4acb-899b-7c1803a1db3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faedf5f0a00>]}
17:54:48.967885 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
17:54:48.969279 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.11s]
17:54:48.970000 [debug] [Thread-2  ]: finished collecting timing info
17:54:48.970401 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
17:54:48.970708 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68620973-c57d-4acb-899b-7c1803a1db3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faedf5f06a0>]}
17:54:48.970916 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.11s]
17:54:48.971767 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
17:54:48.972181 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68620973-c57d-4acb-899b-7c1803a1db3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faedf5fe130>]}
17:54:48.972491 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.12s]
17:54:48.972791 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
17:54:48.973329 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
17:54:48.973569 [debug] [Thread-5  ]: Began running node model.first_project.customers
17:54:48.974739 [info ] [Thread-5  ]: 4 of 6 START view model public.customers ....................................... [RUN]
17:54:48.975010 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customers"
17:54:48.975119 [debug] [Thread-5  ]: Began compiling node model.first_project.customers
17:54:48.975200 [debug] [Thread-5  ]: Compiling model.first_project.customers
17:54:48.976678 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customers"
17:54:48.976925 [debug] [Thread-5  ]: finished collecting timing info
17:54:48.977018 [debug] [Thread-5  ]: Began executing node model.first_project.customers
17:54:48.978563 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.customers"
17:54:48.973877 [debug] [Thread-6  ]: Began running node model.first_project.customers2
17:54:48.978776 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:54:48.979133 [info ] [Thread-6  ]: 5 of 6 START table model public.customers2 ..................................... [RUN]
17:54:48.979308 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
17:54:48.979979 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:54:48.979840 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
17:54:48.980263 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:54:48.980550 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
17:54:48.980630 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
17:54:48.980434 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
17:54:48.982321 [debug] [Thread-6  ]: Compiling model.first_project.customers2
17:54:48.981858 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:54:48.988949 [debug] [Thread-8  ]: finished collecting timing info
17:54:48.985689 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
17:54:48.989218 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
17:54:48.979449 [debug] [Thread-5  ]: On model.first_project.customers: BEGIN
17:54:48.992815 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:54:48.993382 [debug] [Thread-6  ]: finished collecting timing info
17:54:48.994836 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
17:54:48.996931 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
17:54:48.997165 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:54:48.993611 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:54:48.997330 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
17:54:48.998232 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:54:48.995106 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:54:49.001950 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
17:54:49.002125 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:54:49.006107 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
17:54:49.006369 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:54:49.006562 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customers.state,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:54:49.009085 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
17:54:49.009280 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:54:49.009359 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:54:49.010183 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
17:54:49.011933 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:54:49.012047 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:54:49.012193 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
17:54:49.013746 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:54:49.013895 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
17:54:49.015290 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:54:49.016541 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:54:49.016633 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
17:54:49.016904 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:54:49.017722 [debug] [Thread-5  ]: On model.first_project.customers: COMMIT
17:54:49.017810 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:54:49.017871 [debug] [Thread-5  ]: On model.first_project.customers: COMMIT
17:54:49.017960 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:54:49.018801 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
17:54:49.018885 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:54:49.018946 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
17:54:49.020755 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
17:54:49.021791 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:54:49.021880 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
17:54:49.023880 [debug] [Thread-5  ]: SQL status: COMMIT in 0.01 seconds
17:54:49.025670 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:54:49.026103 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:54:49.026734 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
17:54:49.027678 [debug] [Thread-5  ]: finished collecting timing info
17:54:49.027812 [debug] [Thread-5  ]: On model.first_project.customers: Close
17:54:49.028169 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68620973-c57d-4acb-899b-7c1803a1db3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faedf5bee20>]}
17:54:49.028399 [info ] [Thread-5  ]: 4 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.05s]
17:54:49.028582 [debug] [Thread-8  ]: SQL status: BEGIN in 0.03 seconds
17:54:49.028697 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:54:49.028761 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:54:49.029725 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
17:54:49.029832 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.01 seconds
17:54:49.032713 [debug] [Thread-6  ]: finished collecting timing info
17:54:49.031763 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:54:49.032916 [debug] [Thread-6  ]: On model.first_project.customers2: Close
17:54:49.033713 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68620973-c57d-4acb-899b-7c1803a1db3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faedc570d30>]}
17:54:49.034062 [info ] [Thread-6  ]: 5 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.05s]
17:54:49.030080 [debug] [Thread-5  ]: Finished running node model.first_project.customers
17:54:49.033103 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:54:49.034614 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
17:54:49.036211 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:54:49.037165 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:54:49.037254 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:54:49.037313 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:54:49.038633 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
17:54:49.045188 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:54:49.045615 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:54:49.046731 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
17:54:49.047972 [debug] [Thread-8  ]: finished collecting timing info
17:54:49.048192 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
17:54:49.048638 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68620973-c57d-4acb-899b-7c1803a1db3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faedc561d00>]}
17:54:49.048878 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
17:54:49.050578 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
17:54:49.052071 [debug] [MainThread]: Acquiring new postgres connection "master"
17:54:49.052213 [debug] [MainThread]: Using postgres connection "master"
17:54:49.052337 [debug] [MainThread]: On master: BEGIN
17:54:49.052409 [debug] [MainThread]: Opening a new connection, currently in state closed
17:54:49.059990 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:54:49.060308 [debug] [MainThread]: On master: COMMIT
17:54:49.060461 [debug] [MainThread]: Using postgres connection "master"
17:54:49.060569 [debug] [MainThread]: On master: COMMIT
17:54:49.060846 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:54:49.061007 [debug] [MainThread]: On master: Close
17:54:49.061749 [info ] [MainThread]: 
17:54:49.061948 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.31s.
17:54:49.062128 [debug] [MainThread]: Connection 'master' was properly closed.
17:54:49.062203 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:54:49.062270 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:54:49.062365 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:54:49.062423 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:54:49.062481 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
17:54:49.062537 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:54:49.066269 [info ] [MainThread]: 
17:54:49.066560 [info ] [MainThread]: [32mCompleted successfully[0m
17:54:49.066732 [info ] [MainThread]: 
17:54:49.066837 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:54:49.069866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faedf6685b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faedf686670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faedfabc250>]}


============================== 2022-06-04 17:59:48.985556 | a2b855ef-74d5-4330-af79-8990c6aa5de2 ==============================
17:59:48.985575 [info ] [MainThread]: Running with dbt=1.1.0
17:59:48.986064 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:59:48.986149 [debug] [MainThread]: Tracking: tracking
17:59:48.988609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38286ff640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38286ffd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38286ff6d0>]}
17:59:49.011530 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
17:59:49.012113 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
17:59:49.012387 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
17:59:49.026288 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
17:59:49.096802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2b855ef-74d5-4330-af79-8990c6aa5de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3829f7fe80>]}
17:59:49.101487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2b855ef-74d5-4330-af79-8990c6aa5de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38285fb910>]}
17:59:49.101868 [info ] [MainThread]: Found 6 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:59:49.102105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2b855ef-74d5-4330-af79-8990c6aa5de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38285fbe20>]}
17:59:49.103383 [info ] [MainThread]: 
17:59:49.104122 [debug] [MainThread]: Acquiring new postgres connection "master"
17:59:49.111393 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:59:49.131985 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:59:49.132175 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:59:49.132250 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:59:49.142323 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:59:49.143632 [debug] [ThreadPool]: On list_erp_oltp: Close
17:59:49.147016 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:59:49.151194 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:59:49.151346 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:59:49.151431 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:59:49.156414 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
17:59:49.156660 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:59:49.156754 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:59:49.158051 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:59:49.159025 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:59:49.159229 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:59:49.162264 [debug] [MainThread]: Using postgres connection "master"
17:59:49.162507 [debug] [MainThread]: On master: BEGIN
17:59:49.162606 [debug] [MainThread]: Opening a new connection, currently in state init
17:59:49.168447 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:59:49.168639 [debug] [MainThread]: Using postgres connection "master"
17:59:49.168711 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:59:49.183976 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
17:59:49.185120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2b855ef-74d5-4330-af79-8990c6aa5de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38285fbb50>]}
17:59:49.185375 [debug] [MainThread]: On master: ROLLBACK
17:59:49.185721 [debug] [MainThread]: Using postgres connection "master"
17:59:49.185869 [debug] [MainThread]: On master: BEGIN
17:59:49.186317 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:59:49.186424 [debug] [MainThread]: On master: COMMIT
17:59:49.186493 [debug] [MainThread]: Using postgres connection "master"
17:59:49.186550 [debug] [MainThread]: On master: COMMIT
17:59:49.186787 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:59:49.187000 [debug] [MainThread]: On master: Close
17:59:49.187478 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:59:49.187643 [info ] [MainThread]: 
17:59:49.191676 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
17:59:49.192011 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:59:49.192421 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:59:49.192524 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
17:59:49.192628 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
17:59:49.195399 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:59:49.195607 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
17:59:49.196694 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:59:49.195761 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
17:59:49.197015 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:59:49.197321 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_customers ................................... [RUN]
17:59:49.197583 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:59:49.198923 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
17:59:49.198086 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:59:49.203284 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
17:59:49.203451 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
17:59:49.200489 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:59:49.205061 [debug] [Thread-2  ]: finished collecting timing info
17:59:49.204428 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:59:49.205220 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
17:59:49.197711 [debug] [Thread-1  ]: finished collecting timing info
17:59:49.211333 [debug] [Thread-3  ]: finished collecting timing info
17:59:49.211607 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
17:59:49.222392 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
17:59:49.248886 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:59:49.250144 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:59:49.254526 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:59:49.254781 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:49.255380 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:49.255594 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
17:59:49.255791 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:49.256359 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:59:49.256161 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:59:49.255960 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
17:59:49.256666 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:59:49.256447 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:59:49.261228 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
17:59:49.261428 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:49.261502 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:59:49.262559 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
17:59:49.266817 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:49.266956 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:59:49.267346 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:59:49.267569 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:49.267665 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
17:59:49.267904 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:49.268039 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:59:49.269362 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:49.269454 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
   select
     codigo_cliente as customer_id,
     nome as first_name,
     sobrenome as last_name,
     codigo_regiao as region_code,
     estado as state
   from erp_oltp.public.clientes
)

select * from customers
  );
17:59:49.269253 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:49.269639 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:59:49.269982 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
17:59:49.272348 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:49.272684 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:59:49.272919 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:49.281164 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
17:59:49.282844 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:49.282981 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:59:49.283180 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
17:59:49.284842 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:49.284993 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
17:59:49.285123 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:49.286176 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:59:49.286272 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:49.286336 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:59:49.285386 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:59:49.286481 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:49.286539 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:59:49.287212 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:49.288777 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:49.288894 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:59:49.289653 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:49.290764 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:59:49.290875 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:49.290985 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:59:49.291168 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
17:59:49.295817 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:49.295937 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:59:49.296037 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:59:49.297017 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:49.297138 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
17:59:49.298003 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:59:49.299200 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:49.299478 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
17:59:49.301122 [debug] [Thread-2  ]: finished collecting timing info
17:59:49.301233 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
17:59:49.300262 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:59:49.302176 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
17:59:49.302020 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2b855ef-74d5-4330-af79-8990c6aa5de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f382815d9a0>]}
17:59:49.303328 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.10s]
17:59:49.303910 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
17:59:49.304100 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
17:59:49.304785 [debug] [Thread-3  ]: finished collecting timing info
17:59:49.302905 [debug] [Thread-1  ]: finished collecting timing info
17:59:49.304922 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
17:59:49.305123 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
17:59:49.305823 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2b855ef-74d5-4330-af79-8990c6aa5de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38281a0a90>]}
17:59:49.306161 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
17:59:49.306455 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
17:59:49.307837 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
17:59:49.308049 [info ] [Thread-5  ]: 4 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:59:49.308360 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:59:49.308498 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
17:59:49.308641 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
17:59:49.311035 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:59:49.311368 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2b855ef-74d5-4330-af79-8990c6aa5de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38280b7be0>]}
17:59:49.311837 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.11s]
17:59:49.312242 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
17:59:49.312462 [debug] [Thread-5  ]: finished collecting timing info
17:59:49.312773 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
17:59:49.314406 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:59:49.314514 [debug] [Thread-7  ]: Began running node model.first_project.customers
17:59:49.314741 [info ] [Thread-7  ]: 5 of 6 START view model public.customers ....................................... [RUN]
17:59:49.314970 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers"
17:59:49.315041 [debug] [Thread-7  ]: Began compiling node model.first_project.customers
17:59:49.315131 [debug] [Thread-7  ]: Compiling model.first_project.customers
17:59:49.316619 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers"
17:59:49.314583 [debug] [Thread-8  ]: Began running node model.first_project.customers2
17:59:49.319802 [info ] [Thread-8  ]: 6 of 6 START table model public.customers2 ..................................... [RUN]
17:59:49.320117 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers2"
17:59:49.320278 [debug] [Thread-8  ]: Began compiling node model.first_project.customers2
17:59:49.320352 [debug] [Thread-8  ]: Compiling model.first_project.customers2
17:59:49.322040 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers2"
17:59:49.322555 [debug] [Thread-8  ]: finished collecting timing info
17:59:49.322686 [debug] [Thread-8  ]: Began executing node model.first_project.customers2
17:59:49.316902 [debug] [Thread-7  ]: finished collecting timing info
17:59:49.325335 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers2"
17:59:49.325618 [debug] [Thread-7  ]: Began executing node model.first_project.customers
17:59:49.327337 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.customers"
17:59:49.327595 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:59:49.327814 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:59:49.327912 [debug] [Thread-8  ]: On model.first_project.customers2: BEGIN
17:59:49.328098 [debug] [Thread-7  ]: On model.first_project.customers: BEGIN
17:59:49.328448 [debug] [Thread-7  ]: Opening a new connection, currently in state init
17:59:49.328348 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:59:49.328228 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:59:49.329532 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
17:59:49.329605 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:59:49.332695 [debug] [Thread-8  ]: SQL status: BEGIN in 0.0 seconds
17:59:49.332985 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:59:49.333138 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:59:49.335184 [debug] [Thread-8  ]: SQL status: SELECT 100 in 0.0 seconds
17:59:49.336913 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:59:49.337024 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
17:59:49.338126 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:49.340355 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:59:49.340607 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
17:59:49.342439 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:49.343982 [debug] [Thread-8  ]: On model.first_project.customers2: COMMIT
17:59:49.344475 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:59:49.344681 [debug] [Thread-8  ]: On model.first_project.customers2: COMMIT
17:59:49.347460 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
17:59:49.348755 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:59:49.348862 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
17:59:49.350725 [debug] [Thread-8  ]: SQL status: DROP TABLE in 0.0 seconds
17:59:49.353198 [debug] [Thread-8  ]: finished collecting timing info
17:59:49.353700 [debug] [Thread-8  ]: On model.first_project.customers2: Close
17:59:49.354762 [debug] [Thread-7  ]: SQL status: BEGIN in 0.03 seconds
17:59:49.354904 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:59:49.355022 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state,
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
17:59:49.355407 [debug] [Thread-5  ]: SQL status: BEGIN in 0.03 seconds
17:59:49.355566 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:59:49.355726 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:59:49.356961 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2b855ef-74d5-4330-af79-8990c6aa5de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f382810ea30>]}
17:59:49.357193 [debug] [Thread-7  ]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 32:   from customers
           ^

17:59:49.357504 [info ] [Thread-8  ]: 6 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.04s]
17:59:49.357616 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
17:59:49.357730 [debug] [Thread-7  ]: On model.first_project.customers: ROLLBACK
17:59:49.359792 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:59:49.358076 [debug] [Thread-8  ]: Finished running node model.first_project.customers2
17:59:49.359955 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:59:49.360337 [debug] [Thread-7  ]: finished collecting timing info
17:59:49.360708 [debug] [Thread-7  ]: On model.first_project.customers: Close
17:59:49.360948 [debug] [Thread-7  ]: Database Error in model customers (models/erp/customers.sql)
  syntax error at or near "from"
  LINE 32:   from customers
             ^
  compiled SQL at target/run/first_project/models/erp/customers.sql
17:59:49.361197 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2b855ef-74d5-4330-af79-8990c6aa5de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38280a1dc0>]}
17:59:49.361404 [error] [Thread-7  ]: 5 of 6 ERROR creating view model public.customers .............................. [[31mERROR[0m in 0.05s]
17:59:49.362290 [debug] [Thread-7  ]: Finished running node model.first_project.customers
17:59:49.362703 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:49.366177 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:59:49.366325 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:59:49.366394 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:59:49.367887 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
17:59:49.368838 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:59:49.368982 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:59:49.369314 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
17:59:49.370286 [debug] [Thread-5  ]: finished collecting timing info
17:59:49.370406 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
17:59:49.371448 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2b855ef-74d5-4330-af79-8990c6aa5de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38280c5e50>]}
17:59:49.371798 [info ] [Thread-5  ]: 4 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
17:59:49.372125 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
17:59:49.377792 [debug] [MainThread]: Acquiring new postgres connection "master"
17:59:49.378100 [debug] [MainThread]: Using postgres connection "master"
17:59:49.378192 [debug] [MainThread]: On master: BEGIN
17:59:49.378268 [debug] [MainThread]: Opening a new connection, currently in state closed
17:59:49.384715 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:59:49.384934 [debug] [MainThread]: On master: COMMIT
17:59:49.385007 [debug] [MainThread]: Using postgres connection "master"
17:59:49.385069 [debug] [MainThread]: On master: COMMIT
17:59:49.385214 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:59:49.385326 [debug] [MainThread]: On master: Close
17:59:49.385683 [info ] [MainThread]: 
17:59:49.385903 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.28s.
17:59:49.386056 [debug] [MainThread]: Connection 'master' was properly closed.
17:59:49.386121 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:59:49.386172 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:59:49.386222 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:59:49.386277 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:59:49.386367 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:59:49.386425 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
17:59:49.390458 [info ] [MainThread]: 
17:59:49.390907 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:59:49.391259 [info ] [MainThread]: 
17:59:49.391383 [error] [MainThread]: [33mDatabase Error in model customers (models/erp/customers.sql)[0m
17:59:49.391555 [error] [MainThread]:   syntax error at or near "from"
17:59:49.391718 [error] [MainThread]:   LINE 32:   from customers
17:59:49.391874 [error] [MainThread]:              ^
17:59:49.392042 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/customers.sql
17:59:49.392730 [info ] [MainThread]: 
17:59:49.395399 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
17:59:49.395746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f382814c640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3829f7d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f38280ae9d0>]}


============================== 2022-06-04 18:00:23.240730 | ab56463d-63d2-42dd-aef9-c3b35433d849 ==============================
18:00:23.240745 [info ] [MainThread]: Running with dbt=1.1.0
18:00:23.242375 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:00:23.242504 [debug] [MainThread]: Tracking: tracking
18:00:23.246071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba00ac9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba00ac2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba00ac940>]}
18:00:23.266941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:00:23.267395 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:00:23.277636 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:00:23.345501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab56463d-63d2-42dd-aef9-c3b35433d849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba18c95e0>]}
18:00:23.349536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab56463d-63d2-42dd-aef9-c3b35433d849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9fff1190>]}
18:00:23.349848 [info ] [MainThread]: Found 6 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:00:23.350010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab56463d-63d2-42dd-aef9-c3b35433d849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9fff10a0>]}
18:00:23.351177 [info ] [MainThread]: 
18:00:23.351561 [debug] [MainThread]: Acquiring new postgres connection "master"
18:00:23.352500 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:00:23.359632 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:00:23.359754 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:00:23.359866 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:00:23.366569 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:00:23.367578 [debug] [ThreadPool]: On list_erp_oltp: Close
18:00:23.370952 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:00:23.377799 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:00:23.378030 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:00:23.378098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:00:23.388596 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:00:23.388885 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:00:23.389031 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:00:23.390578 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
18:00:23.391651 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:00:23.392042 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:00:23.395196 [debug] [MainThread]: Using postgres connection "master"
18:00:23.395330 [debug] [MainThread]: On master: BEGIN
18:00:23.395398 [debug] [MainThread]: Opening a new connection, currently in state init
18:00:23.399266 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:00:23.399397 [debug] [MainThread]: Using postgres connection "master"
18:00:23.399461 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:00:23.408636 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
18:00:23.409657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab56463d-63d2-42dd-aef9-c3b35433d849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba18c9b80>]}
18:00:23.409973 [debug] [MainThread]: On master: ROLLBACK
18:00:23.410204 [debug] [MainThread]: Using postgres connection "master"
18:00:23.410290 [debug] [MainThread]: On master: BEGIN
18:00:23.410572 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:00:23.410674 [debug] [MainThread]: On master: COMMIT
18:00:23.410732 [debug] [MainThread]: Using postgres connection "master"
18:00:23.410784 [debug] [MainThread]: On master: COMMIT
18:00:23.410890 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:00:23.410969 [debug] [MainThread]: On master: Close
18:00:23.411386 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:00:23.411553 [info ] [MainThread]: 
18:00:23.417778 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:00:23.418135 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
18:00:23.418592 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:00:23.418775 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:00:23.418865 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:00:23.420645 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:00:23.420928 [debug] [Thread-1  ]: finished collecting timing info
18:00:23.421116 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:00:23.428412 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:00:23.428620 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:00:23.429138 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_customers ................................... [RUN]
18:00:23.429704 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:00:23.429859 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:00:23.429945 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:00:23.430970 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:00:23.431291 [debug] [Thread-3  ]: finished collecting timing info
18:00:23.431467 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:00:23.428919 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
18:00:23.447774 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:00:23.447910 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:00:23.447985 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:00:23.449808 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:00:23.450066 [debug] [Thread-2  ]: finished collecting timing info
18:00:23.450204 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:00:23.469183 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:00:23.470354 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:00:23.478513 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:00:23.475950 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:00:23.478758 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:00:23.479112 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:00:23.480050 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:00:23.480509 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:00:23.480606 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:00:23.480330 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:00:23.481083 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:00:23.481169 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:00:23.485124 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
18:00:23.485398 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:00:23.485489 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:00:23.485590 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:00:23.485704 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:00:23.485769 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
18:00:23.486456 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:00:23.492723 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
18:00:23.495789 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:00:23.495917 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:00:23.496413 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:00:23.497642 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:00:23.498696 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:00:23.498609 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:00:23.498782 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:00:23.498941 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:00:23.499171 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:00:23.499324 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
   select
     codigo_cliente as customer_id,
     nome as first_name,
     sobrenome as last_name,
     codigo_regiao as region_code,
     estado as state
   from erp_oltp.public.clientes
)

select * from customers
  );
18:00:23.499506 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:00:23.500775 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:00:23.500900 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:00:23.499623 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:00:23.501032 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
18:00:23.506919 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
18:00:23.512644 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:00:23.508982 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:00:23.507314 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:00:23.513127 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:00:23.513204 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:00:23.512983 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:00:23.512861 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:00:23.513414 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:00:23.514014 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:00:23.515737 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:00:23.516245 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:00:23.520016 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:00:23.521639 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:00:23.521778 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:00:23.521852 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:00:23.524854 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
18:00:23.528464 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:00:23.528590 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:00:23.528680 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
18:00:23.528767 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
18:00:23.534979 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:00:23.533519 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:00:23.535173 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:00:23.533191 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:00:23.535957 [debug] [Thread-2  ]: finished collecting timing info
18:00:23.537303 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:00:23.537554 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:00:23.538154 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab56463d-63d2-42dd-aef9-c3b35433d849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9fb511f0>]}
18:00:23.538481 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.09s]
18:00:23.538876 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:00:23.540133 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
18:00:23.541519 [debug] [Thread-3  ]: finished collecting timing info
18:00:23.541833 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:00:23.542223 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab56463d-63d2-42dd-aef9-c3b35433d849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9c271dc0>]}
18:00:23.544314 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.11s]
18:00:23.541683 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:00:23.545469 [debug] [Thread-1  ]: finished collecting timing info
18:00:23.545625 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:00:23.547474 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab56463d-63d2-42dd-aef9-c3b35433d849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba192e340>]}
18:00:23.547817 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.13s]
18:00:23.548129 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:00:23.548302 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:00:23.548860 [debug] [Thread-5  ]: Began running node model.first_project.customers
18:00:23.549028 [info ] [Thread-5  ]: 4 of 6 START view model public.customers ....................................... [RUN]
18:00:23.549284 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customers"
18:00:23.549365 [debug] [Thread-5  ]: Began compiling node model.first_project.customers
18:00:23.549437 [debug] [Thread-5  ]: Compiling model.first_project.customers
18:00:23.552577 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customers"
18:00:23.552944 [debug] [Thread-5  ]: finished collecting timing info
18:00:23.553134 [debug] [Thread-5  ]: Began executing node model.first_project.customers
18:00:23.555649 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.customers"
18:00:23.555783 [debug] [Thread-6  ]: Began running node model.first_project.customers2
18:00:23.556048 [info ] [Thread-6  ]: 5 of 6 START table model public.customers2 ..................................... [RUN]
18:00:23.556336 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
18:00:23.556485 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
18:00:23.556578 [debug] [Thread-6  ]: Compiling model.first_project.customers2
18:00:23.558182 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
18:00:23.558517 [debug] [Thread-6  ]: finished collecting timing info
18:00:23.558638 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
18:00:23.555856 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
18:00:23.564828 [info ] [Thread-7  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
18:00:23.565262 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:00:23.565460 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
18:00:23.565533 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
18:00:23.567023 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:00:23.567628 [debug] [Thread-7  ]: finished collecting timing info
18:00:23.567818 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
18:00:23.578610 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:00:23.579197 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
18:00:23.579959 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:00:23.580176 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:00:23.580324 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: BEGIN
18:00:23.580465 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
18:00:23.580608 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:00:23.580787 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:00:23.580953 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
18:00:23.582441 [debug] [Thread-5  ]: On model.first_project.customers: BEGIN
18:00:23.582543 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:00:23.585524 [debug] [Thread-7  ]: SQL status: BEGIN in 0.0 seconds
18:00:23.585687 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:00:23.585812 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:00:23.587050 [debug] [Thread-7  ]: SQL status: CREATE VIEW in 0.0 seconds
18:00:23.588831 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:00:23.588955 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:00:23.589509 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
18:00:23.590749 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: COMMIT
18:00:23.590851 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:00:23.590915 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: COMMIT
18:00:23.594225 [debug] [Thread-7  ]: SQL status: COMMIT in 0.0 seconds
18:00:23.595632 [debug] [Thread-7  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:00:23.595761 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:00:23.595967 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:00:23.596100 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:00:23.596177 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
18:00:23.596279 [debug] [Thread-7  ]: SQL status: DROP VIEW in 0.0 seconds
18:00:23.597079 [debug] [Thread-7  ]: finished collecting timing info
18:00:23.597200 [debug] [Thread-7  ]: On model.first_project.my_second_dbt_model: Close
18:00:23.597561 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab56463d-63d2-42dd-aef9-c3b35433d849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9c25abb0>]}
18:00:23.597803 [info ] [Thread-7  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
18:00:23.599917 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
18:00:23.601599 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:00:23.601706 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:00:23.602049 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:00:23.603721 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:00:23.603844 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:00:23.604192 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:00:23.605162 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:00:23.605269 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:00:23.605341 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:00:23.607189 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
18:00:23.607851 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
18:00:23.608054 [debug] [Thread-5  ]: SQL status: BEGIN in 0.03 seconds
18:00:23.609827 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
18:00:23.609902 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
18:00:23.609636 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:00:23.610108 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:00:23.612807 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
18:00:23.613988 [debug] [Thread-6  ]: finished collecting timing info
18:00:23.614208 [debug] [Thread-6  ]: On model.first_project.customers2: Close
18:00:23.614573 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab56463d-63d2-42dd-aef9-c3b35433d849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9c2711c0>]}
18:00:23.616383 [info ] [Thread-6  ]: 5 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.06s]
18:00:23.616816 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
18:00:23.617887 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.01 seconds
18:00:23.620522 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
18:00:23.620731 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
18:00:23.621445 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
18:00:23.622396 [debug] [Thread-5  ]: On model.first_project.customers: COMMIT
18:00:23.622505 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
18:00:23.622576 [debug] [Thread-5  ]: On model.first_project.customers: COMMIT
18:00:23.623773 [debug] [Thread-5  ]: SQL status: COMMIT in 0.0 seconds
18:00:23.624937 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
18:00:23.625041 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
18:00:23.625288 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
18:00:23.626103 [debug] [Thread-5  ]: finished collecting timing info
18:00:23.626223 [debug] [Thread-5  ]: On model.first_project.customers: Close
18:00:23.626549 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab56463d-63d2-42dd-aef9-c3b35433d849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba00c0460>]}
18:00:23.626820 [info ] [Thread-5  ]: 4 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.08s]
18:00:23.627158 [debug] [Thread-5  ]: Finished running node model.first_project.customers
18:00:23.628836 [debug] [MainThread]: Acquiring new postgres connection "master"
18:00:23.628991 [debug] [MainThread]: Using postgres connection "master"
18:00:23.629066 [debug] [MainThread]: On master: BEGIN
18:00:23.629135 [debug] [MainThread]: Opening a new connection, currently in state closed
18:00:23.634353 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:00:23.634672 [debug] [MainThread]: On master: COMMIT
18:00:23.634752 [debug] [MainThread]: Using postgres connection "master"
18:00:23.634819 [debug] [MainThread]: On master: COMMIT
18:00:23.634977 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:00:23.635085 [debug] [MainThread]: On master: Close
18:00:23.635531 [info ] [MainThread]: 
18:00:23.635700 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.28s.
18:00:23.635817 [debug] [MainThread]: Connection 'master' was properly closed.
18:00:23.635877 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:00:23.635933 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:00:23.635988 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:00:23.636042 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:00:23.636102 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:00:23.636163 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:00:23.651078 [info ] [MainThread]: 
18:00:23.651353 [info ] [MainThread]: [32mCompleted successfully[0m
18:00:23.651523 [info ] [MainThread]: 
18:00:23.651642 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
18:00:23.651892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9c209130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9c209700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb9c209580>]}


============================== 2022-06-04 18:00:28.439393 | 19a59d49-c005-40c5-9bc2-590abbfd6f88 ==============================
18:00:28.439409 [info ] [MainThread]: Running with dbt=1.1.0
18:00:28.439897 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:00:28.439995 [debug] [MainThread]: Tracking: tracking
18:00:28.442872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa078c185e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa078c18dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa078c186a0>]}
18:00:28.464918 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:00:28.466963 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:00:28.476931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19a59d49-c005-40c5-9bc2-590abbfd6f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa078ac80d0>]}
18:00:28.480715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19a59d49-c005-40c5-9bc2-590abbfd6f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa078bad730>]}
18:00:28.481015 [info ] [MainThread]: Found 6 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:00:28.481235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19a59d49-c005-40c5-9bc2-590abbfd6f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa078bad670>]}
18:00:28.482686 [info ] [MainThread]: 
18:00:28.483174 [debug] [MainThread]: Acquiring new postgres connection "master"
18:00:28.484404 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:00:28.490608 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:00:28.490805 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:00:28.490886 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:00:28.506355 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:00:28.506586 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:00:28.506665 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:00:28.508244 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:00:28.509300 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:00:28.509639 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:00:28.512487 [debug] [MainThread]: Using postgres connection "master"
18:00:28.512611 [debug] [MainThread]: On master: BEGIN
18:00:28.512677 [debug] [MainThread]: Opening a new connection, currently in state init
18:00:28.516890 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:00:28.517032 [debug] [MainThread]: Using postgres connection "master"
18:00:28.517096 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:00:28.526449 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
18:00:28.527491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19a59d49-c005-40c5-9bc2-590abbfd6f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa078b10ee0>]}
18:00:28.527752 [debug] [MainThread]: On master: ROLLBACK
18:00:28.528065 [debug] [MainThread]: Using postgres connection "master"
18:00:28.528170 [debug] [MainThread]: On master: BEGIN
18:00:28.528661 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:00:28.528805 [debug] [MainThread]: On master: COMMIT
18:00:28.528885 [debug] [MainThread]: Using postgres connection "master"
18:00:28.528942 [debug] [MainThread]: On master: COMMIT
18:00:28.530171 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:00:28.530285 [debug] [MainThread]: On master: Close
18:00:28.530630 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:00:28.530797 [info ] [MainThread]: 
18:00:28.535318 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:00:28.535525 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT  [RUN]
18:00:28.535811 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:00:28.535908 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:00:28.536023 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:00:28.546083 [debug] [Thread-2  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:00:28.546359 [info ] [Thread-2  ]: 2 of 7 START test not_null_customers_customer_id ............................... [RUN]
18:00:28.546679 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:00:28.546774 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:00:28.546845 [debug] [Thread-2  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
18:00:28.555887 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:00:28.556125 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:28.556201 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:28.556258 [debug] [Thread-5  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:00:28.566533 [info ] [Thread-5  ]: 5 of 7 START test unique_customers_customer_id ................................. [RUN]
18:00:28.566861 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:00:28.566947 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:00:28.567018 [debug] [Thread-5  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
18:00:28.566139 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:00:28.608883 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:28.609010 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:28.609091 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:28.566342 [debug] [Thread-2  ]: finished collecting timing info
18:00:28.615286 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:00:28.565816 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:00:28.627118 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:28.627277 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:28.627357 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:28.615033 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:00:28.556316 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:28.636162 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:00:28.556374 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:28.637440 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:00:28.637930 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:28.638039 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:28.638136 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:28.637103 [debug] [Thread-5  ]: finished collecting timing info
18:00:28.565112 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:00:28.611676 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:28.642058 [debug] [Thread-1  ]: finished collecting timing info
18:00:28.642206 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:00:28.638274 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:00:28.641418 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:28.641711 [debug] [Thread-5  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:00:28.629855 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:28.645228 [debug] [Thread-3  ]: finished collecting timing info
18:00:28.645478 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:28.643527 [debug] [Thread-4  ]: finished collecting timing info
18:00:28.646720 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:28.647891 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:28.636868 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:00:28.644935 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:00:28.646504 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:28.643737 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
18:00:28.646839 [debug] [Thread-7  ]: finished collecting timing info
18:00:28.649370 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:28.650400 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:28.648572 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:28.650568 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:00:28.650659 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:00:28.648935 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:00:28.651123 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: BEGIN
18:00:28.651241 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:00:28.649183 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:00:28.648392 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:28.652097 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:28.652221 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:28.643362 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:00:28.656785 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:00:28.656917 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: BEGIN
18:00:28.656987 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:00:28.649083 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:28.657486 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:00:28.657584 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:00:28.658847 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:28.659060 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:00:28.659274 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:00:28.659460 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:00:28.659577 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:28.659648 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:00:28.659763 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
18:00:28.659837 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:00:28.654992 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:28.659899 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:00:28.660291 [debug] [Thread-6  ]: finished collecting timing info
18:00:28.660413 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:28.661668 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:28.661849 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:28.664181 [debug] [Thread-5  ]: finished collecting timing info
18:00:28.664648 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
18:00:28.661967 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:28.664417 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:28.665667 [debug] [Thread-4  ]: finished collecting timing info
18:00:28.665861 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:00:28.666053 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:00:28.666176 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:00:28.666439 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: Close
18:00:28.666858 [error] [Thread-5  ]: 5 of 7 FAIL 50 unique_customers_customer_id .................................... [[31mFAIL 50[0m in 0.10s]
18:00:28.666535 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:00:28.671797 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.06s]
18:00:28.672506 [debug] [Thread-5  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:00:28.672782 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:28.679885 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:00:28.680151 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:28.680258 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:00:28.681017 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:28.682182 [debug] [Thread-3  ]: finished collecting timing info
18:00:28.682325 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:00:28.682944 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:00:28.683373 [error] [Thread-3  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.06s]
18:00:28.683777 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:28.689741 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:00:28.690077 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:00:28.690216 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."customers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT'
)



      
    ) dbt_internal_test
18:00:28.690578 [debug] [Thread-2  ]: SQL status: BEGIN in 0.04 seconds
18:00:28.690758 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:00:28.690837 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
18:00:28.692157 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
18:00:28.692431 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:28.692535 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:00:28.693335 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:28.694524 [debug] [Thread-6  ]: finished collecting timing info
18:00:28.694658 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:00:28.694935 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:00:28.695382 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.05s]
18:00:28.695819 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:28.697764 [debug] [Thread-7  ]: SQL status: BEGIN in 0.04 seconds
18:00:28.697927 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:28.698011 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:00:28.698725 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:28.699807 [debug] [Thread-7  ]: finished collecting timing info
18:00:28.699952 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:00:28.700143 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.01 seconds
18:00:28.701479 [debug] [Thread-2  ]: finished collecting timing info
18:00:28.701668 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
18:00:28.701794 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
18:00:28.702663 [debug] [Thread-1  ]: finished collecting timing info
18:00:28.702821 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: ROLLBACK
18:00:28.703111 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:00:28.703654 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.07s]
18:00:28.703928 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
18:00:28.704069 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: Close
18:00:28.704390 [info ] [Thread-2  ]: 2 of 7 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.16s]
18:00:28.704739 [error] [Thread-1  ]: 1 of 7 FAIL 3 accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT  [[31mFAIL 3[0m in 0.17s]
18:00:28.705102 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:28.705360 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:00:28.705631 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:00:28.706932 [debug] [MainThread]: Acquiring new postgres connection "master"
18:00:28.707054 [debug] [MainThread]: Using postgres connection "master"
18:00:28.707161 [debug] [MainThread]: On master: BEGIN
18:00:28.707222 [debug] [MainThread]: Opening a new connection, currently in state closed
18:00:28.710825 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:00:28.711025 [debug] [MainThread]: On master: COMMIT
18:00:28.711134 [debug] [MainThread]: Using postgres connection "master"
18:00:28.711200 [debug] [MainThread]: On master: COMMIT
18:00:28.711332 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:00:28.711432 [debug] [MainThread]: On master: Close
18:00:28.711818 [info ] [MainThread]: 
18:00:28.712060 [info ] [MainThread]: Finished running 7 tests in 0.23s.
18:00:28.712207 [debug] [MainThread]: Connection 'master' was properly closed.
18:00:28.712305 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09' was properly closed.
18:00:28.712367 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
18:00:28.712431 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
18:00:28.712485 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:00:28.712602 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:00:28.712655 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:00:28.712709 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:00:28.716832 [info ] [MainThread]: 
18:00:28.717167 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
18:00:28.717305 [info ] [MainThread]: 
18:00:28.717426 [error] [MainThread]: [31mFailure in test unique_customers_customer_id (models/erp/schema.yml)[0m
18:00:28.717538 [error] [MainThread]:   Got 50 results, configured to fail if != 0
18:00:28.718469 [info ] [MainThread]: 
18:00:28.718626 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/unique_customers_customer_id.sql
18:00:28.718732 [info ] [MainThread]: 
18:00:28.718829 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:00:28.718943 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:00:28.719037 [info ] [MainThread]: 
18:00:28.719131 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:00:28.719421 [info ] [MainThread]: 
18:00:28.719623 [error] [MainThread]: [31mFailure in test accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT (models/erp/schema.yml)[0m
18:00:28.719792 [error] [MainThread]:   Got 3 results, configured to fail if != 0
18:00:28.720151 [info ] [MainThread]: 
18:00:28.720254 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/accepted_values_customers_78814b7ce7fca4528a65518db3449206.sql
18:00:28.720443 [info ] [MainThread]: 
18:00:28.720543 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
18:00:28.720724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa07adebc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa078c1d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa078aa5c40>]}


============================== 2022-06-04 18:08:30.001190 | 93e0d82c-fb2c-474a-a425-63e4fcf123a2 ==============================
18:08:30.001205 [info ] [MainThread]: Running with dbt=1.1.0
18:08:30.001594 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:08:30.001715 [debug] [MainThread]: Tracking: tracking
18:08:30.004418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45fa3235e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45fa323dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45fa3236a0>]}
18:08:30.027005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:08:30.027514 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
18:08:30.041807 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:08:30.117537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93e0d82c-fb2c-474a-a425-63e4fcf123a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45fbb40940>]}
18:08:30.121031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93e0d82c-fb2c-474a-a425-63e4fcf123a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45fa268070>]}
18:08:30.121311 [info ] [MainThread]: Found 6 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:08:30.121461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93e0d82c-fb2c-474a-a425-63e4fcf123a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45fa21df70>]}
18:08:30.122631 [info ] [MainThread]: 
18:08:30.123132 [debug] [MainThread]: Acquiring new postgres connection "master"
18:08:30.124583 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:08:30.130328 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:08:30.130431 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:08:30.130497 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:08:30.136318 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:08:30.136626 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:08:30.136760 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:08:30.138236 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:08:30.139289 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:08:30.139565 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:08:30.147785 [debug] [MainThread]: Using postgres connection "master"
18:08:30.148111 [debug] [MainThread]: On master: BEGIN
18:08:30.148191 [debug] [MainThread]: Opening a new connection, currently in state init
18:08:30.157073 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:08:30.157486 [debug] [MainThread]: Using postgres connection "master"
18:08:30.157707 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:08:30.167364 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
18:08:30.168485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93e0d82c-fb2c-474a-a425-63e4fcf123a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45fa21ddf0>]}
18:08:30.168827 [debug] [MainThread]: On master: ROLLBACK
18:08:30.169040 [debug] [MainThread]: Using postgres connection "master"
18:08:30.169134 [debug] [MainThread]: On master: BEGIN
18:08:30.169316 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:08:30.169398 [debug] [MainThread]: On master: COMMIT
18:08:30.169458 [debug] [MainThread]: Using postgres connection "master"
18:08:30.169513 [debug] [MainThread]: On master: COMMIT
18:08:30.169666 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:08:30.169752 [debug] [MainThread]: On master: Close
18:08:30.170021 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:08:30.170177 [info ] [MainThread]: 
18:08:30.177784 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:08:30.177986 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [RUN]
18:08:30.178374 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:08:30.178516 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:08:30.178595 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:08:30.186050 [debug] [Thread-2  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:30.186369 [info ] [Thread-2  ]: 2 of 7 START test not_null_customers_customer_id ............................... [RUN]
18:08:30.186993 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:30.187297 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:30.187455 [debug] [Thread-2  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:30.192986 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:30.195780 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:30.196073 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:08:30.196196 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:30.199600 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:08:30.196272 [debug] [Thread-5  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:30.199803 [info ] [Thread-5  ]: 5 of 7 START test unique_customers_customer_id ................................. [RUN]
18:08:30.196354 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:30.199380 [debug] [Thread-2  ]: finished collecting timing info
18:08:30.196420 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:30.200708 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:08:30.201046 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:30.201153 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:30.201265 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:30.199960 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:08:30.206846 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:30.200441 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:30.207290 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:30.207475 [debug] [Thread-5  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:30.206389 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:30.198777 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:08:30.215545 [debug] [Thread-1  ]: finished collecting timing info
18:08:30.200318 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:30.215819 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:30.215907 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:30.200574 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:30.214855 [debug] [Thread-7  ]: finished collecting timing info
18:08:30.206956 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:30.238187 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:30.200171 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:30.241805 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:30.241909 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:30.245610 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:30.237972 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:30.213871 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:30.215716 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:08:30.218415 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:30.241459 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:30.251569 [debug] [Thread-6  ]: finished collecting timing info
18:08:30.246096 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:30.246299 [debug] [Thread-5  ]: finished collecting timing info
18:08:30.252232 [debug] [Thread-5  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:30.253660 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:30.253924 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:30.254039 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: BEGIN
18:08:30.254136 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:08:30.252065 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
18:08:30.254434 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:08:30.247764 [debug] [Thread-4  ]: finished collecting timing info
18:08:30.255456 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:30.256566 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:30.247528 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:08:30.257016 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:08:30.257191 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: BEGIN
18:08:30.257436 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:08:30.251860 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:30.260304 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:30.260616 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:30.260767 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:08:30.260991 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:08:30.261179 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:30.262354 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:08:30.262437 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:08:30.248272 [debug] [Thread-3  ]: finished collecting timing info
18:08:30.263115 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:30.268012 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:30.234993 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:30.270062 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:30.270372 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:30.270582 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:08:30.271566 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:08:30.272501 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:08:30.272617 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:30.272775 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
18:08:30.273356 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:30.273902 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
18:08:30.275579 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:30.275358 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:30.276145 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:08:30.274236 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:08:30.277712 [debug] [Thread-2  ]: finished collecting timing info
18:08:30.277906 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:08:30.278064 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
18:08:30.279233 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:30.280078 [debug] [Thread-5  ]: finished collecting timing info
18:08:30.280199 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
18:08:30.280286 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
18:08:30.280650 [info ] [Thread-2  ]: 2 of 7 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.09s]
18:08:30.280996 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:30.281260 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: Close
18:08:30.281690 [error] [Thread-5  ]: 5 of 7 FAIL 50 unique_customers_customer_id .................................... [[31mFAIL 50[0m in 0.08s]
18:08:30.282043 [debug] [Thread-5  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:30.284699 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:08:30.284898 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:08:30.284968 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."customers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT','GO','DF','PA'
)



      
    ) dbt_internal_test
18:08:30.287790 [debug] [Thread-4  ]: SQL status: BEGIN in 0.03 seconds
18:08:30.287992 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:30.288060 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:08:30.288598 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:30.289537 [debug] [Thread-1  ]: finished collecting timing info
18:08:30.289677 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: ROLLBACK
18:08:30.289803 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:30.290725 [debug] [Thread-4  ]: finished collecting timing info
18:08:30.290827 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:08:30.292067 [debug] [Thread-7  ]: SQL status: BEGIN in 0.01 seconds
18:08:30.292253 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:08:30.293439 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.09s]
18:08:30.293822 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:30.292391 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: Close
18:08:30.294290 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [[32mPASS[0m in 0.12s]
18:08:30.292613 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:30.294797 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:08:30.294579 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:08:30.292465 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
18:08:30.292861 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:08:30.295016 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:30.295341 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:08:30.295225 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:30.295700 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:08:30.296221 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:30.296333 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:30.297247 [debug] [Thread-6  ]: finished collecting timing info
18:08:30.298242 [debug] [Thread-3  ]: finished collecting timing info
18:08:30.298758 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:08:30.298553 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:08:30.298355 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:30.299669 [debug] [Thread-7  ]: finished collecting timing info
18:08:30.299790 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:08:30.299867 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:08:30.300148 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.09s]
18:08:30.300325 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:08:30.300560 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:30.301018 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.10s]
18:08:30.301287 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:30.301596 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:08:30.301977 [error] [Thread-3  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.10s]
18:08:30.302195 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:30.311269 [debug] [MainThread]: Acquiring new postgres connection "master"
18:08:30.311560 [debug] [MainThread]: Using postgres connection "master"
18:08:30.311646 [debug] [MainThread]: On master: BEGIN
18:08:30.311716 [debug] [MainThread]: Opening a new connection, currently in state closed
18:08:30.316127 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:08:30.316311 [debug] [MainThread]: On master: COMMIT
18:08:30.316379 [debug] [MainThread]: Using postgres connection "master"
18:08:30.316439 [debug] [MainThread]: On master: COMMIT
18:08:30.316565 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:08:30.316657 [debug] [MainThread]: On master: Close
18:08:30.316969 [info ] [MainThread]: 
18:08:30.317136 [info ] [MainThread]: Finished running 7 tests in 0.19s.
18:08:30.317240 [debug] [MainThread]: Connection 'master' was properly closed.
18:08:30.317295 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
18:08:30.317368 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
18:08:30.317418 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:08:30.317465 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:08:30.317512 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
18:08:30.317558 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:08:30.317604 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:08:30.327491 [info ] [MainThread]: 
18:08:30.327811 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
18:08:30.327979 [info ] [MainThread]: 
18:08:30.328172 [error] [MainThread]: [31mFailure in test unique_customers_customer_id (models/erp/schema.yml)[0m
18:08:30.328312 [error] [MainThread]:   Got 50 results, configured to fail if != 0
18:08:30.328426 [info ] [MainThread]: 
18:08:30.328541 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/unique_customers_customer_id.sql
18:08:30.328722 [info ] [MainThread]: 
18:08:30.328836 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:08:30.328956 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:08:30.329064 [info ] [MainThread]: 
18:08:30.329172 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:08:30.329291 [info ] [MainThread]: 
18:08:30.329403 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
18:08:30.329629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45fc126ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f84ce100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45f84ce2e0>]}


============================== 2022-06-04 18:13:19.949375 | 2cc048a7-554e-4838-a373-ebf4e8fbce20 ==============================
18:13:19.949388 [info ] [MainThread]: Running with dbt=1.1.0
18:13:19.949764 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:13:19.949861 [debug] [MainThread]: Tracking: tracking
18:13:19.952524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f247087b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f247087bd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f247087b6d0>]}
18:13:19.975937 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
18:13:19.976476 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/stg_orders.sql
18:13:19.976720 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:13:19.989043 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
18:13:19.999332 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:13:20.067917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cc048a7-554e-4838-a373-ebf4e8fbce20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2472096c70>]}
18:13:20.072330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cc048a7-554e-4838-a373-ebf4e8fbce20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24707be040>]}
18:13:20.072659 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:13:20.072907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cc048a7-554e-4838-a373-ebf4e8fbce20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2470773d90>]}
18:13:20.074275 [info ] [MainThread]: 
18:13:20.074579 [debug] [MainThread]: Acquiring new postgres connection "master"
18:13:20.075707 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:13:20.081784 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:13:20.081907 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:13:20.081978 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:13:20.089001 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:13:20.090442 [debug] [ThreadPool]: On list_erp_oltp: Close
18:13:20.096940 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:13:20.101605 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:13:20.101834 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:13:20.101989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:13:20.106918 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
18:13:20.107272 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:13:20.107361 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:13:20.113050 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.01 seconds
18:13:20.114621 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:13:20.115076 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:13:20.118028 [debug] [MainThread]: Using postgres connection "master"
18:13:20.118149 [debug] [MainThread]: On master: BEGIN
18:13:20.118217 [debug] [MainThread]: Opening a new connection, currently in state init
18:13:20.123749 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:13:20.124273 [debug] [MainThread]: Using postgres connection "master"
18:13:20.124417 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:13:20.134917 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
18:13:20.137916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cc048a7-554e-4838-a373-ebf4e8fbce20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2470773d30>]}
18:13:20.138226 [debug] [MainThread]: On master: ROLLBACK
18:13:20.138819 [debug] [MainThread]: Using postgres connection "master"
18:13:20.138972 [debug] [MainThread]: On master: BEGIN
18:13:20.139476 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:13:20.139740 [debug] [MainThread]: On master: COMMIT
18:13:20.140062 [debug] [MainThread]: Using postgres connection "master"
18:13:20.140168 [debug] [MainThread]: On master: COMMIT
18:13:20.140632 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:13:20.140969 [debug] [MainThread]: On master: Close
18:13:20.141670 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:13:20.142026 [info ] [MainThread]: 
18:13:20.146485 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:13:20.146791 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:13:20.147138 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:13:20.147307 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:13:20.147404 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:13:20.149200 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:13:20.149467 [debug] [Thread-1  ]: finished collecting timing info
18:13:20.149605 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:13:20.156549 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:13:20.157226 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:13:20.157728 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:13:20.157831 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:13:20.157932 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:13:20.159699 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:13:20.159988 [debug] [Thread-2  ]: finished collecting timing info
18:13:20.160108 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:13:20.168507 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:13:20.168830 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
18:13:20.169299 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:13:20.169797 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:13:20.169900 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:13:20.171148 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:13:20.185546 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:13:20.185980 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:13:20.186865 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:13:20.187005 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:13:20.187173 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:13:20.188259 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:13:20.196684 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:13:20.197091 [debug] [Thread-4  ]: finished collecting timing info
18:13:20.209146 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:13:20.210693 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:13:20.210961 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:13:20.211110 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:13:20.211200 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:13:20.208740 [debug] [Thread-3  ]: finished collecting timing info
18:13:20.211463 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:13:20.213183 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:13:20.213677 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:13:20.213914 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:13:20.213983 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:13:20.208583 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:13:20.214681 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:13:20.215410 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:13:20.215508 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:13:20.216579 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:13:20.216744 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:13:20.216804 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:13:20.218922 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:13:20.219047 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:13:20.219147 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
)

select * from orders
  );
18:13:20.220129 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
18:13:20.226825 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:13:20.227611 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:13:20.228205 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:13:20.228540 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:13:20.229209 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
18:13:20.229541 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:13:20.229645 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:13:20.229717 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:13:20.229818 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:13:20.234496 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:13:20.234670 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:13:20.234753 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:13:20.234888 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
18:13:20.236602 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:13:20.236732 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
18:13:20.236935 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:13:20.238605 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:13:20.238900 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:13:20.239238 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:13:20.241039 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:13:20.241198 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:13:20.242792 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:13:20.242891 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:13:20.241492 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:13:20.243041 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
18:13:20.243232 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:13:20.243315 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
   select
     codigo_cliente as customer_id,
     nome as first_name,
     sobrenome as last_name,
     codigo_regiao as region_code,
     estado as state
   from erp_oltp.public.clientes
)

select * from customers
  );
18:13:20.243543 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:13:20.247420 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:13:20.247895 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:13:20.247571 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
18:13:20.247689 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:13:20.241384 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
18:13:20.249358 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:13:20.254016 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:13:20.248009 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:13:20.253844 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:13:20.254371 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:13:20.255324 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
18:13:20.250212 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:13:20.256810 [debug] [Thread-4  ]: finished collecting timing info
18:13:20.256979 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:13:20.257086 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:13:20.259475 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:13:20.259959 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:13:20.259689 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
18:13:20.259828 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:13:20.261381 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:13:20.262200 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:13:20.257249 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:13:20.262847 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc048a7-554e-4838-a373-ebf4e8fbce20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f247267c7c0>]}
18:13:20.263018 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:13:20.263994 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:13:20.264599 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:13:20.264764 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:13:20.266373 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:13:20.266205 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:13:20.265015 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.08s]
18:13:20.266561 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
18:13:20.266690 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:13:20.267657 [debug] [Thread-1  ]: finished collecting timing info
18:13:20.268159 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:13:20.267986 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
18:13:20.270609 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:13:20.272892 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:13:20.267912 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:13:20.272684 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc048a7-554e-4838-a373-ebf4e8fbce20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24702cee50>]}
18:13:20.273533 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.13s]
18:13:20.273842 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:13:20.270764 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:13:20.274623 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
18:13:20.275854 [debug] [Thread-2  ]: finished collecting timing info
18:13:20.276117 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:13:20.276758 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:13:20.276842 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
18:13:20.276392 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:13:20.276927 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
18:13:20.278612 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:13:20.278865 [debug] [Thread-6  ]: finished collecting timing info
18:13:20.279006 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
18:13:20.276247 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
18:13:20.285256 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc048a7-554e-4838-a373-ebf4e8fbce20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2470338be0>]}
18:13:20.286224 [debug] [Thread-3  ]: finished collecting timing info
18:13:20.286460 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:13:20.286843 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.13s]
18:13:20.286997 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:13:20.287557 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:13:20.287875 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc048a7-554e-4838-a373-ebf4e8fbce20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2470253b20>]}
18:13:20.289504 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.12s]
18:13:20.289975 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:13:20.290615 [debug] [Thread-8  ]: Began running node model.first_project.customers
18:13:20.291034 [info ] [Thread-8  ]: 6 of 7 START view model public.customers ....................................... [RUN]
18:13:20.291310 [debug] [Thread-9  ]: Began running node model.first_project.customers2
18:13:20.292064 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
18:13:20.292466 [info ] [Thread-9  ]: 7 of 7 START table model public.customers2 ..................................... [RUN]
18:13:20.292804 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
18:13:20.293784 [debug] [Thread-8  ]: Compiling model.first_project.customers
18:13:20.293551 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers2"
18:13:20.297352 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
18:13:20.298147 [debug] [Thread-8  ]: finished collecting timing info
18:13:20.297609 [debug] [Thread-9  ]: Began compiling node model.first_project.customers2
18:13:20.298388 [debug] [Thread-9  ]: Compiling model.first_project.customers2
18:13:20.293029 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:13:20.300323 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
18:13:20.300094 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers2"
18:13:20.300467 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:13:20.298263 [debug] [Thread-8  ]: Began executing node model.first_project.customers
18:13:20.300717 [debug] [Thread-9  ]: finished collecting timing info
18:13:20.303018 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
18:13:20.303547 [debug] [Thread-9  ]: Began executing node model.first_project.customers2
18:13:20.309340 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.customers2"
18:13:20.309747 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:13:20.310136 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
18:13:20.310348 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:13:20.310499 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:13:20.310651 [debug] [Thread-9  ]: On model.first_project.customers2: BEGIN
18:13:20.311003 [debug] [Thread-9  ]: Opening a new connection, currently in state init
18:13:20.314807 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
18:13:20.314974 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:13:20.315053 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:13:20.315855 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
18:13:20.315973 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:13:20.316099 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
with orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
18:13:20.316199 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
18:13:20.317676 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:13:20.317770 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:13:20.318056 [debug] [Thread-8  ]: Postgres adapter: Postgres error: syntax error at or near "with"
LINE 7: with orders as (
        ^

18:13:20.318168 [debug] [Thread-8  ]: On model.first_project.customers: ROLLBACK
18:13:20.318299 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:13:20.319156 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
18:13:20.319266 [debug] [Thread-9  ]: SQL status: BEGIN in 0.01 seconds
18:13:20.319743 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:13:20.319840 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
18:13:20.319627 [debug] [Thread-8  ]: finished collecting timing info
18:13:20.320030 [debug] [Thread-8  ]: On model.first_project.customers: Close
18:13:20.320271 [debug] [Thread-8  ]: Database Error in model customers (models/erp/customers.sql)
  syntax error at or near "with"
  LINE 7: with orders as (
          ^
  compiled SQL at target/run/first_project/models/erp/customers.sql
18:13:20.320434 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc048a7-554e-4838-a373-ebf4e8fbce20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f24701f6bb0>]}
18:13:20.320644 [error] [Thread-8  ]: 6 of 7 ERROR creating view model public.customers .............................. [[31mERROR[0m in 0.03s]
18:13:20.320986 [debug] [Thread-8  ]: Finished running node model.first_project.customers
18:13:20.319446 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:13:20.321271 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
18:13:20.321786 [debug] [Thread-9  ]: SQL status: SELECT 100 in 0.0 seconds
18:13:20.325236 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:13:20.325407 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:13:20.325843 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
18:13:20.327846 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:13:20.327980 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:13:20.328327 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
18:13:20.329331 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
18:13:20.329424 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:13:20.329484 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
18:13:20.331105 [debug] [Thread-9  ]: SQL status: COMMIT in 0.0 seconds
18:13:20.332319 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:13:20.332403 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:13:20.334592 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
18:13:20.336368 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:13:20.336490 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:13:20.336607 [debug] [Thread-9  ]: SQL status: DROP TABLE in 0.0 seconds
18:13:20.337841 [debug] [Thread-9  ]: finished collecting timing info
18:13:20.338048 [debug] [Thread-9  ]: On model.first_project.customers2: Close
18:13:20.338233 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
18:13:20.339148 [debug] [Thread-6  ]: finished collecting timing info
18:13:20.339268 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
18:13:20.340563 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc048a7-554e-4838-a373-ebf4e8fbce20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2470210ca0>]}
18:13:20.340949 [info ] [Thread-9  ]: 7 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.05s]
18:13:20.341456 [debug] [Thread-9  ]: Finished running node model.first_project.customers2
18:13:20.341967 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cc048a7-554e-4838-a373-ebf4e8fbce20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2470208b20>]}
18:13:20.342225 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
18:13:20.342537 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
18:13:20.344862 [debug] [MainThread]: Acquiring new postgres connection "master"
18:13:20.345050 [debug] [MainThread]: Using postgres connection "master"
18:13:20.345144 [debug] [MainThread]: On master: BEGIN
18:13:20.345236 [debug] [MainThread]: Opening a new connection, currently in state closed
18:13:20.349817 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:13:20.349952 [debug] [MainThread]: On master: COMMIT
18:13:20.350023 [debug] [MainThread]: Using postgres connection "master"
18:13:20.350088 [debug] [MainThread]: On master: COMMIT
18:13:20.350383 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:13:20.350487 [debug] [MainThread]: On master: Close
18:13:20.350798 [info ] [MainThread]: 
18:13:20.351056 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.28s.
18:13:20.351280 [debug] [MainThread]: Connection 'master' was properly closed.
18:13:20.351358 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:13:20.351429 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:13:20.351504 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:13:20.351560 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:13:20.351612 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:13:20.351665 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:13:20.351717 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:13:20.356062 [info ] [MainThread]: 
18:13:20.357604 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:13:20.365150 [info ] [MainThread]: 
18:13:20.365399 [error] [MainThread]: [33mDatabase Error in model customers (models/erp/customers.sql)[0m
18:13:20.365532 [error] [MainThread]:   syntax error at or near "with"
18:13:20.365742 [error] [MainThread]:   LINE 7: with orders as (
18:13:20.365968 [error] [MainThread]:           ^
18:13:20.366096 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/customers.sql
18:13:20.366278 [info ] [MainThread]: 
18:13:20.366418 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
18:13:20.366694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2470319640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2470319160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2470207e50>]}


============================== 2022-06-04 18:14:05.511887 | 439f5db4-7087-45f8-93be-5cc2d3f0b447 ==============================
18:14:05.511900 [info ] [MainThread]: Running with dbt=1.1.0
18:14:05.512320 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:14:05.512403 [debug] [MainThread]: Tracking: tracking
18:14:05.515001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd810d8a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd810d8220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd810d8eb0>]}
18:14:05.536050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:14:05.536495 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:14:05.553460 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:14:05.626912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '439f5db4-7087-45f8-93be-5cc2d3f0b447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd80ff93a0>]}
18:14:05.630344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '439f5db4-7087-45f8-93be-5cc2d3f0b447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd810171c0>]}
18:14:05.630590 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:14:05.630770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '439f5db4-7087-45f8-93be-5cc2d3f0b447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd81017250>]}
18:14:05.631903 [info ] [MainThread]: 
18:14:05.632291 [debug] [MainThread]: Acquiring new postgres connection "master"
18:14:05.633262 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:14:05.640669 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:14:05.640886 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:14:05.640980 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:14:05.655253 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:14:05.656854 [debug] [ThreadPool]: On list_erp_oltp: Close
18:14:05.659981 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:14:05.664915 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:14:05.665078 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:14:05.665147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:14:05.674654 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:14:05.674862 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:14:05.674934 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:14:05.676476 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:14:05.677407 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:14:05.677836 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:14:05.681078 [debug] [MainThread]: Using postgres connection "master"
18:14:05.681262 [debug] [MainThread]: On master: BEGIN
18:14:05.681339 [debug] [MainThread]: Opening a new connection, currently in state init
18:14:05.687765 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:14:05.688059 [debug] [MainThread]: Using postgres connection "master"
18:14:05.688141 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:14:05.699240 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
18:14:05.700260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '439f5db4-7087-45f8-93be-5cc2d3f0b447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd80fcbf10>]}
18:14:05.700548 [debug] [MainThread]: On master: ROLLBACK
18:14:05.700853 [debug] [MainThread]: Using postgres connection "master"
18:14:05.700967 [debug] [MainThread]: On master: BEGIN
18:14:05.701486 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:14:05.701594 [debug] [MainThread]: On master: COMMIT
18:14:05.701664 [debug] [MainThread]: Using postgres connection "master"
18:14:05.701723 [debug] [MainThread]: On master: COMMIT
18:14:05.701862 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:14:05.701953 [debug] [MainThread]: On master: Close
18:14:05.702225 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:14:05.702433 [info ] [MainThread]: 
18:14:05.707025 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:14:05.707314 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:14:05.708138 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:14:05.708498 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:14:05.708580 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:14:05.707930 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:14:05.708657 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:14:05.710563 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:14:05.707414 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:14:05.709019 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:14:05.707517 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:14:05.711303 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:14:05.711069 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:14:05.710822 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
18:14:05.712312 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:14:05.712396 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:14:05.711793 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:14:05.711579 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:14:05.714902 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:14:05.714974 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:14:05.714731 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:14:05.715636 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:14:05.712482 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:14:05.717209 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:14:05.717374 [debug] [Thread-4  ]: finished collecting timing info
18:14:05.717743 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:14:05.717553 [debug] [Thread-1  ]: finished collecting timing info
18:14:05.712643 [debug] [Thread-2  ]: finished collecting timing info
18:14:05.734660 [debug] [Thread-3  ]: finished collecting timing info
18:14:05.734900 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:14:05.740409 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:14:05.740687 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:14:05.742211 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:14:05.759463 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:14:05.761886 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:14:05.764814 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:14:05.766359 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:14:05.765681 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:14:05.766639 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:14:05.766524 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:14:05.766902 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:14:05.766713 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:14:05.765976 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:14:05.767485 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:14:05.767586 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:14:05.765476 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:14:05.768300 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:14:05.768422 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:14:05.771755 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:14:05.771918 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:14:05.771994 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
18:14:05.775251 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:14:05.775493 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:14:05.775583 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:14:05.775688 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
18:14:05.775798 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:14:05.775863 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
   select
     codigo_cliente as customer_id,
     nome as first_name,
     sobrenome as last_name,
     codigo_regiao as region_code,
     estado as state
   from erp_oltp.public.clientes
)

select * from customers
  );
18:14:05.777319 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
18:14:05.781374 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:14:05.781495 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:14:05.781639 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
18:14:05.781786 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
18:14:05.783489 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:14:05.784849 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:14:05.785381 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:14:05.785267 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:14:05.784975 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:05.786648 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:14:05.786769 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:05.787163 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:14:05.788801 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:14:05.788547 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:14:05.789056 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:14:05.787407 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:14:05.788912 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
)

select * from orders
  );
18:14:05.787313 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:05.790248 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:14:05.790341 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:14:05.790427 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:05.795453 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:14:05.795636 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
18:14:05.799563 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:14:05.800199 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:14:05.800293 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:14:05.799824 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
18:14:05.795787 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:14:05.802813 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:14:05.803414 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:14:05.803017 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:14:05.800024 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
18:14:05.805385 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:14:05.805481 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:14:05.805545 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:14:05.805971 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:05.807450 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:14:05.807545 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:14:05.807915 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:05.809044 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:14:05.809197 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:14:05.809349 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:14:05.810761 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
18:14:05.815253 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:14:05.815403 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
18:14:05.815497 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
18:14:05.815587 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
18:14:05.816624 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:14:05.818742 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:14:05.817534 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:14:05.818910 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:14:05.815657 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:14:05.818623 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:14:05.819758 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:14:05.821820 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
18:14:05.823895 [debug] [Thread-4  ]: finished collecting timing info
18:14:05.824171 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:14:05.824509 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439f5db4-7087-45f8-93be-5cc2d3f0b447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd810c9490>]}
18:14:05.824741 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.11s]
18:14:05.824855 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:14:05.824997 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
18:14:05.826529 [debug] [Thread-3  ]: finished collecting timing info
18:14:05.825811 [debug] [Thread-2  ]: finished collecting timing info
18:14:05.827047 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:14:05.825102 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
18:14:05.826906 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:14:05.828157 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439f5db4-7087-45f8-93be-5cc2d3f0b447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd80fedfd0>]}
18:14:05.828380 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.12s]
18:14:05.828583 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:14:05.827794 [debug] [Thread-1  ]: finished collecting timing info
18:14:05.828969 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439f5db4-7087-45f8-93be-5cc2d3f0b447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd810d9430>]}
18:14:05.829469 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.12s]
18:14:05.829137 [debug] [Thread-6  ]: Began running node model.first_project.customers2
18:14:05.829670 [info ] [Thread-6  ]: 5 of 7 START table model public.customers2 ..................................... [RUN]
18:14:05.829889 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:14:05.829284 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:14:05.830155 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
18:14:05.830486 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
18:14:05.830576 [debug] [Thread-6  ]: Compiling model.first_project.customers2
18:14:05.826727 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:14:05.832426 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
18:14:05.832723 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439f5db4-7087-45f8-93be-5cc2d3f0b447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd828f0bb0>]}
18:14:05.833242 [debug] [Thread-8  ]: Began running node model.first_project.customers
18:14:05.835625 [info ] [Thread-8  ]: 6 of 7 START view model public.customers ....................................... [RUN]
18:14:05.835894 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
18:14:05.835971 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
18:14:05.836036 [debug] [Thread-8  ]: Compiling model.first_project.customers
18:14:05.837808 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
18:14:05.835337 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.12s]
18:14:05.838064 [debug] [Thread-8  ]: finished collecting timing info
18:14:05.839839 [debug] [Thread-8  ]: Began executing node model.first_project.customers
18:14:05.839665 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:14:05.841487 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
18:14:05.839198 [debug] [Thread-6  ]: finished collecting timing info
18:14:05.841997 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
18:14:05.842224 [info ] [Thread-10 ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:14:05.842525 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:14:05.842648 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
18:14:05.842725 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
18:14:05.844658 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:14:05.844979 [debug] [Thread-10 ]: finished collecting timing info
18:14:05.845155 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
18:14:05.846665 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:14:05.846889 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:14:05.842103 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
18:14:05.848652 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
18:14:05.847034 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: BEGIN
18:14:05.851832 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:14:05.852926 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
18:14:05.852476 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:14:05.853227 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
18:14:05.853040 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:14:05.852668 [debug] [Thread-10 ]: Opening a new connection, currently in state init
18:14:05.856145 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:14:05.862178 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
18:14:05.862403 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:14:05.862480 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
18:14:05.864876 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
18:14:05.865068 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:14:05.865151 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
18:14:05.869171 [debug] [Thread-10 ]: SQL status: BEGIN in 0.02 seconds
18:14:05.869394 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:14:05.869467 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:14:05.871271 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.01 seconds
18:14:05.873619 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:14:05.874718 [debug] [Thread-10 ]: SQL status: CREATE VIEW in 0.01 seconds
18:14:05.876179 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:14:05.876265 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:14:05.874807 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.01 seconds
18:14:05.878194 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:14:05.878284 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
18:14:05.874898 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:14:05.878414 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:05.879159 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
18:14:05.879281 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:05.879421 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:14:05.880412 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
18:14:05.880186 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
18:14:05.879553 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:05.880619 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:14:05.882441 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:14:05.882645 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
18:14:05.882875 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:14:05.883669 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:05.885042 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:14:05.885285 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:14:05.885461 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:14:05.886748 [debug] [Thread-10 ]: SQL status: COMMIT in 0.01 seconds
18:14:05.888632 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:14:05.889158 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
18:14:05.889429 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:14:05.889529 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
18:14:05.892061 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:14:05.890654 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:14:05.892457 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
18:14:05.892355 [debug] [Thread-10 ]: SQL status: DROP VIEW in 0.0 seconds
18:14:05.892191 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:14:05.893432 [debug] [Thread-10 ]: finished collecting timing info
18:14:05.893578 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
18:14:05.893748 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: Close
18:14:05.895256 [debug] [Thread-8  ]: finished collecting timing info
18:14:05.895426 [debug] [Thread-8  ]: On model.first_project.customers: Close
18:14:05.895706 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439f5db4-7087-45f8-93be-5cc2d3f0b447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd802349d0>]}
18:14:05.895942 [info ] [Thread-8  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.06s]
18:14:05.896374 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439f5db4-7087-45f8-93be-5cc2d3f0b447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8023ee20>]}
18:14:05.896658 [info ] [Thread-10 ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
18:14:05.897029 [debug] [Thread-8  ]: Finished running node model.first_project.customers
18:14:05.897700 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
18:14:05.899171 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.01 seconds
18:14:05.900099 [debug] [Thread-6  ]: finished collecting timing info
18:14:05.900249 [debug] [Thread-6  ]: On model.first_project.customers2: Close
18:14:05.900545 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '439f5db4-7087-45f8-93be-5cc2d3f0b447', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd80ff9460>]}
18:14:05.902234 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.07s]
18:14:05.902487 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
18:14:05.905098 [debug] [MainThread]: Acquiring new postgres connection "master"
18:14:05.905257 [debug] [MainThread]: Using postgres connection "master"
18:14:05.905331 [debug] [MainThread]: On master: BEGIN
18:14:05.905392 [debug] [MainThread]: Opening a new connection, currently in state closed
18:14:05.909773 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:14:05.909985 [debug] [MainThread]: On master: COMMIT
18:14:05.910057 [debug] [MainThread]: Using postgres connection "master"
18:14:05.910123 [debug] [MainThread]: On master: COMMIT
18:14:05.910263 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:14:05.910385 [debug] [MainThread]: On master: Close
18:14:05.910767 [info ] [MainThread]: 
18:14:05.910918 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.28s.
18:14:05.911020 [debug] [MainThread]: Connection 'master' was properly closed.
18:14:05.911077 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:14:05.911186 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:14:05.911246 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:14:05.911302 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:14:05.911360 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:14:05.911416 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:14:05.911473 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:14:05.916094 [info ] [MainThread]: 
18:14:05.919403 [info ] [MainThread]: [32mCompleted successfully[0m
18:14:05.919682 [info ] [MainThread]: 
18:14:05.919852 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:14:05.920168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd80b256a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd80fcb7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd80b759a0>]}


============================== 2022-06-04 18:20:16.455792 | 97e60c69-b3f6-4647-a310-503d4af83c2f ==============================
18:20:16.455805 [info ] [MainThread]: Running with dbt=1.1.0
18:20:16.456214 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:20:16.456332 [debug] [MainThread]: Tracking: tracking
18:20:16.458648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6e80c5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6e80cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6e80c6a0>]}
18:20:16.485764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:20:16.486210 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
18:20:16.495793 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_ordes' in the 'models' section of file 'models/erp/schema.yml'
18:20:16.517984 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.first_project.relationships_stg_ordes_customer_id__customer_id__ref_customers_.a503ad5a99' (models/erp/schema.yml) depends on a node named 'stg_ordes' which was not found
18:20:16.529098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97e60c69-b3f6-4647-a310-503d4af83c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6e6a30d0>]}
18:20:16.536053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97e60c69-b3f6-4647-a310-503d4af83c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6e6be7c0>]}
18:20:16.536484 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:20:16.536749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97e60c69-b3f6-4647-a310-503d4af83c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6e6c3bb0>]}
18:20:16.538264 [info ] [MainThread]: 
18:20:16.538730 [debug] [MainThread]: Acquiring new postgres connection "master"
18:20:16.541854 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:20:16.595528 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:20:16.595715 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:20:16.595794 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:20:16.601740 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:20:16.602828 [debug] [ThreadPool]: On list_erp_oltp: Close
18:20:16.605007 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:20:16.609181 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:20:16.609355 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:20:16.609463 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:20:16.615817 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:20:16.616011 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:20:16.616081 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:20:16.617402 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:20:16.618429 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:20:16.618609 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:20:16.621556 [debug] [MainThread]: Using postgres connection "master"
18:20:16.621718 [debug] [MainThread]: On master: BEGIN
18:20:16.621819 [debug] [MainThread]: Opening a new connection, currently in state init
18:20:16.626403 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:20:16.626556 [debug] [MainThread]: Using postgres connection "master"
18:20:16.626623 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:20:16.638892 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
18:20:16.640012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97e60c69-b3f6-4647-a310-503d4af83c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc709dec70>]}
18:20:16.640245 [debug] [MainThread]: On master: ROLLBACK
18:20:16.640664 [debug] [MainThread]: Using postgres connection "master"
18:20:16.640788 [debug] [MainThread]: On master: BEGIN
18:20:16.641303 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:20:16.641411 [debug] [MainThread]: On master: COMMIT
18:20:16.641527 [debug] [MainThread]: Using postgres connection "master"
18:20:16.641612 [debug] [MainThread]: On master: COMMIT
18:20:16.641931 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:20:16.642062 [debug] [MainThread]: On master: Close
18:20:16.642368 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:20:16.642585 [info ] [MainThread]: 
18:20:16.649922 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:20:16.650292 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:20:16.650746 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:20:16.650848 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:20:16.650967 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:20:16.652629 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:20:16.653024 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:20:16.653387 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:20:16.653815 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:20:16.655413 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:20:16.655506 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:20:16.656894 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:20:16.657175 [debug] [Thread-2  ]: finished collecting timing info
18:20:16.657352 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:20:16.664412 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:20:16.665300 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
18:20:16.666566 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:20:16.666880 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:20:16.667162 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:20:16.668566 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:20:16.669031 [debug] [Thread-3  ]: finished collecting timing info
18:20:16.669224 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:20:16.674645 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:20:16.675036 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:20:16.675422 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:20:16.675505 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:20:16.675615 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:20:16.677174 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:20:16.677448 [debug] [Thread-4  ]: finished collecting timing info
18:20:16.677619 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:20:16.709292 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:20:16.709941 [debug] [Thread-1  ]: finished collecting timing info
18:20:16.710183 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:20:16.719156 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:20:16.725957 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:20:16.726107 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:20:16.726178 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:20:16.725403 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:20:16.726364 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:20:16.727396 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:20:16.727496 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:20:16.728210 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:20:16.728370 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:20:16.728440 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:20:16.737260 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:20:16.737453 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:20:16.737532 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
18:20:16.738224 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:20:16.738561 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:20:16.738726 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:20:16.738833 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
18:20:16.739106 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:20:16.739307 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:20:16.743659 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:20:16.743786 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
)

select * from orders
  );
18:20:16.743228 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:20:16.743936 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:20:16.744497 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:20:16.743400 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
18:20:16.746173 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:20:16.746424 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:20:16.746790 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
18:20:16.749683 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:20:16.747045 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
   select
     codigo_cliente as customer_id,
     nome as first_name,
     sobrenome as last_name,
     codigo_regiao as region_code,
     estado as state
   from erp_oltp.public.clientes
)

select * from customers
  );
18:20:16.749874 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:20:16.746937 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:20:16.750741 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:20:16.756882 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
18:20:16.757581 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
18:20:16.757458 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:20:16.759748 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:20:16.762556 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:20:16.763215 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:20:16.762780 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:20:16.764677 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:20:16.764833 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:20:16.763638 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:20:16.763037 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:20:16.765997 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:20:16.765674 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:20:16.767510 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:20:16.767898 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:20:16.767635 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:20:16.767717 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:20:16.769232 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:20:16.769522 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:20:16.769365 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:20:16.769940 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:20:16.770863 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:20:16.771046 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:20:16.771137 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:20:16.762937 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:20:16.771318 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:20:16.771603 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:20:16.773439 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:20:16.773561 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:20:16.773677 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
18:20:16.774689 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
18:20:16.774773 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:20:16.778542 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:20:16.778775 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:20:16.779657 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:20:16.785672 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:20:16.780984 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:20:16.785471 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:20:16.780713 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:20:16.787239 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:20:16.787486 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:20:16.787638 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:20:16.789511 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
18:20:16.791088 [debug] [Thread-3  ]: finished collecting timing info
18:20:16.791465 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:20:16.791981 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97e60c69-b3f6-4647-a310-503d4af83c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6e610fd0>]}
18:20:16.792343 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.13s]
18:20:16.792807 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:20:16.793445 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
18:20:16.793627 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:20:16.794635 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.01 seconds
18:20:16.795587 [debug] [Thread-6  ]: Began running node model.first_project.customers2
18:20:16.797553 [info ] [Thread-6  ]: 5 of 7 START table model public.customers2 ..................................... [RUN]
18:20:16.796515 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:20:16.797874 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
18:20:16.798335 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
18:20:16.798487 [debug] [Thread-6  ]: Compiling model.first_project.customers2
18:20:16.798045 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:20:16.800803 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
18:20:16.801453 [debug] [Thread-6  ]: finished collecting timing info
18:20:16.801658 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
18:20:16.797378 [debug] [Thread-4  ]: finished collecting timing info
18:20:16.808031 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:20:16.795470 [debug] [Thread-2  ]: finished collecting timing info
18:20:16.809193 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:20:16.803795 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
18:20:16.810193 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:20:16.810400 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
18:20:16.810529 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:20:16.808992 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97e60c69-b3f6-4647-a310-503d4af83c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6e620f10>]}
18:20:16.811558 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.13s]
18:20:16.811016 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97e60c69-b3f6-4647-a310-503d4af83c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6e662d00>]}
18:20:16.812023 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.16s]
18:20:16.810675 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
18:20:16.813077 [debug] [Thread-1  ]: finished collecting timing info
18:20:16.813203 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:20:16.814626 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:20:16.815432 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:20:16.816206 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97e60c69-b3f6-4647-a310-503d4af83c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6e6382e0>]}
18:20:16.815787 [debug] [Thread-8  ]: Began running node model.first_project.customers
18:20:16.816523 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.17s]
18:20:16.816728 [info ] [Thread-8  ]: 6 of 7 START view model public.customers ....................................... [RUN]
18:20:16.817143 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:20:16.817385 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
18:20:16.817618 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
18:20:16.817712 [debug] [Thread-8  ]: Compiling model.first_project.customers
18:20:16.819463 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
18:20:16.819777 [debug] [Thread-8  ]: finished collecting timing info
18:20:16.819927 [debug] [Thread-8  ]: Began executing node model.first_project.customers
18:20:16.826291 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
18:20:16.826786 [info ] [Thread-10 ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:20:16.827132 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:20:16.827252 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
18:20:16.827397 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
18:20:16.827650 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
18:20:16.829096 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:20:16.829390 [debug] [Thread-10 ]: finished collecting timing info
18:20:16.829562 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
18:20:16.829679 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:20:16.832146 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
18:20:16.832447 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:20:16.831689 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:20:16.834929 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:20:16.835180 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: BEGIN
18:20:16.835277 [debug] [Thread-10 ]: Opening a new connection, currently in state init
18:20:16.836098 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
18:20:16.836229 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:20:16.836367 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
18:20:16.837544 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
18:20:16.837649 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:20:16.837712 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
18:20:16.837929 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
18:20:16.839543 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:20:16.839666 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
18:20:16.839831 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:20:16.841388 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:20:16.841657 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
18:20:16.841834 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:20:16.843374 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:20:16.843475 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:20:16.843572 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:20:16.845552 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
18:20:16.845655 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:20:16.845722 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
18:20:16.845877 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:20:16.847107 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:20:16.847205 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:20:16.847267 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:20:16.848039 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
18:20:16.849751 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:20:16.849913 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
18:20:16.850073 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
18:20:16.852298 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:20:16.852517 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:20:16.853231 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
18:20:16.854331 [debug] [Thread-8  ]: finished collecting timing info
18:20:16.854602 [debug] [Thread-8  ]: On model.first_project.customers: Close
18:20:16.855182 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97e60c69-b3f6-4647-a310-503d4af83c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6c55bfd0>]}
18:20:16.855432 [info ] [Thread-8  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.04s]
18:20:16.855788 [debug] [Thread-8  ]: Finished running node model.first_project.customers
18:20:16.856663 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
18:20:16.857493 [debug] [Thread-6  ]: finished collecting timing info
18:20:16.857603 [debug] [Thread-6  ]: On model.first_project.customers2: Close
18:20:16.857894 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97e60c69-b3f6-4647-a310-503d4af83c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6c5d0190>]}
18:20:16.858086 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.06s]
18:20:16.858292 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
18:20:16.859338 [debug] [Thread-10 ]: SQL status: BEGIN in 0.02 seconds
18:20:16.859431 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:20:16.859494 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:20:16.860545 [debug] [Thread-10 ]: SQL status: CREATE VIEW in 0.0 seconds
18:20:16.866222 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:20:16.866500 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:20:16.867174 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
18:20:16.868313 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
18:20:16.868490 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:20:16.868555 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
18:20:16.870505 [debug] [Thread-10 ]: SQL status: COMMIT in 0.0 seconds
18:20:16.871641 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:20:16.871733 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:20:16.872086 [debug] [Thread-10 ]: SQL status: DROP VIEW in 0.0 seconds
18:20:16.872944 [debug] [Thread-10 ]: finished collecting timing info
18:20:16.873050 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: Close
18:20:16.873424 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97e60c69-b3f6-4647-a310-503d4af83c2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6c529f40>]}
18:20:16.873747 [info ] [Thread-10 ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
18:20:16.874126 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
18:20:16.875576 [debug] [MainThread]: Acquiring new postgres connection "master"
18:20:16.875699 [debug] [MainThread]: Using postgres connection "master"
18:20:16.875766 [debug] [MainThread]: On master: BEGIN
18:20:16.875824 [debug] [MainThread]: Opening a new connection, currently in state closed
18:20:16.879555 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:20:16.879686 [debug] [MainThread]: On master: COMMIT
18:20:16.879750 [debug] [MainThread]: Using postgres connection "master"
18:20:16.879808 [debug] [MainThread]: On master: COMMIT
18:20:16.879927 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:20:16.880043 [debug] [MainThread]: On master: Close
18:20:16.880320 [info ] [MainThread]: 
18:20:16.880457 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.34s.
18:20:16.880556 [debug] [MainThread]: Connection 'master' was properly closed.
18:20:16.880607 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:20:16.880655 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:20:16.880703 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:20:16.880753 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:20:16.880810 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:20:16.880863 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:20:16.880946 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:20:16.891289 [info ] [MainThread]: 
18:20:16.891532 [info ] [MainThread]: [32mCompleted successfully[0m
18:20:16.891759 [info ] [MainThread]: 
18:20:16.891866 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:20:16.892041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6e6c3af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc6e6c31c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc7002ba30>]}


============================== 2022-06-04 18:20:29.546066 | bb6a4d99-92f1-4ae9-b074-91caa86b37ce ==============================
18:20:29.546079 [info ] [MainThread]: Running with dbt=1.1.0
18:20:29.546571 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:20:29.546683 [debug] [MainThread]: Tracking: tracking
18:20:29.549649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238e8bda60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238e8bd220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238e8bdeb0>]}
18:20:29.575888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:20:29.588047 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:20:29.593724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb6a4d99-92f1-4ae9-b074-91caa86b37ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238e7670d0>]}
18:20:29.597890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb6a4d99-92f1-4ae9-b074-91caa86b37ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238e846ca0>]}
18:20:29.598369 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:20:29.598625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb6a4d99-92f1-4ae9-b074-91caa86b37ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238e846c40>]}
18:20:29.600557 [info ] [MainThread]: 
18:20:29.601065 [debug] [MainThread]: Acquiring new postgres connection "master"
18:20:29.602106 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:20:29.616968 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:20:29.617188 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:20:29.617264 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:20:29.622298 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:20:29.622492 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:20:29.622566 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:20:29.624223 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:20:29.625370 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:20:29.625560 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:20:29.628520 [debug] [MainThread]: Using postgres connection "master"
18:20:29.628635 [debug] [MainThread]: On master: BEGIN
18:20:29.628703 [debug] [MainThread]: Opening a new connection, currently in state init
18:20:29.634029 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:20:29.634236 [debug] [MainThread]: Using postgres connection "master"
18:20:29.634312 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:20:29.645089 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
18:20:29.646225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb6a4d99-92f1-4ae9-b074-91caa86b37ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238e846a90>]}
18:20:29.646639 [debug] [MainThread]: On master: ROLLBACK
18:20:29.647008 [debug] [MainThread]: Using postgres connection "master"
18:20:29.647246 [debug] [MainThread]: On master: BEGIN
18:20:29.647952 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:20:29.648130 [debug] [MainThread]: On master: COMMIT
18:20:29.648223 [debug] [MainThread]: Using postgres connection "master"
18:20:29.648287 [debug] [MainThread]: On master: COMMIT
18:20:29.648531 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:20:29.648646 [debug] [MainThread]: On master: Close
18:20:29.648973 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:20:29.649215 [info ] [MainThread]: 
18:20:29.655991 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:20:29.656193 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [RUN]
18:20:29.656480 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:20:29.656577 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:20:29.656689 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:20:29.667475 [debug] [Thread-2  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:20:29.668077 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:20:29.668595 [info ] [Thread-2  ]: 2 of 7 START test not_null_customers_customer_id ............................... [RUN]
18:20:29.675014 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:20:29.674850 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:20:29.675201 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:20:29.678496 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:20:29.675726 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:20:29.678704 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:20:29.677923 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:20:29.678933 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:20:29.679395 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:20:29.679687 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:20:29.679791 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:20:29.678793 [debug] [Thread-2  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
18:20:29.678064 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:20:29.727389 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:20:29.679531 [debug] [Thread-1  ]: finished collecting timing info
18:20:29.677774 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:20:29.675328 [debug] [Thread-5  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:20:29.732301 [info ] [Thread-5  ]: 5 of 7 START test unique_customers_customer_id ................................. [RUN]
18:20:29.732855 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:20:29.727498 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:20:29.727650 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:20:29.731618 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:20:29.732029 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:20:29.739981 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:20:29.740074 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:20:29.740140 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:20:29.733061 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:20:29.743044 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:20:29.748602 [debug] [Thread-6  ]: finished collecting timing info
18:20:29.748836 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:20:29.726961 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:20:29.747817 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:20:29.748086 [debug] [Thread-5  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
18:20:29.733276 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:20:29.678588 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:20:29.763693 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:20:29.750644 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:20:29.763352 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:20:29.763519 [debug] [Thread-2  ]: finished collecting timing info
18:20:29.759755 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:20:29.766932 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:20:29.767510 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:20:29.767684 [debug] [Thread-7  ]: finished collecting timing info
18:20:29.767936 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:20:29.770394 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:20:29.770603 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:20:29.770751 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
18:20:29.770900 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:20:29.768872 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:20:29.769245 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:20:29.769095 [debug] [Thread-5  ]: finished collecting timing info
18:20:29.773449 [debug] [Thread-5  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:20:29.768335 [debug] [Thread-4  ]: finished collecting timing info
18:20:29.771997 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:20:29.773281 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:20:29.776066 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:20:29.776182 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:20:29.776278 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:20:29.769316 [debug] [Thread-3  ]: finished collecting timing info
18:20:29.776640 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:20:29.775413 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:20:29.775560 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:20:29.778093 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:20:29.777736 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:20:29.785183 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:20:29.785401 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:20:29.780118 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: BEGIN
18:20:29.785607 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:20:29.779895 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:20:29.786070 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:20:29.786224 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:20:29.786412 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:20:29.785493 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:20:29.768471 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:20:29.787536 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: BEGIN
18:20:29.787649 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:20:29.789033 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:20:29.789175 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:20:29.789249 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
18:20:29.790661 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:20:29.792303 [debug] [Thread-2  ]: finished collecting timing info
18:20:29.792508 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
18:20:29.793247 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
18:20:29.793380 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:20:29.793493 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
18:20:29.794019 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:20:29.794083 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:20:29.793907 [info ] [Thread-2  ]: 2 of 7 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.12s]
18:20:29.794477 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:20:29.793620 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:20:29.794739 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:20:29.795556 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.0 seconds
18:20:29.796519 [debug] [Thread-7  ]: finished collecting timing info
18:20:29.796637 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:20:29.796750 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:20:29.797984 [debug] [Thread-6  ]: finished collecting timing info
18:20:29.798258 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:20:29.798453 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:20:29.798766 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.06s]
18:20:29.799276 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:20:29.799661 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:20:29.799992 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.12s]
18:20:29.800266 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:20:29.806843 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
18:20:29.807128 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:20:29.807216 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:20:29.810706 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
18:20:29.811008 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:20:29.811241 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:20:29.812960 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:20:29.813173 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.01 seconds
18:20:29.813307 [debug] [Thread-4  ]: SQL status: BEGIN in 0.03 seconds
18:20:29.815904 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:20:29.815995 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:20:29.815772 [debug] [Thread-5  ]: finished collecting timing info
18:20:29.814729 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:20:29.816232 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:20:29.816122 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
18:20:29.816318 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."customers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT','GO','DF','PA'
)



      
    ) dbt_internal_test
18:20:29.814461 [debug] [Thread-3  ]: finished collecting timing info
18:20:29.816501 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:20:29.816613 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: Close
18:20:29.816937 [error] [Thread-5  ]: 5 of 7 FAIL 50 unique_customers_customer_id .................................... [[31mFAIL 50[0m in 0.08s]
18:20:29.817195 [debug] [Thread-5  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:20:29.817468 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:20:29.817741 [error] [Thread-3  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.14s]
18:20:29.817959 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:20:29.818177 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:20:29.819237 [debug] [Thread-4  ]: finished collecting timing info
18:20:29.819343 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:20:29.820330 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:20:29.821175 [debug] [Thread-1  ]: finished collecting timing info
18:20:29.821310 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: ROLLBACK
18:20:29.821606 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:20:29.821888 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.09s]
18:20:29.822129 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:20:29.823212 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: Close
18:20:29.823530 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [[32mPASS[0m in 0.17s]
18:20:29.823742 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:20:29.825580 [debug] [MainThread]: Acquiring new postgres connection "master"
18:20:29.825691 [debug] [MainThread]: Using postgres connection "master"
18:20:29.825752 [debug] [MainThread]: On master: BEGIN
18:20:29.825805 [debug] [MainThread]: Opening a new connection, currently in state closed
18:20:29.829307 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:20:29.829419 [debug] [MainThread]: On master: COMMIT
18:20:29.829482 [debug] [MainThread]: Using postgres connection "master"
18:20:29.829539 [debug] [MainThread]: On master: COMMIT
18:20:29.829649 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:20:29.829726 [debug] [MainThread]: On master: Close
18:20:29.829948 [info ] [MainThread]: 
18:20:29.830090 [info ] [MainThread]: Finished running 7 tests in 0.23s.
18:20:29.830252 [debug] [MainThread]: Connection 'master' was properly closed.
18:20:29.830369 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
18:20:29.830569 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
18:20:29.830668 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:20:29.830750 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:20:29.830833 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:20:29.830956 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
18:20:29.831045 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:20:29.840658 [info ] [MainThread]: 
18:20:29.840953 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
18:20:29.841167 [info ] [MainThread]: 
18:20:29.841407 [error] [MainThread]: [31mFailure in test unique_customers_customer_id (models/erp/schema.yml)[0m
18:20:29.841650 [error] [MainThread]:   Got 50 results, configured to fail if != 0
18:20:29.841784 [info ] [MainThread]: 
18:20:29.841946 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/unique_customers_customer_id.sql
18:20:29.842067 [info ] [MainThread]: 
18:20:29.842181 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:20:29.842297 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:20:29.842404 [info ] [MainThread]: 
18:20:29.842517 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:20:29.842665 [info ] [MainThread]: 
18:20:29.842790 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
18:20:29.843003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238e731f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238e731f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f238e73ec10>]}


============================== 2022-06-04 18:25:30.537259 | 1cf42e40-e62c-4b25-808f-8c46cd3177d6 ==============================
18:25:30.537318 [info ] [MainThread]: Running with dbt=1.1.0
18:25:30.538204 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:25:30.538327 [debug] [MainThread]: Tracking: tracking
18:25:30.546530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2de57e5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2de57edc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2de57e6a0>]}
18:25:30.577170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
18:25:30.578120 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
18:25:30.578331 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:25:30.587172 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:25:30.683580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1cf42e40-e62c-4b25-808f-8c46cd3177d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2de58d2b0>]}
18:25:30.687140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1cf42e40-e62c-4b25-808f-8c46cd3177d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2de4c6040>]}
18:25:30.687416 [info ] [MainThread]: Found 7 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:25:30.687595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cf42e40-e62c-4b25-808f-8c46cd3177d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2de4c6130>]}
18:25:30.691574 [info ] [MainThread]: 
18:25:30.692000 [debug] [MainThread]: Acquiring new postgres connection "master"
18:25:30.693035 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:25:30.702107 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:25:30.702305 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:25:30.702412 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:25:30.711049 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:25:30.711452 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:25:30.711531 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:25:30.713734 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:25:30.715037 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:25:30.715580 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:25:30.720347 [debug] [MainThread]: Using postgres connection "master"
18:25:30.720547 [debug] [MainThread]: On master: BEGIN
18:25:30.720644 [debug] [MainThread]: Opening a new connection, currently in state init
18:25:30.730842 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:25:30.731739 [debug] [MainThread]: Using postgres connection "master"
18:25:30.731879 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:25:30.743074 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
18:25:30.745660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1cf42e40-e62c-4b25-808f-8c46cd3177d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2de47cfd0>]}
18:25:30.746032 [debug] [MainThread]: On master: ROLLBACK
18:25:30.746846 [debug] [MainThread]: Using postgres connection "master"
18:25:30.747039 [debug] [MainThread]: On master: BEGIN
18:25:30.747640 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:25:30.747782 [debug] [MainThread]: On master: COMMIT
18:25:30.747861 [debug] [MainThread]: Using postgres connection "master"
18:25:30.747931 [debug] [MainThread]: On master: COMMIT
18:25:30.748129 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:25:30.748260 [debug] [MainThread]: On master: Close
18:25:30.748797 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:25:30.749193 [info ] [MainThread]: 
18:25:30.756120 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:25:30.756331 [info ] [Thread-1  ]: 1 of 6 START test accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [RUN]
18:25:30.756717 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:25:30.756833 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:25:30.756966 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:25:30.766231 [debug] [Thread-2  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:25:30.766956 [info ] [Thread-2  ]: 2 of 6 START test not_null_customers_customer_id ............................... [RUN]
18:25:30.767422 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:25:30.767523 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:25:30.767606 [debug] [Thread-2  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
18:25:30.773092 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:25:30.773285 [info ] [Thread-3  ]: 3 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:25:30.773483 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:25:30.773635 [info ] [Thread-4  ]: 4 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:25:30.774435 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:25:30.774752 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:25:30.777041 [info ] [Thread-5  ]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
18:25:30.777503 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:25:30.777656 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:25:30.777729 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:25:30.781667 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:25:30.782099 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:25:30.782517 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:25:30.786127 [info ] [Thread-6  ]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
18:25:30.786510 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:25:30.786601 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:25:30.785801 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:25:30.786676 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:25:30.782893 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:25:30.797292 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:25:30.797579 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:25:30.787002 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:25:30.803204 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:25:30.786784 [debug] [Thread-2  ]: finished collecting timing info
18:25:30.804020 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:25:30.800845 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:25:30.787172 [debug] [Thread-3  ]: finished collecting timing info
18:25:30.813679 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:25:30.796568 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:25:30.785247 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:25:30.813055 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:25:30.803846 [debug] [Thread-4  ]: finished collecting timing info
18:25:30.814790 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:25:30.815054 [debug] [Thread-5  ]: finished collecting timing info
18:25:30.818786 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:25:30.819111 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:25:30.821879 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:25:30.822105 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:25:30.822188 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:25:30.820405 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:25:30.822517 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:25:30.822299 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:25:30.819727 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:25:30.825809 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:25:30.826059 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:25:30.822646 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:25:30.820546 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
18:25:30.826935 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:25:30.826497 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:25:30.827282 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:25:30.819364 [debug] [Thread-1  ]: finished collecting timing info
18:25:30.827856 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:25:30.819927 [debug] [Thread-6  ]: finished collecting timing info
18:25:30.829878 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:25:30.830110 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:25:30.833626 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:25:30.833747 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:25:30.833871 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:25:30.834001 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:25:30.834064 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
18:25:30.829242 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:25:30.834628 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:25:30.836035 [debug] [Thread-4  ]: finished collecting timing info
18:25:30.836153 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:25:30.836264 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:25:30.833055 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:25:30.837137 [debug] [Thread-2  ]: finished collecting timing info
18:25:30.837407 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:25:30.838305 [info ] [Thread-4  ]: 4 of 6 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.06s]
18:25:30.838555 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:25:30.837648 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:25:30.838755 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: BEGIN
18:25:30.838855 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:25:30.837970 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
18:25:30.839466 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
18:25:30.839733 [info ] [Thread-2  ]: 2 of 6 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.07s]
18:25:30.840004 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:25:30.840290 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:25:30.840442 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:25:30.840525 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:25:30.846380 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
18:25:30.846873 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:25:30.846964 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:25:30.847141 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:25:30.847234 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:25:30.847295 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:25:30.848049 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:25:30.848212 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:25:30.848285 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."customers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT','GO','DF','PA'
)



      
    ) dbt_internal_test
18:25:30.848742 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:25:30.849709 [debug] [Thread-3  ]: finished collecting timing info
18:25:30.849835 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:25:30.849950 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
18:25:30.850873 [debug] [Thread-5  ]: finished collecting timing info
18:25:30.851002 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:25:30.851199 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:25:30.851571 [error] [Thread-3  ]: 3 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.07s]
18:25:30.851842 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:25:30.851995 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:25:30.852403 [info ] [Thread-5  ]: 5 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.07s]
18:25:30.852786 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:25:30.854646 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
18:25:30.858989 [debug] [Thread-1  ]: finished collecting timing info
18:25:30.859205 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: ROLLBACK
18:25:30.859736 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: Close
18:25:30.860273 [info ] [Thread-1  ]: 1 of 6 PASS accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [[32mPASS[0m in 0.10s]
18:25:30.860909 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:25:30.862573 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:25:30.863205 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:25:30.863373 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:25:30.864621 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:25:30.868639 [debug] [Thread-6  ]: finished collecting timing info
18:25:30.868805 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:25:30.869254 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:25:30.869691 [info ] [Thread-6  ]: 6 of 6 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.08s]
18:25:30.870045 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:25:30.871464 [debug] [MainThread]: Acquiring new postgres connection "master"
18:25:30.871638 [debug] [MainThread]: Using postgres connection "master"
18:25:30.871775 [debug] [MainThread]: On master: BEGIN
18:25:30.871892 [debug] [MainThread]: Opening a new connection, currently in state closed
18:25:30.880890 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:25:30.881129 [debug] [MainThread]: On master: COMMIT
18:25:30.881213 [debug] [MainThread]: Using postgres connection "master"
18:25:30.881289 [debug] [MainThread]: On master: COMMIT
18:25:30.881543 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:25:30.881701 [debug] [MainThread]: On master: Close
18:25:30.882090 [info ] [MainThread]: 
18:25:30.882322 [info ] [MainThread]: Finished running 6 tests in 0.19s.
18:25:30.882500 [debug] [MainThread]: Connection 'master' was properly closed.
18:25:30.882608 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
18:25:30.882686 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
18:25:30.882758 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:25:30.882829 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:25:30.882884 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:25:30.882935 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:25:30.886847 [info ] [MainThread]: 
18:25:30.887218 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:25:30.887414 [info ] [MainThread]: 
18:25:30.887604 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:25:30.887757 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:25:30.887898 [info ] [MainThread]: 
18:25:30.888013 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:25:30.888181 [info ] [MainThread]: 
18:25:30.888296 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
18:25:30.888564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2de576f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2de47c970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2de02b730>]}


============================== 2022-06-04 18:25:49.136452 | 3b80d7a0-0f1c-46da-a4f4-8bfe86d7fa28 ==============================
18:25:49.136466 [info ] [MainThread]: Running with dbt=1.1.0
18:25:49.136803 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:25:49.136889 [debug] [MainThread]: Tracking: tracking
18:25:49.139783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5eb638b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5eb63250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5eb63970>]}
18:25:49.166296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:25:49.167809 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:25:49.179347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b80d7a0-0f1c-46da-a4f4-8bfe86d7fa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5ea130d0>]}
18:25:49.183883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b80d7a0-0f1c-46da-a4f4-8bfe86d7fa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5eaf3a30>]}
18:25:49.184232 [info ] [MainThread]: Found 7 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:25:49.184420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b80d7a0-0f1c-46da-a4f4-8bfe86d7fa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5eaf3a00>]}
18:25:49.185580 [info ] [MainThread]: 
18:25:49.186067 [debug] [MainThread]: Acquiring new postgres connection "master"
18:25:49.187152 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:25:49.200696 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:25:49.201094 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:25:49.201246 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:25:49.208451 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:25:49.209455 [debug] [ThreadPool]: On list_erp_oltp: Close
18:25:49.210768 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:25:49.215984 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:25:49.216158 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:25:49.216227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:25:49.220294 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
18:25:49.220434 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:25:49.220498 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:25:49.222324 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:25:49.223473 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:25:49.224653 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:25:49.227619 [debug] [MainThread]: Using postgres connection "master"
18:25:49.227765 [debug] [MainThread]: On master: BEGIN
18:25:49.227971 [debug] [MainThread]: Opening a new connection, currently in state init
18:25:49.236349 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:25:49.236563 [debug] [MainThread]: Using postgres connection "master"
18:25:49.236639 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:25:49.247997 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
18:25:49.249042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b80d7a0-0f1c-46da-a4f4-8bfe86d7fa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5ea13070>]}
18:25:49.249294 [debug] [MainThread]: On master: ROLLBACK
18:25:49.249717 [debug] [MainThread]: Using postgres connection "master"
18:25:49.249826 [debug] [MainThread]: On master: BEGIN
18:25:49.250356 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:25:49.250503 [debug] [MainThread]: On master: COMMIT
18:25:49.250573 [debug] [MainThread]: Using postgres connection "master"
18:25:49.250656 [debug] [MainThread]: On master: COMMIT
18:25:49.250928 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:25:49.251071 [debug] [MainThread]: On master: Close
18:25:49.251569 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:25:49.251734 [info ] [MainThread]: 
18:25:49.256950 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:25:49.257221 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:25:49.257572 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:25:49.257674 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:25:49.257783 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:25:49.259317 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:25:49.259596 [debug] [Thread-1  ]: finished collecting timing info
18:25:49.259766 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:25:49.268368 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:25:49.268684 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:25:49.269055 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:25:49.269152 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:25:49.307918 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:25:49.309825 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:25:49.315319 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:25:49.315620 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:25:49.316067 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:25:49.316159 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:25:49.316309 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:25:49.317117 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:25:49.317407 [debug] [Thread-2  ]: finished collecting timing info
18:25:49.326197 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:25:49.325829 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:25:49.333412 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
18:25:49.333817 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:25:49.333934 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:25:49.334043 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:25:49.334717 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:25:49.325746 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:25:49.340305 [debug] [Thread-3  ]: finished collecting timing info
18:25:49.340633 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:25:49.340925 [debug] [Thread-4  ]: finished collecting timing info
18:25:49.341195 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:25:49.341537 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:25:49.341954 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:25:49.350533 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:25:49.351506 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:25:49.356534 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:25:49.356823 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:25:49.357163 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:25:49.357416 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:25:49.357796 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:25:49.357987 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:25:49.358182 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:25:49.358933 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:25:49.358561 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:25:49.359369 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:25:49.358356 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:25:49.366718 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
18:25:49.366924 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:25:49.367043 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
   select
     codigo_cliente as customer_id,
     nome as first_name,
     sobrenome as last_name,
     codigo_regiao as region_code,
     estado as state
   from erp_oltp.public.clientes
)

select * from customers
  );
18:25:49.367768 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:25:49.367982 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:25:49.368062 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
18:25:49.369642 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
18:25:49.374839 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:25:49.375204 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:25:49.375727 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:25:49.375591 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:25:49.375839 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:25:49.375396 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
18:25:49.376002 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:25:49.377841 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:25:49.377601 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:25:49.377994 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
)

select * from orders
  );
18:25:49.378131 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:49.378241 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:25:49.380243 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:25:49.379967 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:25:49.382068 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:25:49.382273 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:49.382479 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
18:25:49.388093 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:25:49.382928 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:25:49.385767 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:25:49.388382 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:25:49.382755 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:25:49.388188 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:25:49.389053 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:49.390460 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:25:49.390570 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:25:49.389154 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:49.390667 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:49.399328 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:25:49.396381 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
18:25:49.402814 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:25:49.402919 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:25:49.399442 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:25:49.403501 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:49.403007 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:25:49.397752 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:25:49.404293 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:25:49.404889 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:25:49.404661 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:25:49.405043 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:25:49.390765 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:49.405138 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:25:49.406436 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:25:49.406801 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:25:49.407056 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:25:49.410309 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:25:49.410845 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:25:49.410528 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
18:25:49.412310 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:25:49.410421 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:25:49.412562 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:25:49.414870 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
18:25:49.413640 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:25:49.415929 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:25:49.415796 [debug] [Thread-1  ]: finished collecting timing info
18:25:49.416093 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:25:49.416415 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b80d7a0-0f1c-46da-a4f4-8bfe86d7fa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5c178eb0>]}
18:25:49.410689 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:25:49.418293 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:25:49.417039 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
18:25:49.419131 [debug] [Thread-2  ]: finished collecting timing info
18:25:49.420276 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:25:49.420652 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b80d7a0-0f1c-46da-a4f4-8bfe86d7fa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb603f8d60>]}
18:25:49.420906 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.15s]
18:25:49.421298 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:25:49.416809 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.16s]
18:25:49.421757 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:25:49.420157 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
18:25:49.423251 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:25:49.422148 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
18:25:49.423543 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:25:49.423836 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:25:49.423909 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
18:25:49.423974 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
18:25:49.425316 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:25:49.425605 [debug] [Thread-6  ]: finished collecting timing info
18:25:49.425745 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
18:25:49.423353 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:25:49.420052 [debug] [Thread-4  ]: finished collecting timing info
18:25:49.427256 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:25:49.428283 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:25:49.429140 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:25:49.429477 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
18:25:49.431448 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:25:49.429655 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
18:25:49.430138 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b80d7a0-0f1c-46da-a4f4-8bfe86d7fa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5ea395e0>]}
18:25:49.435689 [debug] [Thread-3  ]: finished collecting timing info
18:25:49.436117 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.11s]
18:25:49.436305 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:25:49.436679 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:25:49.439295 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b80d7a0-0f1c-46da-a4f4-8bfe86d7fa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5ea817c0>]}
18:25:49.439648 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.11s]
18:25:49.439944 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:25:49.440354 [debug] [Thread-8  ]: Began running node model.first_project.customers
18:25:49.440722 [info ] [Thread-8  ]: 6 of 7 START view model public.customers ....................................... [RUN]
18:25:49.441148 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
18:25:49.441264 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
18:25:49.441376 [debug] [Thread-8  ]: Compiling model.first_project.customers
18:25:49.440570 [debug] [Thread-9  ]: Began running node model.first_project.customers2
18:25:49.443407 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
18:25:49.447877 [info ] [Thread-9  ]: 7 of 7 START table model public.customers2 ..................................... [RUN]
18:25:49.451916 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers2"
18:25:49.452048 [debug] [Thread-9  ]: Began compiling node model.first_project.customers2
18:25:49.452140 [debug] [Thread-9  ]: Compiling model.first_project.customers2
18:25:49.455617 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers2"
18:25:49.455885 [debug] [Thread-8  ]: finished collecting timing info
18:25:49.456090 [debug] [Thread-8  ]: Began executing node model.first_project.customers
18:25:49.451195 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:25:49.460807 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
18:25:49.461252 [debug] [Thread-9  ]: finished collecting timing info
18:25:49.462774 [debug] [Thread-9  ]: Began executing node model.first_project.customers2
18:25:49.462170 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:25:49.467084 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.customers2"
18:25:49.467371 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:25:49.467838 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:25:49.467982 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
18:25:49.468045 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:25:49.468877 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:25:49.468965 [debug] [Thread-9  ]: On model.first_project.customers2: BEGIN
18:25:49.469021 [debug] [Thread-9  ]: Opening a new connection, currently in state init
18:25:49.469636 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
18:25:49.471299 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:25:49.471396 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:25:49.471811 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:49.472925 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
18:25:49.473018 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:25:49.473099 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
18:25:49.474802 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
18:25:49.475778 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:25:49.475882 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:25:49.476345 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
18:25:49.477172 [debug] [Thread-6  ]: finished collecting timing info
18:25:49.477276 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
18:25:49.477668 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b80d7a0-0f1c-46da-a4f4-8bfe86d7fa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5c1789a0>]}
18:25:49.478086 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
18:25:49.478425 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
18:25:49.481087 [debug] [Thread-9  ]: SQL status: BEGIN in 0.01 seconds
18:25:49.481325 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:25:49.481420 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
18:25:49.487123 [debug] [Thread-9  ]: SQL status: SELECT 100 in 0.01 seconds
18:25:49.488870 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:25:49.489002 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:25:49.489130 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
18:25:49.489206 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:25:49.489262 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
    WHERE customer_id != 63
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
18:25:49.489489 [debug] [Thread-8  ]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 29:   from customers
           ^

18:25:49.489623 [debug] [Thread-8  ]: On model.first_project.customers: ROLLBACK
18:25:49.489900 [debug] [Thread-8  ]: finished collecting timing info
18:25:49.489988 [debug] [Thread-8  ]: On model.first_project.customers: Close
18:25:49.490216 [debug] [Thread-8  ]: Database Error in model customers (models/erp/customers.sql)
  syntax error at or near "from"
  LINE 29:   from customers
             ^
  compiled SQL at target/run/first_project/models/erp/customers.sql
18:25:49.490418 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b80d7a0-0f1c-46da-a4f4-8bfe86d7fa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5c169ee0>]}
18:25:49.490715 [error] [Thread-8  ]: 6 of 7 ERROR creating view model public.customers .............................. [[31mERROR[0m in 0.05s]
18:25:49.491073 [debug] [Thread-8  ]: Finished running node model.first_project.customers
18:25:49.491409 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:49.492985 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:25:49.493105 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:25:49.493398 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:49.494305 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
18:25:49.494431 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:25:49.494581 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
18:25:49.496766 [debug] [Thread-9  ]: SQL status: COMMIT in 0.0 seconds
18:25:49.498110 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:25:49.498233 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:25:49.499983 [debug] [Thread-9  ]: SQL status: DROP TABLE in 0.0 seconds
18:25:49.500803 [debug] [Thread-9  ]: finished collecting timing info
18:25:49.500974 [debug] [Thread-9  ]: On model.first_project.customers2: Close
18:25:49.501422 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b80d7a0-0f1c-46da-a4f4-8bfe86d7fa28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5c11f820>]}
18:25:49.501646 [info ] [Thread-9  ]: 7 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.05s]
18:25:49.501877 [debug] [Thread-9  ]: Finished running node model.first_project.customers2
18:25:49.503480 [debug] [MainThread]: Acquiring new postgres connection "master"
18:25:49.503609 [debug] [MainThread]: Using postgres connection "master"
18:25:49.503675 [debug] [MainThread]: On master: BEGIN
18:25:49.503730 [debug] [MainThread]: Opening a new connection, currently in state closed
18:25:49.508118 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:25:49.508283 [debug] [MainThread]: On master: COMMIT
18:25:49.508349 [debug] [MainThread]: Using postgres connection "master"
18:25:49.508406 [debug] [MainThread]: On master: COMMIT
18:25:49.508565 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:25:49.508667 [debug] [MainThread]: On master: Close
18:25:49.508972 [info ] [MainThread]: 
18:25:49.509270 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.32s.
18:25:49.509423 [debug] [MainThread]: Connection 'master' was properly closed.
18:25:49.509484 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:25:49.509539 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:25:49.509590 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:25:49.509652 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:25:49.509704 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:25:49.509756 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:25:49.509807 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:25:49.517452 [info ] [MainThread]: 
18:25:49.517757 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:25:49.517974 [info ] [MainThread]: 
18:25:49.518101 [error] [MainThread]: [33mDatabase Error in model customers (models/erp/customers.sql)[0m
18:25:49.518218 [error] [MainThread]:   syntax error at or near "from"
18:25:49.518329 [error] [MainThread]:   LINE 29:   from customers
18:25:49.518434 [error] [MainThread]:              ^
18:25:49.518543 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/customers.sql
18:25:49.518660 [info ] [MainThread]: 
18:25:49.518774 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
18:25:49.519042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5eaf3460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5eaf3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcb5ea487c0>]}


============================== 2022-06-04 18:26:47.876125 | ae09533c-feff-47cf-b23c-903565d193ba ==============================
18:26:47.876142 [info ] [MainThread]: Running with dbt=1.1.0
18:26:47.876533 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:26:47.876664 [debug] [MainThread]: Tracking: tracking
18:26:47.879062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3287450640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3287450d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32874506d0>]}
18:26:47.899529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:26:47.899914 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:26:47.909013 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:26:47.979482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae09533c-feff-47cf-b23c-903565d193ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f328745e0d0>]}
18:26:47.983647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae09533c-feff-47cf-b23c-903565d193ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3287396190>]}
18:26:47.983946 [info ] [MainThread]: Found 7 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:26:47.984108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae09533c-feff-47cf-b23c-903565d193ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3287396220>]}
18:26:47.985149 [info ] [MainThread]: 
18:26:47.985534 [debug] [MainThread]: Acquiring new postgres connection "master"
18:26:47.986350 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:26:47.993753 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:26:47.993951 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:26:47.995491 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:26:48.008669 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:26:48.009726 [debug] [ThreadPool]: On list_erp_oltp: Close
18:26:48.014661 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:26:48.023639 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:26:48.025210 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:26:48.025489 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:26:48.032742 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:26:48.033015 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:26:48.033171 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:26:48.035497 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:26:48.036422 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:26:48.036880 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:26:48.039838 [debug] [MainThread]: Using postgres connection "master"
18:26:48.040075 [debug] [MainThread]: On master: BEGIN
18:26:48.040157 [debug] [MainThread]: Opening a new connection, currently in state init
18:26:48.045244 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:26:48.045456 [debug] [MainThread]: Using postgres connection "master"
18:26:48.045582 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:26:48.055077 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
18:26:48.056091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae09533c-feff-47cf-b23c-903565d193ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f328734a7c0>]}
18:26:48.056333 [debug] [MainThread]: On master: ROLLBACK
18:26:48.056635 [debug] [MainThread]: Using postgres connection "master"
18:26:48.056723 [debug] [MainThread]: On master: BEGIN
18:26:48.056891 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:26:48.056970 [debug] [MainThread]: On master: COMMIT
18:26:48.057030 [debug] [MainThread]: Using postgres connection "master"
18:26:48.057083 [debug] [MainThread]: On master: COMMIT
18:26:48.057187 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:26:48.057267 [debug] [MainThread]: On master: Close
18:26:48.057736 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:26:48.058136 [info ] [MainThread]: 
18:26:48.066342 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:26:48.066618 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:26:48.066952 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:26:48.067120 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:26:48.067273 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:26:48.069564 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:26:48.069692 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:26:48.070107 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:26:48.070395 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:26:48.070468 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:26:48.070542 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:26:48.072189 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:26:48.072615 [debug] [Thread-2  ]: finished collecting timing info
18:26:48.072821 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:26:48.069823 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:26:48.080675 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:26:48.081201 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:26:48.081297 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:26:48.081379 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:26:48.082143 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:26:48.082449 [debug] [Thread-4  ]: finished collecting timing info
18:26:48.082645 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:26:48.069762 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:26:48.106556 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
18:26:48.106895 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:26:48.107173 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:26:48.107258 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:26:48.108414 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:26:48.108902 [debug] [Thread-3  ]: finished collecting timing info
18:26:48.109119 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:26:48.113262 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:26:48.113602 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:48.113745 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:26:48.114646 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:26:48.117744 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:26:48.118498 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:26:48.118782 [debug] [Thread-1  ]: finished collecting timing info
18:26:48.119478 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:26:48.119101 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:48.119753 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:48.141207 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:26:48.141019 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:26:48.141573 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:26:48.141326 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:26:48.135419 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:26:48.142201 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:48.142291 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
   select
     codigo_cliente as customer_id,
     nome as first_name,
     sobrenome as last_name,
     codigo_regiao as region_code,
     estado as state
   from erp_oltp.public.clientes
)

select * from customers
  );
18:26:48.140819 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:26:48.143373 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:48.143629 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:26:48.143728 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:26:48.145141 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
18:26:48.150008 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:48.150159 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:26:48.150438 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:26:48.150563 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:48.150633 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:26:48.151783 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:26:48.153499 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:48.154702 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:26:48.155046 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:48.153628 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:48.156403 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:48.157842 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:48.158796 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:26:48.158283 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:26:48.158960 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:48.159128 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
18:26:48.158555 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:26:48.158059 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:26:48.159290 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:48.159632 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
)

select * from orders
  );
18:26:48.159986 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:48.166556 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
18:26:48.168039 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:48.168154 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:26:48.168305 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
18:26:48.168430 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
18:26:48.170340 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:48.173845 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:26:48.172870 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:48.172694 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:26:48.175725 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:48.175815 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:26:48.175504 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:48.176058 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:26:48.173608 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:26:48.175917 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:48.176254 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:48.177669 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:48.177800 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:48.179147 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:26:48.178179 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:26:48.177935 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:26:48.179257 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:26:48.179356 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:48.183819 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:26:48.184041 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
18:26:48.183565 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:48.186418 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:26:48.185218 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:48.186665 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:48.187214 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:26:48.186892 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
18:26:48.188705 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:48.183288 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:48.187046 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:26:48.188928 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:26:48.189023 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:26:48.191479 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:48.191893 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:26:48.191719 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
18:26:48.189209 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:26:48.194088 [debug] [Thread-3  ]: finished collecting timing info
18:26:48.194821 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:26:48.194308 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
18:26:48.197454 [debug] [Thread-4  ]: finished collecting timing info
18:26:48.197676 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:26:48.197788 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
18:26:48.198758 [debug] [Thread-2  ]: finished collecting timing info
18:26:48.198871 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:26:48.199222 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae09533c-feff-47cf-b23c-903565d193ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3286ea80d0>]}
18:26:48.199501 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.13s]
18:26:48.199809 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:26:48.200533 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
18:26:48.200882 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae09533c-feff-47cf-b23c-903565d193ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3286eecfd0>]}
18:26:48.202373 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.09s]
18:26:48.202006 [debug] [Thread-1  ]: finished collecting timing info
18:26:48.201074 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae09533c-feff-47cf-b23c-903565d193ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3286ea0f40>]}
18:26:48.203105 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.12s]
18:26:48.202866 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:26:48.203377 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:26:48.202769 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:26:48.205459 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae09533c-feff-47cf-b23c-903565d193ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f328462ce20>]}
18:26:48.205683 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.14s]
18:26:48.205809 [debug] [Thread-6  ]: Began running node model.first_project.customers
18:26:48.206135 [info ] [Thread-6  ]: 5 of 7 START view model public.customers ....................................... [RUN]
18:26:48.206640 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers"
18:26:48.206378 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:26:48.206725 [debug] [Thread-6  ]: Began compiling node model.first_project.customers
18:26:48.206917 [debug] [Thread-6  ]: Compiling model.first_project.customers
18:26:48.208804 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers"
18:26:48.209061 [debug] [Thread-6  ]: finished collecting timing info
18:26:48.209217 [debug] [Thread-6  ]: Began executing node model.first_project.customers
18:26:48.210648 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers"
18:26:48.210913 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
18:26:48.205903 [debug] [Thread-7  ]: Began running node model.first_project.customers2
18:26:48.211377 [info ] [Thread-7  ]: 6 of 7 START table model public.customers2 ..................................... [RUN]
18:26:48.211735 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers2"
18:26:48.211822 [debug] [Thread-7  ]: Began compiling node model.first_project.customers2
18:26:48.211892 [debug] [Thread-7  ]: Compiling model.first_project.customers2
18:26:48.211039 [debug] [Thread-6  ]: On model.first_project.customers: BEGIN
18:26:48.213840 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers2"
18:26:48.214182 [debug] [Thread-9  ]: Began running node model.first_project.my_second_dbt_model
18:26:48.214912 [info ] [Thread-9  ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:26:48.215312 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:26:48.215411 [debug] [Thread-9  ]: Began compiling node model.first_project.my_second_dbt_model
18:26:48.215506 [debug] [Thread-7  ]: finished collecting timing info
18:26:48.218736 [debug] [Thread-9  ]: Compiling model.first_project.my_second_dbt_model
18:26:48.218956 [debug] [Thread-7  ]: Began executing node model.first_project.customers2
18:26:48.214651 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:26:48.221232 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:26:48.223348 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.customers2"
18:26:48.225649 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
18:26:48.225869 [debug] [Thread-7  ]: On model.first_project.customers2: BEGIN
18:26:48.225958 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:26:48.226252 [debug] [Thread-9  ]: finished collecting timing info
18:26:48.230222 [debug] [Thread-9  ]: Began executing node model.first_project.my_second_dbt_model
18:26:48.240680 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:26:48.242423 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:48.242642 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: BEGIN
18:26:48.242723 [debug] [Thread-9  ]: Opening a new connection, currently in state init
18:26:48.241384 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
18:26:48.243498 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
18:26:48.243631 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
18:26:48.245570 [debug] [Thread-7  ]: SQL status: SELECT 100 in 0.0 seconds
18:26:48.247514 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
18:26:48.247656 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:26:48.248785 [debug] [Thread-9  ]: SQL status: BEGIN in 0.01 seconds
18:26:48.248932 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:48.249061 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:26:48.249248 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:48.249558 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
18:26:48.252363 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
18:26:48.252522 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
  WHERE customer_id != 63
)

select * from final
  );
18:26:48.252673 [debug] [Thread-9  ]: SQL status: CREATE VIEW in 0.0 seconds
18:26:48.252088 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
18:26:48.258860 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:26:48.259679 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:48.261151 [debug] [Thread-7  ]: On model.first_project.customers2: COMMIT
18:26:48.261322 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
18:26:48.261400 [debug] [Thread-7  ]: On model.first_project.customers2: COMMIT
18:26:48.261807 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.01 seconds
18:26:48.255029 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:48.267885 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:26:48.267691 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
18:26:48.268041 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
18:26:48.268561 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:48.269670 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
18:26:48.269793 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
18:26:48.269868 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
18:26:48.270089 [debug] [Thread-7  ]: SQL status: COMMIT in 0.01 seconds
18:26:48.271669 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
18:26:48.271770 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:48.272778 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
18:26:48.272882 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:48.272949 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
18:26:48.271826 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
18:26:48.271922 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:26:48.274178 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
18:26:48.275114 [debug] [Thread-9  ]: SQL status: COMMIT in 0.0 seconds
18:26:48.275291 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
18:26:48.276777 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:48.277105 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
18:26:48.278067 [debug] [Thread-6  ]: finished collecting timing info
18:26:48.277258 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:26:48.278200 [debug] [Thread-6  ]: On model.first_project.customers: Close
18:26:48.278622 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae09533c-feff-47cf-b23c-903565d193ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3287458310>]}
18:26:48.278849 [info ] [Thread-6  ]: 5 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.07s]
18:26:48.277179 [debug] [Thread-7  ]: SQL status: DROP TABLE in 0.0 seconds
18:26:48.279935 [debug] [Thread-7  ]: finished collecting timing info
18:26:48.280046 [debug] [Thread-7  ]: On model.first_project.customers2: Close
18:26:48.280705 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae09533c-feff-47cf-b23c-903565d193ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3287458e80>]}
18:26:48.280970 [info ] [Thread-7  ]: 6 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.07s]
18:26:48.280399 [debug] [Thread-6  ]: Finished running node model.first_project.customers
18:26:48.281376 [debug] [Thread-7  ]: Finished running node model.first_project.customers2
18:26:48.280153 [debug] [Thread-9  ]: SQL status: DROP VIEW in 0.0 seconds
18:26:48.282854 [debug] [Thread-9  ]: finished collecting timing info
18:26:48.282965 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: Close
18:26:48.283605 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae09533c-feff-47cf-b23c-903565d193ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3284578e50>]}
18:26:48.283863 [info ] [Thread-9  ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
18:26:48.284159 [debug] [Thread-9  ]: Finished running node model.first_project.my_second_dbt_model
18:26:48.286226 [debug] [MainThread]: Acquiring new postgres connection "master"
18:26:48.286363 [debug] [MainThread]: Using postgres connection "master"
18:26:48.286437 [debug] [MainThread]: On master: BEGIN
18:26:48.286500 [debug] [MainThread]: Opening a new connection, currently in state closed
18:26:48.295304 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:26:48.295566 [debug] [MainThread]: On master: COMMIT
18:26:48.295645 [debug] [MainThread]: Using postgres connection "master"
18:26:48.295737 [debug] [MainThread]: On master: COMMIT
18:26:48.296187 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:26:48.296371 [debug] [MainThread]: On master: Close
18:26:48.296913 [info ] [MainThread]: 
18:26:48.297184 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.31s.
18:26:48.297345 [debug] [MainThread]: Connection 'master' was properly closed.
18:26:48.297426 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:26:48.297491 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:26:48.297550 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:26:48.297608 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:26:48.297696 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:26:48.297755 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:26:48.297813 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:26:48.301399 [info ] [MainThread]: 
18:26:48.301777 [info ] [MainThread]: [32mCompleted successfully[0m
18:26:48.301951 [info ] [MainThread]: 
18:26:48.302074 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:26:48.302288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3288ce4940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3288ce4dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3286f01790>]}


============================== 2022-06-04 18:26:52.532663 | fd32cb2d-1480-40a4-b575-27ccbd499189 ==============================
18:26:52.532696 [info ] [MainThread]: Running with dbt=1.1.0
18:26:52.533350 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:26:52.533438 [debug] [MainThread]: Tracking: tracking
18:26:52.545844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63fe9d9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63fe9d9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63fe9d96d0>]}
18:26:52.577052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:26:52.577237 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:26:52.583954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd32cb2d-1480-40a4-b575-27ccbd499189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63fe88b0d0>]}
18:26:52.588454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd32cb2d-1480-40a4-b575-27ccbd499189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63fe96ba60>]}
18:26:52.588787 [info ] [MainThread]: Found 7 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:26:52.588939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd32cb2d-1480-40a4-b575-27ccbd499189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63fe96ba30>]}
18:26:52.590034 [info ] [MainThread]: 
18:26:52.590372 [debug] [MainThread]: Acquiring new postgres connection "master"
18:26:52.592038 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:26:52.599849 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:26:52.600040 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:26:52.600131 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:26:52.620941 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
18:26:52.621239 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:26:52.621317 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:26:52.623012 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:26:52.624893 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:26:52.628165 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:26:52.631680 [debug] [MainThread]: Using postgres connection "master"
18:26:52.631889 [debug] [MainThread]: On master: BEGIN
18:26:52.631968 [debug] [MainThread]: Opening a new connection, currently in state init
18:26:52.643887 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:26:52.644583 [debug] [MainThread]: Using postgres connection "master"
18:26:52.644740 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:26:52.656796 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
18:26:52.658757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd32cb2d-1480-40a4-b575-27ccbd499189', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63fe96b850>]}
18:26:52.659189 [debug] [MainThread]: On master: ROLLBACK
18:26:52.659670 [debug] [MainThread]: Using postgres connection "master"
18:26:52.659857 [debug] [MainThread]: On master: BEGIN
18:26:52.660133 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:26:52.660441 [debug] [MainThread]: On master: COMMIT
18:26:52.660604 [debug] [MainThread]: Using postgres connection "master"
18:26:52.660678 [debug] [MainThread]: On master: COMMIT
18:26:52.660847 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:26:52.660994 [debug] [MainThread]: On master: Close
18:26:52.661420 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:26:52.661700 [info ] [MainThread]: 
18:26:52.680278 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:26:52.680781 [info ] [Thread-1  ]: 1 of 6 START test accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [RUN]
18:26:52.681315 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:26:52.681462 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:26:52.681578 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:26:52.687921 [debug] [Thread-2  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:26:52.688081 [info ] [Thread-2  ]: 2 of 6 START test not_null_customers_customer_id ............................... [RUN]
18:26:52.688330 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:26:52.688417 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:26:52.688488 [debug] [Thread-2  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
18:26:52.737791 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:26:52.742988 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:26:52.743783 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:26:52.743957 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:26:52.745202 [info ] [Thread-4  ]: 4 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:26:52.745604 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:26:52.745718 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:26:52.744844 [debug] [Thread-2  ]: finished collecting timing info
18:26:52.745819 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:26:52.749453 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:26:52.744128 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:26:52.744220 [info ] [Thread-3  ]: 3 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:26:52.750362 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:26:52.750490 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:26:52.750578 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:26:52.744060 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:26:52.755382 [info ] [Thread-5  ]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
18:26:52.755723 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:26:52.755017 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:26:52.749781 [info ] [Thread-6  ]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
18:26:52.756410 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:26:52.756698 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:26:52.756833 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:26:52.756506 [debug] [Thread-3  ]: finished collecting timing info
18:26:52.755827 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:26:52.745955 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:26:52.767232 [debug] [Thread-4  ]: finished collecting timing info
18:26:52.780268 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:26:52.768421 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:26:52.767913 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:26:52.780069 [debug] [Thread-1  ]: finished collecting timing info
18:26:52.783900 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:26:52.784862 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:26:52.769431 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:26:52.783061 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:26:52.781690 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:26:52.785213 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:26:52.779910 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:26:52.785527 [debug] [Thread-6  ]: finished collecting timing info
18:26:52.789816 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:26:52.788503 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:26:52.788966 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:26:52.796221 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:26:52.789410 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:26:52.788087 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:26:52.791315 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:26:52.796032 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:26:52.796329 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:26:52.799205 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:26:52.796545 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
18:26:52.797075 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:26:52.789144 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: BEGIN
18:26:52.799820 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:26:52.797338 [debug] [Thread-5  ]: finished collecting timing info
18:26:52.799535 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:26:52.799418 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:26:52.801698 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:26:52.800783 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:26:52.803459 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:26:52.803824 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:26:52.803925 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:26:52.804008 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:26:52.805629 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
18:26:52.805756 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:26:52.805831 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:26:52.807539 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:26:52.807775 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:26:52.807866 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:26:52.807973 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:26:52.809590 [debug] [Thread-3  ]: finished collecting timing info
18:26:52.809720 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:26:52.810668 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:26:52.810809 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:26:52.811908 [debug] [Thread-4  ]: finished collecting timing info
18:26:52.812089 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:26:52.812801 [error] [Thread-3  ]: 3 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.06s]
18:26:52.813215 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:26:52.813466 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:26:52.815872 [info ] [Thread-4  ]: 4 of 6 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.07s]
18:26:52.816307 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:26:52.824087 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:26:52.824679 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:26:52.825013 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
18:26:52.825228 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
18:26:52.825449 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:26:52.825726 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:26:52.826989 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
18:26:52.827171 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:26:52.828116 [debug] [Thread-5  ]: finished collecting timing info
18:26:52.829230 [debug] [Thread-2  ]: finished collecting timing info
18:26:52.829446 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:26:52.829704 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
18:26:52.829909 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:26:52.830256 [info ] [Thread-5  ]: 5 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.07s]
18:26:52.830742 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:26:52.830933 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
18:26:52.831374 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
18:26:52.831785 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:26:52.831685 [info ] [Thread-2  ]: 2 of 6 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.14s]
18:26:52.831871 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:26:52.831267 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:26:52.832107 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:26:52.832289 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:26:52.832620 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."customers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT','GO','DF','PA'
)



      
    ) dbt_internal_test
18:26:52.833211 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:26:52.834464 [debug] [Thread-6  ]: finished collecting timing info
18:26:52.834615 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:26:52.834960 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:26:52.835306 [info ] [Thread-6  ]: 6 of 6 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.08s]
18:26:52.835684 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:26:52.837696 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:26:52.838638 [debug] [Thread-1  ]: finished collecting timing info
18:26:52.838857 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: ROLLBACK
18:26:52.839019 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: Close
18:26:52.839390 [info ] [Thread-1  ]: 1 of 6 PASS accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [[32mPASS[0m in 0.16s]
18:26:52.839655 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:26:52.841410 [debug] [MainThread]: Acquiring new postgres connection "master"
18:26:52.841694 [debug] [MainThread]: Using postgres connection "master"
18:26:52.841796 [debug] [MainThread]: On master: BEGIN
18:26:52.841881 [debug] [MainThread]: Opening a new connection, currently in state closed
18:26:52.850724 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:26:52.851103 [debug] [MainThread]: On master: COMMIT
18:26:52.851218 [debug] [MainThread]: Using postgres connection "master"
18:26:52.851289 [debug] [MainThread]: On master: COMMIT
18:26:52.851559 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:26:52.851674 [debug] [MainThread]: On master: Close
18:26:52.852096 [info ] [MainThread]: 
18:26:52.852486 [info ] [MainThread]: Finished running 6 tests in 0.26s.
18:26:52.852650 [debug] [MainThread]: Connection 'master' was properly closed.
18:26:52.852733 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
18:26:52.852793 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
18:26:52.852855 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:26:52.852918 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:26:52.853009 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:26:52.853097 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:26:52.864968 [info ] [MainThread]: 
18:26:52.865237 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:26:52.865433 [info ] [MainThread]: 
18:26:52.865654 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:26:52.865840 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:26:52.865944 [info ] [MainThread]: 
18:26:52.866036 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:26:52.866137 [info ] [MainThread]: 
18:26:52.866225 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
18:26:52.866391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e4795f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e4795fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63e4795d90>]}


============================== 2022-06-04 18:28:12.336074 | 7f6ba7af-7b5b-4720-af6c-1acbaed22278 ==============================
18:28:12.336095 [info ] [MainThread]: Running with dbt=1.1.0
18:28:12.336669 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:28:12.336765 [debug] [MainThread]: Tracking: tracking
18:28:12.339578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63e507a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63e507220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63e507eb0>]}
18:28:12.365280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:28:12.366084 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
18:28:12.401261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f6ba7af-7b5b-4720-af6c-1acbaed22278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63e3980d0>]}
18:28:12.406046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f6ba7af-7b5b-4720-af6c-1acbaed22278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63e3f9dc0>]}
18:28:12.406365 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:28:12.406528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f6ba7af-7b5b-4720-af6c-1acbaed22278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63e3f9d60>]}
18:28:12.407889 [info ] [MainThread]: 
18:28:12.408315 [debug] [MainThread]: Acquiring new postgres connection "master"
18:28:12.409269 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:28:12.455612 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:28:12.455862 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:28:12.455935 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:28:12.462364 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:28:12.463515 [debug] [ThreadPool]: On list_erp_oltp: Close
18:28:12.464810 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:28:12.468961 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:28:12.469087 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:28:12.469168 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:28:12.474790 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:28:12.474963 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:28:12.475035 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:28:12.476392 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:28:12.477328 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:28:12.477495 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:28:12.480629 [debug] [MainThread]: Using postgres connection "master"
18:28:12.480819 [debug] [MainThread]: On master: BEGIN
18:28:12.480894 [debug] [MainThread]: Opening a new connection, currently in state init
18:28:12.487672 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:28:12.488149 [debug] [MainThread]: Using postgres connection "master"
18:28:12.488225 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:28:12.498854 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
18:28:12.500006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f6ba7af-7b5b-4720-af6c-1acbaed22278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63e503cd0>]}
18:28:12.500252 [debug] [MainThread]: On master: ROLLBACK
18:28:12.500598 [debug] [MainThread]: Using postgres connection "master"
18:28:12.500700 [debug] [MainThread]: On master: BEGIN
18:28:12.501180 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:28:12.501339 [debug] [MainThread]: On master: COMMIT
18:28:12.501427 [debug] [MainThread]: Using postgres connection "master"
18:28:12.501513 [debug] [MainThread]: On master: COMMIT
18:28:12.501765 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:28:12.501886 [debug] [MainThread]: On master: Close
18:28:12.502198 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:28:12.502411 [info ] [MainThread]: 
18:28:12.507031 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:28:12.507430 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:28:12.507909 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:28:12.508024 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:28:12.508107 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:28:12.509721 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:28:12.510201 [debug] [Thread-1  ]: finished collecting timing info
18:28:12.510373 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:28:12.516349 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:28:12.516656 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:28:12.516947 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:28:12.517034 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:28:12.517102 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:28:12.518677 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:28:12.518944 [debug] [Thread-2  ]: finished collecting timing info
18:28:12.519069 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:28:12.519501 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:28:12.525385 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
18:28:12.524979 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:28:12.533534 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:28:12.558087 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:28:12.557680 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:28:12.557943 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:28:12.558169 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:28:12.559780 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:28:12.558698 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:28:12.558940 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:28:12.560516 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:28:12.560612 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:28:12.560283 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:28:12.561036 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:28:12.560047 [debug] [Thread-3  ]: finished collecting timing info
18:28:12.562120 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:28:12.561946 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:28:12.564567 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:28:12.557165 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:28:12.565058 [debug] [Thread-4  ]: finished collecting timing info
18:28:12.565313 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:28:12.565778 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:28:12.566054 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:28:12.575372 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:28:12.575520 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:28:12.566189 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:28:12.576428 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:28:12.577900 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:28:12.578180 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:28:12.578296 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:28:12.578396 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:28:12.581792 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:28:12.582026 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:28:12.582130 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
18:28:12.584709 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
18:28:12.594053 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:28:12.594245 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:28:12.597599 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:28:12.599411 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:28:12.601555 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
18:28:12.602327 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:28:12.602400 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
   select
     codigo_cliente as customer_id,
     nome as first_name,
     sobrenome as last_name,
     codigo_regiao as region_code,
     estado as state
   from erp_oltp.public.clientes
)

select * from customers
  );
18:28:12.601897 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:28:12.602561 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:28:12.602628 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
)

select * from orders
  );
18:28:12.602000 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:28:12.602732 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:28:12.602793 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:28:12.603798 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
18:28:12.605659 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:28:12.605778 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:28:12.605900 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
18:28:12.607429 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:28:12.607530 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:28:12.608429 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
18:28:12.609718 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:28:12.609810 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:28:12.602157 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:28:12.610383 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:28:12.611955 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:28:12.612081 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:28:12.612202 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:28:12.615142 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:28:12.615300 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:28:12.615434 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
18:28:12.616864 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:28:12.616976 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:28:12.617104 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:28:12.621694 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:28:12.621852 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:28:12.621925 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:28:12.622071 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
18:28:12.623071 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:28:12.623223 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:28:12.623317 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:28:12.623440 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
18:28:12.624272 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:28:12.624400 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:28:12.624499 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:28:12.624717 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
18:28:12.628528 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:28:12.628689 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.02 seconds
18:28:12.633431 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:28:12.633611 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:28:12.633691 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:28:12.628755 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
18:28:12.635147 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:28:12.635336 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:28:12.628807 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
18:28:12.628908 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:28:12.637503 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
18:28:12.639608 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:28:12.639725 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:28:12.640412 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
18:28:12.641418 [debug] [Thread-2  ]: finished collecting timing info
18:28:12.641544 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:28:12.643319 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.01 seconds
18:28:12.644120 [debug] [Thread-4  ]: finished collecting timing info
18:28:12.644360 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:28:12.644825 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6ba7af-7b5b-4720-af6c-1acbaed22278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63c26dd90>]}
18:28:12.645232 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.09s]
18:28:12.645533 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:28:12.645680 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
18:28:12.637337 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:28:12.646852 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:28:12.647210 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6ba7af-7b5b-4720-af6c-1acbaed22278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63e318fa0>]}
18:28:12.647462 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.13s]
18:28:12.647748 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:28:12.646656 [debug] [Thread-1  ]: finished collecting timing info
18:28:12.648177 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:28:12.648812 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6ba7af-7b5b-4720-af6c-1acbaed22278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63e34cd00>]}
18:28:12.649130 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.14s]
18:28:12.649510 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:28:12.649911 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.0 seconds
18:28:12.651111 [debug] [Thread-3  ]: finished collecting timing info
18:28:12.651315 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:28:12.651545 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
18:28:12.651784 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:28:12.652108 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:28:12.652197 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
18:28:12.652274 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
18:28:12.660601 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6ba7af-7b5b-4720-af6c-1acbaed22278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63e36b340>]}
18:28:12.661058 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.13s]
18:28:12.661401 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:28:12.661784 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:28:12.662299 [debug] [Thread-8  ]: Began running node model.first_project.customers
18:28:12.662530 [info ] [Thread-8  ]: 6 of 7 START view model public.customers ....................................... [RUN]
18:28:12.662783 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
18:28:12.662864 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
18:28:12.662972 [debug] [Thread-9  ]: Began running node model.first_project.customers2
18:28:12.663274 [debug] [Thread-8  ]: Compiling model.first_project.customers
18:28:12.666131 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
18:28:12.663875 [info ] [Thread-9  ]: 7 of 7 START table model public.customers2 ..................................... [RUN]
18:28:12.663358 [debug] [Thread-6  ]: finished collecting timing info
18:28:12.666717 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers2"
18:28:12.666909 [debug] [Thread-8  ]: finished collecting timing info
18:28:12.667522 [debug] [Thread-8  ]: Began executing node model.first_project.customers
18:28:12.667279 [debug] [Thread-9  ]: Began compiling node model.first_project.customers2
18:28:12.667093 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
18:28:12.674339 [debug] [Thread-9  ]: Compiling model.first_project.customers2
18:28:12.668944 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
18:28:12.679938 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:28:12.679475 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers2"
18:28:12.680155 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
18:28:12.680601 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:28:12.677492 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:28:12.681482 [debug] [Thread-9  ]: finished collecting timing info
18:28:12.681772 [debug] [Thread-9  ]: Began executing node model.first_project.customers2
18:28:12.683640 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.customers2"
18:28:12.683876 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:28:12.684030 [debug] [Thread-9  ]: On model.first_project.customers2: BEGIN
18:28:12.684100 [debug] [Thread-9  ]: Opening a new connection, currently in state init
18:28:12.684273 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:28:12.684392 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
18:28:12.684452 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:28:12.690432 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
18:28:12.690702 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:28:12.690796 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
  WHERE customer_id != 63
)

select * from final
  );
18:28:12.693495 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
18:28:12.695233 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:28:12.695348 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
18:28:12.695457 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
18:28:12.695526 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:28:12.695636 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:28:12.695983 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:28:12.696802 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
18:28:12.696882 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
18:28:12.698215 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:28:12.698300 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:28:12.696963 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:28:12.698410 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
18:28:12.698853 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:28:12.699561 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
18:28:12.699645 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:28:12.699700 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
18:28:12.701193 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
18:28:12.702525 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:28:12.702722 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
18:28:12.702909 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
18:28:12.704750 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:28:12.704876 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:28:12.705226 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
18:28:12.705988 [debug] [Thread-8  ]: finished collecting timing info
18:28:12.706096 [debug] [Thread-8  ]: On model.first_project.customers: Close
18:28:12.706514 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6ba7af-7b5b-4720-af6c-1acbaed22278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63e325970>]}
18:28:12.706765 [info ] [Thread-8  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.04s]
18:28:12.707003 [debug] [Thread-8  ]: Finished running node model.first_project.customers
18:28:12.708609 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
18:28:12.709551 [debug] [Thread-6  ]: finished collecting timing info
18:28:12.709655 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
18:28:12.709917 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6ba7af-7b5b-4720-af6c-1acbaed22278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63e357ee0>]}
18:28:12.710132 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
18:28:12.710492 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
18:28:12.715196 [debug] [Thread-9  ]: SQL status: BEGIN in 0.03 seconds
18:28:12.715356 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:28:12.715427 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
18:28:12.717170 [debug] [Thread-9  ]: SQL status: SELECT 100 in 0.0 seconds
18:28:12.718774 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:28:12.718862 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:28:12.721033 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
18:28:12.723496 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:28:12.723634 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:28:12.725110 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
18:28:12.729479 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
18:28:12.729652 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:28:12.729978 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
18:28:12.732104 [debug] [Thread-9  ]: SQL status: COMMIT in 0.0 seconds
18:28:12.733537 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:28:12.735693 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:28:12.738814 [debug] [Thread-9  ]: SQL status: DROP TABLE in 0.0 seconds
18:28:12.739795 [debug] [Thread-9  ]: finished collecting timing info
18:28:12.739943 [debug] [Thread-9  ]: On model.first_project.customers2: Close
18:28:12.740285 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f6ba7af-7b5b-4720-af6c-1acbaed22278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63e2fb7c0>]}
18:28:12.741978 [info ] [Thread-9  ]: 7 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.07s]
18:28:12.742308 [debug] [Thread-9  ]: Finished running node model.first_project.customers2
18:28:12.747966 [debug] [MainThread]: Acquiring new postgres connection "master"
18:28:12.748307 [debug] [MainThread]: Using postgres connection "master"
18:28:12.748471 [debug] [MainThread]: On master: BEGIN
18:28:12.748562 [debug] [MainThread]: Opening a new connection, currently in state closed
18:28:12.755373 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:28:12.755629 [debug] [MainThread]: On master: COMMIT
18:28:12.755729 [debug] [MainThread]: Using postgres connection "master"
18:28:12.755809 [debug] [MainThread]: On master: COMMIT
18:28:12.756094 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:28:12.756289 [debug] [MainThread]: On master: Close
18:28:12.757051 [info ] [MainThread]: 
18:28:12.757285 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.35s.
18:28:12.757416 [debug] [MainThread]: Connection 'master' was properly closed.
18:28:12.757510 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:28:12.757564 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:28:12.757613 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:28:12.757674 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:28:12.757724 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:28:12.757773 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:28:12.757826 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:28:12.762027 [info ] [MainThread]: 
18:28:12.762427 [info ] [MainThread]: [32mCompleted successfully[0m
18:28:12.762720 [info ] [MainThread]: 
18:28:12.762838 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:28:12.763077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6406e0190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6406e0520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb63c238100>]}


============================== 2022-06-04 18:28:16.679035 | 6572366e-8cd2-4449-8be5-c1458b355682 ==============================
18:28:16.679048 [info ] [MainThread]: Running with dbt=1.1.0
18:28:16.679404 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:28:16.679523 [debug] [MainThread]: Tracking: tracking
18:28:16.690335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c6dd95640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c6dd95d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c6dd956d0>]}
18:28:16.712198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:28:16.712415 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:28:16.716403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6572366e-8cd2-4449-8be5-c1458b355682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c6dc450d0>]}
18:28:16.720943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6572366e-8cd2-4449-8be5-c1458b355682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c6dd25a90>]}
18:28:16.721738 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:28:16.721924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6572366e-8cd2-4449-8be5-c1458b355682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c6dd25a60>]}
18:28:16.723326 [info ] [MainThread]: 
18:28:16.726942 [debug] [MainThread]: Acquiring new postgres connection "master"
18:28:16.729207 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:28:16.737676 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:28:16.739999 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:28:16.740115 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:28:16.751872 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:28:16.752414 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:28:16.752541 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:28:16.755601 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:28:16.757071 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:28:16.757573 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:28:16.761967 [debug] [MainThread]: Using postgres connection "master"
18:28:16.762196 [debug] [MainThread]: On master: BEGIN
18:28:16.762298 [debug] [MainThread]: Opening a new connection, currently in state init
18:28:16.768459 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:28:16.768619 [debug] [MainThread]: Using postgres connection "master"
18:28:16.768687 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:28:16.780391 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
18:28:16.781611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6572366e-8cd2-4449-8be5-c1458b355682', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c6dd25880>]}
18:28:16.781879 [debug] [MainThread]: On master: ROLLBACK
18:28:16.782311 [debug] [MainThread]: Using postgres connection "master"
18:28:16.782467 [debug] [MainThread]: On master: BEGIN
18:28:16.783077 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:28:16.783208 [debug] [MainThread]: On master: COMMIT
18:28:16.783274 [debug] [MainThread]: Using postgres connection "master"
18:28:16.783332 [debug] [MainThread]: On master: COMMIT
18:28:16.783587 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:28:16.783722 [debug] [MainThread]: On master: Close
18:28:16.784015 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:28:16.784160 [info ] [MainThread]: 
18:28:16.790577 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:28:16.790882 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [RUN]
18:28:16.791328 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:28:16.791519 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:28:16.791657 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:28:16.802323 [debug] [Thread-2  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:28:16.802965 [info ] [Thread-2  ]: 2 of 7 START test not_null_customers_customer_id ............................... [RUN]
18:28:16.803999 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:28:16.804195 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:28:16.804293 [debug] [Thread-2  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
18:28:16.848775 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:28:16.849006 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:28:16.853848 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:28:16.852877 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:28:16.853248 [debug] [Thread-5  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:28:16.854512 [info ] [Thread-5  ]: 5 of 7 START test relationships_stg_orders_customer_id__customer_id__ref_customers_  [RUN]
18:28:16.854870 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:28:16.855004 [debug] [Thread-5  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:28:16.855177 [debug] [Thread-5  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:28:16.849098 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:28:16.860738 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:28:16.861131 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:28:16.861442 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:28:16.861560 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:28:16.853416 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:28:16.864429 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:28:16.864685 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:28:16.864764 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:28:16.864832 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:28:16.853509 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:28:16.868711 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:28:16.869023 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:28:16.869366 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:28:16.869520 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:28:16.854182 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:28:16.878614 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:28:16.878719 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:28:16.868555 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:28:16.878131 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:28:16.864219 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:28:16.872360 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:28:16.881211 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:28:16.881496 [debug] [Thread-1  ]: finished collecting timing info
18:28:16.882019 [debug] [Thread-4  ]: finished collecting timing info
18:28:16.889877 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:28:16.882366 [debug] [Thread-7  ]: finished collecting timing info
18:28:16.889382 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:28:16.882501 [debug] [Thread-6  ]: finished collecting timing info
18:28:16.901596 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:28:16.902692 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:28:16.899830 [debug] [Thread-2  ]: finished collecting timing info
18:28:16.899930 [debug] [Thread-3  ]: finished collecting timing info
18:28:16.903551 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:28:16.905016 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:28:16.899996 [debug] [Thread-5  ]: finished collecting timing info
18:28:16.905695 [debug] [Thread-5  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:28:16.903374 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:28:16.908210 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:28:16.901323 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:28:16.905458 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:28:16.908799 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:28:16.895514 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:28:16.910675 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:28:16.910886 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:28:16.899576 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:28:16.906783 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:28:16.908918 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:28:16.907236 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:28:16.911907 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:28:16.912030 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:28:16.911797 [debug] [Thread-5  ]: Using postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:28:16.912577 [debug] [Thread-5  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: BEGIN
18:28:16.912663 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:28:16.911166 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:28:16.908414 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:28:16.913641 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
18:28:16.913714 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:28:16.913408 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:28:16.914335 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: BEGIN
18:28:16.914403 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:28:16.913524 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:28:16.913298 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:28:16.915137 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:28:16.915214 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:28:16.923468 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
18:28:16.923746 [debug] [Thread-5  ]: Using postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:28:16.923865 [debug] [Thread-5  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "erp_oltp"."public"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "erp_oltp"."public"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
18:28:16.924808 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
18:28:16.924941 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:28:16.925000 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:28:16.925497 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:28:16.926951 [debug] [Thread-3  ]: finished collecting timing info
18:28:16.927163 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:28:16.927305 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:28:16.927415 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:28:16.927487 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:28:16.928155 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:28:16.929060 [debug] [Thread-6  ]: finished collecting timing info
18:28:16.929176 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:28:16.929259 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:28:16.929407 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:28:16.929731 [error] [Thread-3  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.08s]
18:28:16.930620 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:28:16.929903 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.01 seconds
18:28:16.930037 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:28:16.932105 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:28:16.932185 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."customers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT','GO','DF','PA'
)



      
    ) dbt_internal_test
18:28:16.931805 [debug] [Thread-5  ]: finished collecting timing info
18:28:16.931991 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:28:16.932499 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:28:16.932619 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
18:28:16.932340 [debug] [Thread-5  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: ROLLBACK
18:28:16.930122 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:28:16.932780 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:28:16.930178 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:28:16.932862 [debug] [Thread-5  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: Close
18:28:16.933180 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.07s]
18:28:16.933482 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:28:16.933818 [error] [Thread-5  ]: 5 of 7 FAIL 20 relationships_stg_orders_customer_id__customer_id__ref_customers_  [[31mFAIL 20[0m in 0.08s]
18:28:16.934829 [debug] [Thread-5  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:28:16.936756 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:28:16.937747 [debug] [Thread-4  ]: finished collecting timing info
18:28:16.937879 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:28:16.938116 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
18:28:16.938222 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:28:16.938350 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:28:16.938924 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.01 seconds
18:28:16.939056 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.0 seconds
18:28:16.939878 [debug] [Thread-2  ]: finished collecting timing info
18:28:16.942417 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
18:28:16.942634 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
18:28:16.941177 [debug] [Thread-7  ]: finished collecting timing info
18:28:16.947626 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:28:16.944080 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
18:28:16.948137 [info ] [Thread-2  ]: 2 of 7 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.14s]
18:28:16.948446 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:28:16.939980 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:28:16.948739 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.09s]
18:28:16.949011 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:28:16.943832 [debug] [Thread-1  ]: finished collecting timing info
18:28:16.949259 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: ROLLBACK
18:28:16.949701 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:28:16.950091 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.08s]
18:28:16.950730 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:28:16.953895 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: Close
18:28:16.954971 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [[32mPASS[0m in 0.16s]
18:28:16.955480 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:28:16.958074 [debug] [MainThread]: Acquiring new postgres connection "master"
18:28:16.958240 [debug] [MainThread]: Using postgres connection "master"
18:28:16.958310 [debug] [MainThread]: On master: BEGIN
18:28:16.958368 [debug] [MainThread]: Opening a new connection, currently in state closed
18:28:16.963247 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:28:16.963466 [debug] [MainThread]: On master: COMMIT
18:28:16.963576 [debug] [MainThread]: Using postgres connection "master"
18:28:16.963647 [debug] [MainThread]: On master: COMMIT
18:28:16.963820 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:28:16.963966 [debug] [MainThread]: On master: Close
18:28:16.964327 [info ] [MainThread]: 
18:28:16.964472 [info ] [MainThread]: Finished running 7 tests in 0.24s.
18:28:16.964645 [debug] [MainThread]: Connection 'master' was properly closed.
18:28:16.964707 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
18:28:16.964764 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
18:28:16.964812 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:28:16.964859 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
18:28:16.964907 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:28:16.964954 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:28:16.965001 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:28:16.968660 [info ] [MainThread]: 
18:28:16.968882 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
18:28:16.969131 [info ] [MainThread]: 
18:28:16.969292 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:28:16.973850 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:28:16.974004 [info ] [MainThread]: 
18:28:16.974108 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:28:16.974218 [info ] [MainThread]: 
18:28:16.974388 [error] [MainThread]: [31mFailure in test relationships_stg_orders_customer_id__customer_id__ref_customers_ (models/erp/schema.yml)[0m
18:28:16.974505 [error] [MainThread]:   Got 20 results, configured to fail if != 0
18:28:16.974638 [info ] [MainThread]: 
18:28:16.974875 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/relationships_stg_orders_ea624a80826c8a7f9bd15b85fd5d6316.sql
18:28:16.975015 [info ] [MainThread]: 
18:28:16.975203 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
18:28:16.975437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c6dc3d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c6dc3d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c6dc11520>]}


============================== 2022-06-04 18:50:20.143917 | d41c55ae-d700-43d3-9398-43d043c40788 ==============================
18:50:20.143927 [info ] [MainThread]: Running with dbt=1.1.0
18:50:20.144349 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
18:50:20.144487 [debug] [MainThread]: Tracking: tracking
18:50:20.147972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2133a280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2133af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2133a250>]}
18:50:20.209011 [debug] [MainThread]: Executing "git --help"
18:50:20.217696 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
18:50:20.218059 [debug] [MainThread]: STDERR: "b''"
18:50:20.227759 [debug] [MainThread]: Acquiring new postgres connection "debug"
18:50:20.228439 [debug] [MainThread]: Using postgres connection "debug"
18:50:20.228547 [debug] [MainThread]: On debug: select 1 as id
18:50:20.228623 [debug] [MainThread]: Opening a new connection, currently in state init
18:50:20.237937 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
18:50:20.238933 [debug] [MainThread]: On debug: Close
18:50:20.239502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b1fabdaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b1facbbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b1facbaf0>]}
18:50:20.977947 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-04 20:29:38.043676 | e8993e0e-be97-43ff-a981-92b7cbd5e166 ==============================
20:29:38.043688 [info ] [MainThread]: Running with dbt=1.1.0
20:29:38.045555 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:29:38.045663 [debug] [MainThread]: Tracking: tracking
20:29:38.048170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a40c5ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a40c54c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a40c5a60>]}
20:29:38.071794 [info ] [MainThread]: Unable to do partial parsing because profile has changed
20:29:38.072229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e8993e0e-be97-43ff-a981-92b7cbd5e166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a5896e80>]}
20:29:38.092682 [debug] [MainThread]: Parsing macros/catalog.sql
20:29:38.094871 [debug] [MainThread]: Parsing macros/relations.sql
20:29:38.095721 [debug] [MainThread]: Parsing macros/adapters.sql
20:29:38.115007 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
20:29:38.116514 [debug] [MainThread]: Parsing macros/materializations/configs.sql
20:29:38.118257 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
20:29:38.121352 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
20:29:38.127355 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
20:29:38.137126 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
20:29:38.146849 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
20:29:38.149760 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
20:29:38.150925 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
20:29:38.152063 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
20:29:38.153654 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
20:29:38.156264 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
20:29:38.160784 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
20:29:38.165084 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
20:29:38.166819 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
20:29:38.177212 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
20:29:38.181210 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
20:29:38.182768 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
20:29:38.186334 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
20:29:38.187697 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
20:29:38.195535 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
20:29:38.205566 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
20:29:38.212060 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
20:29:38.213062 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
20:29:38.214526 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
20:29:38.215469 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
20:29:38.216375 [debug] [MainThread]: Parsing macros/adapters/columns.sql
20:29:38.223249 [debug] [MainThread]: Parsing macros/adapters/relation.sql
20:29:38.228974 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
20:29:38.231091 [debug] [MainThread]: Parsing macros/adapters/schema.sql
20:29:38.232563 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
20:29:38.234230 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
20:29:38.238736 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
20:29:38.241546 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
20:29:38.242093 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
20:29:38.242616 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
20:29:38.243029 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
20:29:38.243869 [debug] [MainThread]: Parsing macros/etc/datetime.sql
20:29:38.248791 [debug] [MainThread]: Parsing macros/etc/statement.sql
20:29:38.252104 [debug] [MainThread]: Parsing tests/generic/builtin.sql
20:29:38.400248 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers2.sql
20:29:38.408471 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
20:29:38.410061 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
20:29:38.411932 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
20:29:38.413376 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
20:29:38.414869 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
20:29:38.416175 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
20:29:38.487764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8993e0e-be97-43ff-a981-92b7cbd5e166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a40400d0>]}
20:29:38.491793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8993e0e-be97-43ff-a981-92b7cbd5e166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a407e460>]}
20:29:38.492088 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:29:38.492254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8993e0e-be97-43ff-a981-92b7cbd5e166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a4037d30>]}
20:29:38.493236 [info ] [MainThread]: 
20:29:38.493587 [debug] [MainThread]: Acquiring new postgres connection "master"
20:29:38.494402 [debug] [ThreadPool]: Acquiring new postgres connection "list_datawarehouse"
20:29:38.501548 [debug] [ThreadPool]: Using postgres connection "list_datawarehouse"
20:29:38.501844 [debug] [ThreadPool]: On list_datawarehouse: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "connection_name": "list_datawarehouse"} */

    select distinct nspname from pg_namespace
  
20:29:38.502007 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:29:38.516758 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
20:29:38.518293 [debug] [ThreadPool]: On list_datawarehouse: Close
20:29:38.520656 [debug] [ThreadPool]: Acquiring new postgres connection "list_datawarehouse_public"
20:29:38.529857 [debug] [ThreadPool]: Using postgres connection "list_datawarehouse_public"
20:29:38.530158 [debug] [ThreadPool]: On list_datawarehouse_public: BEGIN
20:29:38.530240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:29:38.538252 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:29:38.538463 [debug] [ThreadPool]: Using postgres connection "list_datawarehouse_public"
20:29:38.538660 [debug] [ThreadPool]: On list_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "connection_name": "list_datawarehouse_public"} */
select
      'datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:29:38.540464 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
20:29:38.541599 [debug] [ThreadPool]: On list_datawarehouse_public: ROLLBACK
20:29:38.542053 [debug] [ThreadPool]: On list_datawarehouse_public: Close
20:29:38.545145 [debug] [MainThread]: Using postgres connection "master"
20:29:38.545351 [debug] [MainThread]: On master: BEGIN
20:29:38.545427 [debug] [MainThread]: Opening a new connection, currently in state init
20:29:38.551895 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:29:38.552490 [debug] [MainThread]: Using postgres connection "master"
20:29:38.552649 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:29:38.562659 [debug] [MainThread]: SQL status: SELECT 11 in 0.01 seconds
20:29:38.563739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8993e0e-be97-43ff-a981-92b7cbd5e166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a40401c0>]}
20:29:38.564004 [debug] [MainThread]: On master: ROLLBACK
20:29:38.564317 [debug] [MainThread]: Using postgres connection "master"
20:29:38.564420 [debug] [MainThread]: On master: BEGIN
20:29:38.565020 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:29:38.565208 [debug] [MainThread]: On master: COMMIT
20:29:38.565300 [debug] [MainThread]: Using postgres connection "master"
20:29:38.565357 [debug] [MainThread]: On master: COMMIT
20:29:38.566625 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:29:38.566752 [debug] [MainThread]: On master: Close
20:29:38.567129 [info ] [MainThread]: Concurrency: 10 threads (target='prod')
20:29:38.567296 [info ] [MainThread]: 
20:29:38.573137 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
20:29:38.573379 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
20:29:38.573678 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
20:29:38.573784 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
20:29:38.573865 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
20:29:38.575439 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
20:29:38.576640 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
20:29:38.576893 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
20:29:38.577170 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
20:29:38.577324 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
20:29:38.577399 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
20:29:38.579330 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
20:29:38.579589 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
20:29:38.579820 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
20:29:38.580118 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
20:29:38.580189 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
20:29:38.580246 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
20:29:38.581151 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
20:29:38.584084 [debug] [Thread-2  ]: finished collecting timing info
20:29:38.584912 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
20:29:38.596604 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
20:29:38.596867 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
20:29:38.597192 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
20:29:38.597329 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
20:29:38.597421 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
20:29:38.598236 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
20:29:38.598724 [debug] [Thread-1  ]: finished collecting timing info
20:29:38.598909 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
20:29:38.604345 [debug] [Thread-3  ]: finished collecting timing info
20:29:38.604631 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
20:29:38.610537 [debug] [Thread-4  ]: finished collecting timing info
20:29:38.610891 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
20:29:38.622407 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
20:29:38.625471 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
20:29:38.626918 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:38.642351 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
20:29:38.642544 [debug] [Thread-2  ]: Opening a new connection, currently in state init
20:29:38.642763 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:38.627427 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
20:29:38.643382 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
20:29:38.644568 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
20:29:38.644837 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:29:38.645052 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:38.645331 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
20:29:38.645464 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:29:38.646751 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:38.646847 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
20:29:38.646912 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:38.651716 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
20:29:38.651983 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:38.652079 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "datawarehouse"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
20:29:38.652407 [debug] [Thread-2  ]: Postgres adapter: Postgres error: cross-database references are not implemented: "erp_oltp.public.clientes"
LINE 5:  select * from "erp_oltp"."public"."clientes"
                       ^

20:29:38.652566 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: ROLLBACK
20:29:38.652990 [debug] [Thread-2  ]: finished collecting timing info
20:29:38.653126 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
20:29:38.653417 [debug] [Thread-2  ]: Database Error in model postgres_sample_source_customers (models/postgres_sample_source/postgres_sample_source_customers.sql)
  cross-database references are not implemented: "erp_oltp.public.clientes"
  LINE 5:  select * from "erp_oltp"."public"."clientes"
                         ^
  compiled SQL at target/run/first_project/models/postgres_sample_source/postgres_sample_source_customers.sql
20:29:38.653581 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
20:29:38.653832 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
20:29:38.654390 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:38.654261 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:38.654520 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "node_id": "model.first_project.stg_orders"} */

  create view "datawarehouse"."public"."stg_orders__dbt_tmp" as (
    with orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
)

select * from orders
  );
20:29:38.654124 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8993e0e-be97-43ff-a981-92b7cbd5e166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a028ca60>]}
20:29:38.654631 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "node_id": "model.first_project.stg_customers"} */

  create view "datawarehouse"."public"."stg_customers__dbt_tmp" as (
    with customers as (
   select
     codigo_cliente as customer_id,
     nome as first_name,
     sobrenome as last_name,
     codigo_regiao as region_code,
     estado as state
   from erp_oltp.public.clientes
)

select * from customers
  );
20:29:38.655065 [error] [Thread-2  ]: 2 of 7 ERROR creating view model public.postgres_sample_source_customers ....... [[31mERROR[0m in 0.08s]
20:29:38.655230 [debug] [Thread-4  ]: Postgres adapter: Postgres error: cross-database references are not implemented: "erp_oltp.public.pedidos"
LINE 9:  from erp_oltp.public.pedidos
              ^

20:29:38.657037 [debug] [Thread-4  ]: On model.first_project.stg_orders: ROLLBACK
20:29:38.656905 [debug] [Thread-3  ]: Postgres adapter: Postgres error: cross-database references are not implemented: "erp_oltp.public.clientes"
LINE 11:    from erp_oltp.public.clientes
                 ^

20:29:38.656798 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
20:29:38.657181 [debug] [Thread-3  ]: On model.first_project.stg_customers: ROLLBACK
20:29:38.657579 [debug] [Thread-4  ]: finished collecting timing info
20:29:38.658131 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
20:29:38.658438 [debug] [Thread-4  ]: Database Error in model stg_orders (models/erp/stg_orders.sql)
  cross-database references are not implemented: "erp_oltp.public.pedidos"
  LINE 9:  from erp_oltp.public.pedidos
                ^
  compiled SQL at target/run/first_project/models/erp/stg_orders.sql
20:29:38.658699 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8993e0e-be97-43ff-a981-92b7cbd5e166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a0275820>]}
20:29:38.658928 [error] [Thread-4  ]: 4 of 7 ERROR creating view model public.stg_orders ............................. [[31mERROR[0m in 0.06s]
20:29:38.659170 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
20:29:38.662303 [debug] [Thread-3  ]: finished collecting timing info
20:29:38.662560 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
20:29:38.662844 [debug] [Thread-3  ]: Database Error in model stg_customers (models/erp/stg_customers.sql)
  cross-database references are not implemented: "erp_oltp.public.clientes"
  LINE 11:    from erp_oltp.public.clientes
                   ^
  compiled SQL at target/run/first_project/models/erp/stg_customers.sql
20:29:38.663016 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8993e0e-be97-43ff-a981-92b7cbd5e166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a02753d0>]}
20:29:38.663224 [error] [Thread-3  ]: 3 of 7 ERROR creating view model public.stg_customers .......................... [[31mERROR[0m in 0.08s]
20:29:38.663433 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
20:29:38.666571 [debug] [Thread-6  ]: Began running node model.first_project.customers
20:29:38.666737 [debug] [Thread-7  ]: Began running node model.first_project.customers2
20:29:38.666881 [info ] [Thread-6  ]: 5 of 7 SKIP relation public.customers .......................................... [[33mSKIP[0m]
20:29:38.667007 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
20:29:38.667722 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:38.667474 [debug] [Thread-6  ]: Finished running node model.first_project.customers
20:29:38.667825 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "datawarehouse"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:29:38.667116 [info ] [Thread-7  ]: 6 of 7 SKIP relation public.customers2 ......................................... [[33mSKIP[0m]
20:29:38.668709 [debug] [Thread-7  ]: Finished running node model.first_project.customers2
20:29:38.669884 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
20:29:38.674532 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:38.674664 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "datawarehouse"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:29:38.674997 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:38.682031 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:29:38.682193 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:38.682268 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:29:38.683738 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:29:38.691128 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:38.691447 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "datawarehouse"."public"."my_first_dbt_model__dbt_backup" cascade
20:29:38.695597 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:29:38.697757 [debug] [Thread-1  ]: finished collecting timing info
20:29:38.697909 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
20:29:38.698258 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8993e0e-be97-43ff-a981-92b7cbd5e166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a021bc40>]}
20:29:38.698561 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.12s]
20:29:38.698958 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
20:29:38.699411 [debug] [Thread-9  ]: Began running node model.first_project.my_second_dbt_model
20:29:38.699643 [info ] [Thread-9  ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
20:29:38.700017 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
20:29:38.700095 [debug] [Thread-9  ]: Began compiling node model.first_project.my_second_dbt_model
20:29:38.700163 [debug] [Thread-9  ]: Compiling model.first_project.my_second_dbt_model
20:29:38.702654 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
20:29:38.703105 [debug] [Thread-9  ]: finished collecting timing info
20:29:38.703262 [debug] [Thread-9  ]: Began executing node model.first_project.my_second_dbt_model
20:29:38.706712 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
20:29:38.707044 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:38.707149 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: BEGIN
20:29:38.707282 [debug] [Thread-9  ]: Opening a new connection, currently in state init
20:29:38.711776 [debug] [Thread-9  ]: SQL status: BEGIN in 0.0 seconds
20:29:38.711947 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:38.712018 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "datawarehouse"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "datawarehouse"."public"."my_first_dbt_model"
where id = 1
  );
20:29:38.712975 [debug] [Thread-9  ]: SQL status: CREATE VIEW in 0.0 seconds
20:29:38.714502 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:38.714661 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "datawarehouse"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:29:38.714901 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:38.715952 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
20:29:38.716074 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:38.716254 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
20:29:38.718046 [debug] [Thread-9  ]: SQL status: COMMIT in 0.0 seconds
20:29:38.720412 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:38.720602 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "datawarehouse"."public"."my_second_dbt_model__dbt_backup" cascade
20:29:38.721594 [debug] [Thread-9  ]: SQL status: DROP VIEW in 0.0 seconds
20:29:38.722654 [debug] [Thread-9  ]: finished collecting timing info
20:29:38.722800 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: Close
20:29:38.723267 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8993e0e-be97-43ff-a981-92b7cbd5e166', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a0243ee0>]}
20:29:38.723515 [info ] [Thread-9  ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
20:29:38.723799 [debug] [Thread-9  ]: Finished running node model.first_project.my_second_dbt_model
20:29:38.727459 [debug] [MainThread]: Acquiring new postgres connection "master"
20:29:38.727611 [debug] [MainThread]: Using postgres connection "master"
20:29:38.727675 [debug] [MainThread]: On master: BEGIN
20:29:38.727737 [debug] [MainThread]: Opening a new connection, currently in state closed
20:29:38.736858 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:29:38.737121 [debug] [MainThread]: On master: COMMIT
20:29:38.737200 [debug] [MainThread]: Using postgres connection "master"
20:29:38.737268 [debug] [MainThread]: On master: COMMIT
20:29:38.737550 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:29:38.737687 [debug] [MainThread]: On master: Close
20:29:38.738099 [info ] [MainThread]: 
20:29:38.738248 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.24s.
20:29:38.738354 [debug] [MainThread]: Connection 'master' was properly closed.
20:29:38.738408 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
20:29:38.738468 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
20:29:38.738658 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
20:29:38.738734 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
20:29:38.738786 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
20:29:38.742628 [info ] [MainThread]: 
20:29:38.742905 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
20:29:38.743060 [info ] [MainThread]: 
20:29:38.743182 [error] [MainThread]: [33mDatabase Error in model postgres_sample_source_customers (models/postgres_sample_source/postgres_sample_source_customers.sql)[0m
20:29:38.743306 [error] [MainThread]:   cross-database references are not implemented: "erp_oltp.public.clientes"
20:29:38.743472 [error] [MainThread]:   LINE 5:  select * from "erp_oltp"."public"."clientes"
20:29:38.743580 [error] [MainThread]:                          ^
20:29:38.743687 [error] [MainThread]:   compiled SQL at target/run/first_project/models/postgres_sample_source/postgres_sample_source_customers.sql
20:29:38.743798 [info ] [MainThread]: 
20:29:38.743908 [error] [MainThread]: [33mDatabase Error in model stg_orders (models/erp/stg_orders.sql)[0m
20:29:38.744017 [error] [MainThread]:   cross-database references are not implemented: "erp_oltp.public.pedidos"
20:29:38.744121 [error] [MainThread]:   LINE 9:  from erp_oltp.public.pedidos
20:29:38.744226 [error] [MainThread]:                 ^
20:29:38.744383 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/stg_orders.sql
20:29:38.744499 [info ] [MainThread]: 
20:29:38.744610 [error] [MainThread]: [33mDatabase Error in model stg_customers (models/erp/stg_customers.sql)[0m
20:29:38.744719 [error] [MainThread]:   cross-database references are not implemented: "erp_oltp.public.clientes"
20:29:38.744832 [error] [MainThread]:   LINE 11:    from erp_oltp.public.clientes
20:29:38.744937 [error] [MainThread]:                    ^
20:29:38.745043 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/stg_customers.sql
20:29:38.745158 [info ] [MainThread]: 
20:29:38.745281 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=2 TOTAL=7
20:29:38.745511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a40400d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a40cac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9a3b1a190>]}


============================== 2022-06-04 20:29:48.639111 | 5b37b0d9-55d8-43ca-a68e-4e82281ce594 ==============================
20:29:48.639167 [info ] [MainThread]: Running with dbt=1.1.0
20:29:48.640041 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:29:48.640164 [debug] [MainThread]: Tracking: tracking
20:29:48.642794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d17fb8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d17fb220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d17fb970>]}
20:29:48.668154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:29:48.668390 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:29:48.677511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b37b0d9-55d8-43ca-a68e-4e82281ce594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d16b10d0>]}
20:29:48.681424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b37b0d9-55d8-43ca-a68e-4e82281ce594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d1794d90>]}
20:29:48.681681 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:29:48.681899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b37b0d9-55d8-43ca-a68e-4e82281ce594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d1794e20>]}
20:29:48.683058 [info ] [MainThread]: 
20:29:48.683525 [debug] [MainThread]: Acquiring new postgres connection "master"
20:29:48.684435 [debug] [ThreadPool]: Acquiring new postgres connection "list_datawarehouse"
20:29:48.692088 [debug] [ThreadPool]: Using postgres connection "list_datawarehouse"
20:29:48.692277 [debug] [ThreadPool]: On list_datawarehouse: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "connection_name": "list_datawarehouse"} */

    select distinct nspname from pg_namespace
  
20:29:48.692421 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:29:48.699148 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
20:29:48.700534 [debug] [ThreadPool]: On list_datawarehouse: Close
20:29:48.704745 [debug] [ThreadPool]: Acquiring new postgres connection "list_datawarehouse_public"
20:29:48.709407 [debug] [ThreadPool]: Using postgres connection "list_datawarehouse_public"
20:29:48.709566 [debug] [ThreadPool]: On list_datawarehouse_public: BEGIN
20:29:48.709631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:29:48.713650 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:29:48.713834 [debug] [ThreadPool]: Using postgres connection "list_datawarehouse_public"
20:29:48.713905 [debug] [ThreadPool]: On list_datawarehouse_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "connection_name": "list_datawarehouse_public"} */
select
      'datawarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'datawarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:29:48.715363 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
20:29:48.716515 [debug] [ThreadPool]: On list_datawarehouse_public: ROLLBACK
20:29:48.716895 [debug] [ThreadPool]: On list_datawarehouse_public: Close
20:29:48.720029 [debug] [MainThread]: Using postgres connection "master"
20:29:48.720156 [debug] [MainThread]: On master: BEGIN
20:29:48.720224 [debug] [MainThread]: Opening a new connection, currently in state init
20:29:48.726100 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:29:48.726454 [debug] [MainThread]: Using postgres connection "master"
20:29:48.726542 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:29:48.735096 [debug] [MainThread]: SQL status: SELECT 12 in 0.01 seconds
20:29:48.736495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b37b0d9-55d8-43ca-a68e-4e82281ce594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d18022e0>]}
20:29:48.736741 [debug] [MainThread]: On master: ROLLBACK
20:29:48.737043 [debug] [MainThread]: Using postgres connection "master"
20:29:48.737197 [debug] [MainThread]: On master: BEGIN
20:29:48.737759 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:29:48.737864 [debug] [MainThread]: On master: COMMIT
20:29:48.737932 [debug] [MainThread]: Using postgres connection "master"
20:29:48.737987 [debug] [MainThread]: On master: COMMIT
20:29:48.738296 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:29:48.738403 [debug] [MainThread]: On master: Close
20:29:48.739052 [info ] [MainThread]: Concurrency: 10 threads (target='prod')
20:29:48.739408 [info ] [MainThread]: 
20:29:48.745410 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
20:29:48.745678 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
20:29:48.746111 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
20:29:48.746250 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
20:29:48.746363 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
20:29:48.747923 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
20:29:48.748172 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
20:29:48.748372 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
20:29:48.748650 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
20:29:48.748888 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
20:29:48.749472 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
20:29:48.749735 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
20:29:48.749865 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
20:29:48.749975 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
20:29:48.749200 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
20:29:48.751413 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
20:29:48.748976 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
20:29:48.751989 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
20:29:48.751682 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
20:29:48.752249 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
20:29:48.793237 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
20:29:48.793395 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
20:29:48.794243 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
20:29:48.794589 [debug] [Thread-4  ]: finished collecting timing info
20:29:48.797818 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
20:29:48.797643 [debug] [Thread-3  ]: finished collecting timing info
20:29:48.797537 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
20:29:48.749052 [debug] [Thread-1  ]: finished collecting timing info
20:29:48.814942 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
20:29:48.814298 [debug] [Thread-2  ]: finished collecting timing info
20:29:48.825593 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
20:29:48.803649 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
20:29:48.814662 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
20:29:48.829471 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
20:29:48.831158 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
20:29:48.832747 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
20:29:48.833424 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:48.833618 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
20:29:48.833752 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:48.834273 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
20:29:48.834119 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:29:48.834486 [debug] [Thread-2  ]: Opening a new connection, currently in state init
20:29:48.835311 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:48.835469 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
20:29:48.835597 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:48.833884 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:48.836623 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
20:29:48.836708 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:29:48.840446 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:29:48.840592 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:48.840656 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "datawarehouse"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:29:48.841620 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
20:29:48.847357 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:48.848652 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
20:29:48.848797 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
20:29:48.849092 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:48.849523 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "node_id": "model.first_project.stg_customers"} */

  create view "datawarehouse"."public"."stg_customers__dbt_tmp" as (
    with customers as (
   select
     codigo_cliente as customer_id,
     nome as first_name,
     sobrenome as last_name,
     codigo_regiao as region_code,
     estado as state
   from erp_oltp.public.clientes
)

select * from customers
  );
20:29:48.849302 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:48.849683 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "datawarehouse"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
20:29:48.848950 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "datawarehouse"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
20:29:48.850009 [debug] [Thread-3  ]: Postgres adapter: Postgres error: cross-database references are not implemented: "erp_oltp.public.clientes"
LINE 11:    from erp_oltp.public.clientes
                 ^

20:29:48.850151 [debug] [Thread-2  ]: Postgres adapter: Postgres error: cross-database references are not implemented: "erp_oltp.public.clientes"
LINE 5:  select * from "erp_oltp"."public"."clientes"
                       ^

20:29:48.850300 [debug] [Thread-3  ]: On model.first_project.stg_customers: ROLLBACK
20:29:48.850422 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: ROLLBACK
20:29:48.850648 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:48.850954 [debug] [Thread-2  ]: finished collecting timing info
20:29:48.851227 [debug] [Thread-3  ]: finished collecting timing info
20:29:48.853356 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
20:29:48.853148 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
20:29:48.853844 [debug] [Thread-3  ]: Database Error in model stg_customers (models/erp/stg_customers.sql)
  cross-database references are not implemented: "erp_oltp.public.clientes"
  LINE 11:    from erp_oltp.public.clientes
                   ^
  compiled SQL at target/run/first_project/models/erp/stg_customers.sql
20:29:48.853465 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
20:29:48.854124 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b37b0d9-55d8-43ca-a68e-4e82281ce594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d05a82e0>]}
20:29:48.854982 [error] [Thread-3  ]: 3 of 7 ERROR creating view model public.stg_customers .......................... [[31mERROR[0m in 0.10s]
20:29:48.854438 [debug] [Thread-2  ]: Database Error in model postgres_sample_source_customers (models/postgres_sample_source/postgres_sample_source_customers.sql)
  cross-database references are not implemented: "erp_oltp.public.clientes"
  LINE 5:  select * from "erp_oltp"."public"."clientes"
                         ^
  compiled SQL at target/run/first_project/models/postgres_sample_source/postgres_sample_source_customers.sql
20:29:48.852928 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:48.855410 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
20:29:48.856047 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "datawarehouse"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:29:48.855796 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b37b0d9-55d8-43ca-a68e-4e82281ce594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d05b10a0>]}
20:29:48.857438 [error] [Thread-2  ]: 2 of 7 ERROR creating view model public.postgres_sample_source_customers ....... [[31mERROR[0m in 0.11s]
20:29:48.856877 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:48.854665 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:48.863788 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "node_id": "model.first_project.stg_orders"} */

  create view "datawarehouse"."public"."stg_orders__dbt_tmp" as (
    with orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
)

select * from orders
  );
20:29:48.858436 [debug] [Thread-6  ]: Began running node model.first_project.customers2
20:29:48.866596 [info ] [Thread-6  ]: 5 of 7 SKIP relation public.customers2 ......................................... [[33mSKIP[0m]
20:29:48.865775 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:29:48.858137 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
20:29:48.866964 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
20:29:48.867037 [debug] [Thread-4  ]: Postgres adapter: Postgres error: cross-database references are not implemented: "erp_oltp.public.pedidos"
LINE 9:  from erp_oltp.public.pedidos
              ^

20:29:48.867162 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:48.867459 [debug] [Thread-4  ]: On model.first_project.stg_orders: ROLLBACK
20:29:48.867691 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:29:48.868066 [debug] [Thread-4  ]: finished collecting timing info
20:29:48.868276 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
20:29:48.868662 [debug] [Thread-4  ]: Database Error in model stg_orders (models/erp/stg_orders.sql)
  cross-database references are not implemented: "erp_oltp.public.pedidos"
  LINE 9:  from erp_oltp.public.pedidos
                ^
  compiled SQL at target/run/first_project/models/erp/stg_orders.sql
20:29:48.868877 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b37b0d9-55d8-43ca-a68e-4e82281ce594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d05c6e50>]}
20:29:48.869219 [error] [Thread-4  ]: 4 of 7 ERROR creating view model public.stg_orders ............................. [[31mERROR[0m in 0.12s]
20:29:48.869442 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
20:29:48.869983 [debug] [Thread-8  ]: Began running node model.first_project.customers
20:29:48.870160 [info ] [Thread-8  ]: 6 of 7 SKIP relation public.customers .......................................... [[33mSKIP[0m]
20:29:48.870346 [debug] [Thread-8  ]: Finished running node model.first_project.customers
20:29:48.870597 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:29:48.873824 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:48.873950 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "datawarehouse"."public"."my_first_dbt_model__dbt_backup" cascade
20:29:48.876795 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
20:29:48.877673 [debug] [Thread-1  ]: finished collecting timing info
20:29:48.877810 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
20:29:48.878856 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b37b0d9-55d8-43ca-a68e-4e82281ce594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d17941f0>]}
20:29:48.879371 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.13s]
20:29:48.879733 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
20:29:48.881480 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
20:29:48.881700 [info ] [Thread-10 ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
20:29:48.882010 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
20:29:48.882094 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
20:29:48.882231 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
20:29:48.884135 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
20:29:48.884576 [debug] [Thread-10 ]: finished collecting timing info
20:29:48.884829 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
20:29:48.887785 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
20:29:48.888106 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:48.888265 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: BEGIN
20:29:48.888325 [debug] [Thread-10 ]: Opening a new connection, currently in state init
20:29:48.893834 [debug] [Thread-10 ]: SQL status: BEGIN in 0.01 seconds
20:29:48.894173 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:48.894261 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "datawarehouse"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "datawarehouse"."public"."my_first_dbt_model"
where id = 1
  );
20:29:48.895482 [debug] [Thread-10 ]: SQL status: CREATE VIEW in 0.0 seconds
20:29:48.898009 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:48.898126 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "datawarehouse"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:29:48.898602 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:48.899489 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
20:29:48.899615 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:48.899794 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
20:29:48.901680 [debug] [Thread-10 ]: SQL status: COMMIT in 0.0 seconds
20:29:48.903034 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:48.903120 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "prod", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "datawarehouse"."public"."my_second_dbt_model__dbt_backup" cascade
20:29:48.903353 [debug] [Thread-10 ]: SQL status: DROP VIEW in 0.0 seconds
20:29:48.904159 [debug] [Thread-10 ]: finished collecting timing info
20:29:48.904263 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: Close
20:29:48.904752 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b37b0d9-55d8-43ca-a68e-4e82281ce594', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d05bf520>]}
20:29:48.905079 [info ] [Thread-10 ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
20:29:48.905465 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
20:29:48.908227 [debug] [MainThread]: Acquiring new postgres connection "master"
20:29:48.908367 [debug] [MainThread]: Using postgres connection "master"
20:29:48.908436 [debug] [MainThread]: On master: BEGIN
20:29:48.908537 [debug] [MainThread]: Opening a new connection, currently in state closed
20:29:48.917947 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:29:48.918283 [debug] [MainThread]: On master: COMMIT
20:29:48.918366 [debug] [MainThread]: Using postgres connection "master"
20:29:48.918433 [debug] [MainThread]: On master: COMMIT
20:29:48.918922 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:29:48.919076 [debug] [MainThread]: On master: Close
20:29:48.919546 [info ] [MainThread]: 
20:29:48.919690 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.24s.
20:29:48.919789 [debug] [MainThread]: Connection 'master' was properly closed.
20:29:48.919838 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
20:29:48.919886 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
20:29:48.919932 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
20:29:48.919978 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
20:29:48.920025 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
20:29:48.924615 [info ] [MainThread]: 
20:29:48.924923 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
20:29:48.925140 [info ] [MainThread]: 
20:29:48.925280 [error] [MainThread]: [33mDatabase Error in model stg_customers (models/erp/stg_customers.sql)[0m
20:29:48.925395 [error] [MainThread]:   cross-database references are not implemented: "erp_oltp.public.clientes"
20:29:48.925534 [error] [MainThread]:   LINE 11:    from erp_oltp.public.clientes
20:29:48.925634 [error] [MainThread]:                    ^
20:29:48.925726 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/stg_customers.sql
20:29:48.925811 [info ] [MainThread]: 
20:29:48.925903 [error] [MainThread]: [33mDatabase Error in model postgres_sample_source_customers (models/postgres_sample_source/postgres_sample_source_customers.sql)[0m
20:29:48.926005 [error] [MainThread]:   cross-database references are not implemented: "erp_oltp.public.clientes"
20:29:48.926136 [error] [MainThread]:   LINE 5:  select * from "erp_oltp"."public"."clientes"
20:29:48.926263 [error] [MainThread]:                          ^
20:29:48.926423 [error] [MainThread]:   compiled SQL at target/run/first_project/models/postgres_sample_source/postgres_sample_source_customers.sql
20:29:48.926575 [info ] [MainThread]: 
20:29:48.926690 [error] [MainThread]: [33mDatabase Error in model stg_orders (models/erp/stg_orders.sql)[0m
20:29:48.926798 [error] [MainThread]:   cross-database references are not implemented: "erp_oltp.public.pedidos"
20:29:48.926899 [error] [MainThread]:   LINE 9:  from erp_oltp.public.pedidos
20:29:48.927046 [error] [MainThread]:                 ^
20:29:48.927149 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/stg_orders.sql
20:29:48.927266 [info ] [MainThread]: 
20:29:48.927379 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=2 TOTAL=7
20:29:48.927590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d165fa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d165f7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f12d05e76d0>]}


============================== 2022-06-04 20:30:19.948284 | b62a62db-5d9b-43e7-8be3-d59dc5d22285 ==============================
20:30:19.948299 [info ] [MainThread]: Running with dbt=1.1.0
20:30:19.948694 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:30:19.948778 [debug] [MainThread]: Tracking: tracking
20:30:19.951676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edf2574f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edf257370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edf257040>]}
20:30:19.964582 [info ] [MainThread]: Unable to do partial parsing because profile has changed
20:30:19.964833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b62a62db-5d9b-43e7-8be3-d59dc5d22285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ee0a73130>]}
20:30:19.975121 [debug] [MainThread]: Parsing macros/catalog.sql
20:30:19.978343 [debug] [MainThread]: Parsing macros/relations.sql
20:30:19.979419 [debug] [MainThread]: Parsing macros/adapters.sql
20:30:20.006871 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
20:30:20.008156 [debug] [MainThread]: Parsing macros/materializations/configs.sql
20:30:20.009479 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
20:30:20.011910 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
20:30:20.017911 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
20:30:20.027183 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
20:30:20.037289 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
20:30:20.040706 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
20:30:20.041836 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
20:30:20.042715 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
20:30:20.044192 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
20:30:20.045750 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
20:30:20.049779 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
20:30:20.055044 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
20:30:20.056955 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
20:30:20.066931 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
20:30:20.071634 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
20:30:20.072998 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
20:30:20.075679 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
20:30:20.076756 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
20:30:20.084610 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
20:30:20.094923 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
20:30:20.101396 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
20:30:20.102708 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
20:30:20.104664 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
20:30:20.105869 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
20:30:20.106810 [debug] [MainThread]: Parsing macros/adapters/columns.sql
20:30:20.112551 [debug] [MainThread]: Parsing macros/adapters/relation.sql
20:30:20.118098 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
20:30:20.120020 [debug] [MainThread]: Parsing macros/adapters/schema.sql
20:30:20.121439 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
20:30:20.123187 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
20:30:20.127355 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
20:30:20.129973 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
20:30:20.130643 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
20:30:20.131140 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
20:30:20.131665 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
20:30:20.132611 [debug] [MainThread]: Parsing macros/etc/datetime.sql
20:30:20.137661 [debug] [MainThread]: Parsing macros/etc/statement.sql
20:30:20.140525 [debug] [MainThread]: Parsing tests/generic/builtin.sql
20:30:20.298097 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers2.sql
20:30:20.307073 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
20:30:20.308694 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
20:30:20.310578 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
20:30:20.312060 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
20:30:20.313763 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
20:30:20.315093 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
20:30:20.391086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b62a62db-5d9b-43e7-8be3-d59dc5d22285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edf1e00d0>]}
20:30:20.394686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b62a62db-5d9b-43e7-8be3-d59dc5d22285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edf2575b0>]}
20:30:20.395021 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:30:20.395179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b62a62db-5d9b-43e7-8be3-d59dc5d22285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edf1d3f10>]}
20:30:20.396170 [info ] [MainThread]: 
20:30:20.396450 [debug] [MainThread]: Acquiring new postgres connection "master"
20:30:20.397361 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
20:30:20.404392 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
20:30:20.404700 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
20:30:20.404818 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:30:20.423297 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.02 seconds
20:30:20.424401 [debug] [ThreadPool]: On list_erp_oltp: Close
20:30:20.427641 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
20:30:20.431170 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:30:20.431298 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
20:30:20.431487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:30:20.441629 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:30:20.441901 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:30:20.441978 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:30:20.450580 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.01 seconds
20:30:20.451636 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
20:30:20.451910 [debug] [ThreadPool]: On list_erp_oltp_public: Close
20:30:20.456665 [debug] [MainThread]: Using postgres connection "master"
20:30:20.456892 [debug] [MainThread]: On master: BEGIN
20:30:20.457007 [debug] [MainThread]: Opening a new connection, currently in state init
20:30:20.462515 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:30:20.462766 [debug] [MainThread]: Using postgres connection "master"
20:30:20.462862 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:30:20.481774 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
20:30:20.483109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b62a62db-5d9b-43e7-8be3-d59dc5d22285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edf1e01c0>]}
20:30:20.483421 [debug] [MainThread]: On master: ROLLBACK
20:30:20.483774 [debug] [MainThread]: Using postgres connection "master"
20:30:20.483887 [debug] [MainThread]: On master: BEGIN
20:30:20.484405 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:30:20.484512 [debug] [MainThread]: On master: COMMIT
20:30:20.484627 [debug] [MainThread]: Using postgres connection "master"
20:30:20.484691 [debug] [MainThread]: On master: COMMIT
20:30:20.484964 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:30:20.485171 [debug] [MainThread]: On master: Close
20:30:20.485510 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:30:20.487140 [info ] [MainThread]: 
20:30:20.493015 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
20:30:20.493314 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
20:30:20.493618 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
20:30:20.493711 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
20:30:20.493809 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
20:30:20.495995 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
20:30:20.496428 [debug] [Thread-1  ]: finished collecting timing info
20:30:20.496717 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
20:30:20.497079 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
20:30:20.497599 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
20:30:20.497985 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
20:30:20.498078 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
20:30:20.498175 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
20:30:20.497368 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
20:30:20.499607 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
20:30:20.497154 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
20:30:20.500688 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
20:30:20.500238 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
20:30:20.501044 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
20:30:20.501504 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
20:30:20.501284 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
20:30:20.496978 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
20:30:20.501644 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
20:30:20.501833 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
20:30:20.501970 [debug] [Thread-3  ]: finished collecting timing info
20:30:20.514161 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
20:30:20.508561 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
20:30:20.513823 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
20:30:20.523106 [debug] [Thread-4  ]: finished collecting timing info
20:30:20.523344 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
20:30:20.541973 [debug] [Thread-2  ]: finished collecting timing info
20:30:20.542285 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
20:30:20.555952 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
20:30:20.556411 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:30:20.556623 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
20:30:20.556696 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:30:20.567159 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
20:30:20.567946 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
20:30:20.569116 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:30:20.569560 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
20:30:20.569329 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:30:20.569751 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:30:20.570005 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:30:20.571076 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:30:20.570228 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
20:30:20.571258 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:30:20.568603 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
20:30:20.571498 [debug] [Thread-2  ]: Opening a new connection, currently in state init
20:30:20.572593 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:30:20.572720 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
20:30:20.572801 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:30:20.579116 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
20:30:20.579408 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:30:20.579521 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
)

select * from orders
  );
20:30:20.581217 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
20:30:20.581537 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:30:20.581706 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
20:30:20.582886 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
20:30:20.583146 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:30:20.583223 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
   select
     codigo_cliente as customer_id,
     nome as first_name,
     sobrenome as last_name,
     codigo_regiao as region_code,
     estado as state
   from erp_oltp.public.clientes
)

select * from customers
  );
20:30:20.587160 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.02 seconds
20:30:20.592706 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:30:20.592856 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
20:30:20.594458 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:30:20.594615 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
20:30:20.593034 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
20:30:20.594695 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
20:30:20.596545 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:30:20.596905 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
20:30:20.596654 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:30:20.592921 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
20:30:20.597003 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
20:30:20.601907 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:30:20.599806 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:30:20.602197 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
20:30:20.602068 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
20:30:20.598245 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:30:20.599909 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
20:30:20.602426 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:30:20.602703 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
20:30:20.604399 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:30:20.611398 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
20:30:20.611928 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:30:20.611676 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
20:30:20.613521 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:30:20.613618 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
20:30:20.612018 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
20:30:20.611571 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
20:30:20.611773 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
20:30:20.614715 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
20:30:20.621216 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
20:30:20.619843 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:30:20.621475 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:30:20.614858 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
20:30:20.621326 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:30:20.621577 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:30:20.621674 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
20:30:20.622685 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
20:30:20.627605 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:30:20.627365 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:30:20.627797 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
20:30:20.622797 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
20:30:20.627703 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
20:30:20.627521 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:30:20.629565 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:30:20.629660 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
20:30:20.630264 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
20:30:20.631552 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:30:20.632121 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
20:30:20.631922 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
20:30:20.634106 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:30:20.634234 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
20:30:20.639078 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
20:30:20.640343 [debug] [Thread-2  ]: finished collecting timing info
20:30:20.640563 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
20:30:20.640741 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
20:30:20.640920 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.01 seconds
20:30:20.642827 [debug] [Thread-4  ]: finished collecting timing info
20:30:20.643393 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
20:30:20.642989 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
20:30:20.644097 [debug] [Thread-3  ]: finished collecting timing info
20:30:20.644222 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
20:30:20.643282 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b62a62db-5d9b-43e7-8be3-d59dc5d22285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edc43fee0>]}
20:30:20.644900 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.14s]
20:30:20.645246 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
20:30:20.644510 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b62a62db-5d9b-43e7-8be3-d59dc5d22285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edc4672e0>]}
20:30:20.642043 [debug] [Thread-1  ]: finished collecting timing info
20:30:20.645494 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.15s]
20:30:20.647237 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
20:30:20.646836 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b62a62db-5d9b-43e7-8be3-d59dc5d22285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edc36f3a0>]}
20:30:20.646943 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
20:30:20.647447 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.15s]
20:30:20.648248 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
20:30:20.647721 [debug] [Thread-6  ]: Began running node model.first_project.customers2
20:30:20.649501 [info ] [Thread-6  ]: 5 of 7 START table model public.customers2 ..................................... [RUN]
20:30:20.649887 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
20:30:20.649997 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
20:30:20.650315 [debug] [Thread-6  ]: Compiling model.first_project.customers2
20:30:20.652383 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
20:30:20.652880 [debug] [Thread-6  ]: finished collecting timing info
20:30:20.653084 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
20:30:20.650214 [debug] [Thread-8  ]: Began running node model.first_project.customers
20:30:20.655239 [info ] [Thread-8  ]: 6 of 7 START view model public.customers ....................................... [RUN]
20:30:20.656698 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
20:30:20.656815 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
20:30:20.656884 [debug] [Thread-8  ]: Compiling model.first_project.customers
20:30:20.655549 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b62a62db-5d9b-43e7-8be3-d59dc5d22285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edec8eeb0>]}
20:30:20.661776 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
20:30:20.663229 [debug] [Thread-8  ]: finished collecting timing info
20:30:20.662716 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.16s]
20:30:20.663374 [debug] [Thread-8  ]: Began executing node model.first_project.customers
20:30:20.665101 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
20:30:20.655061 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
20:30:20.665369 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
20:30:20.666651 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:30:20.667030 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
20:30:20.667134 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
20:30:20.667432 [info ] [Thread-10 ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
20:30:20.667684 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
20:30:20.667764 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
20:30:20.667833 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
20:30:20.669221 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
20:30:20.669624 [debug] [Thread-10 ]: finished collecting timing info
20:30:20.669766 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
20:30:20.671883 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
20:30:20.672305 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:30:20.672420 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: BEGIN
20:30:20.672489 [debug] [Thread-10 ]: Opening a new connection, currently in state init
20:30:20.667275 [debug] [Thread-8  ]: Opening a new connection, currently in state init
20:30:20.681539 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
20:30:20.681787 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
20:30:20.682305 [debug] [Thread-6  ]: Opening a new connection, currently in state init
20:30:20.687250 [debug] [Thread-10 ]: SQL status: BEGIN in 0.01 seconds
20:30:20.687688 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
20:30:20.688010 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:30:20.688140 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
20:30:20.688256 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
20:30:20.688359 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
20:30:20.690818 [debug] [Thread-10 ]: SQL status: CREATE VIEW in 0.0 seconds
20:30:20.694216 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:30:20.694341 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:30:20.699981 [debug] [Thread-8  ]: SQL status: BEGIN in 0.03 seconds
20:30:20.701122 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:30:20.701304 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
  WHERE customer_id != 63
)

select * from final
  );
20:30:20.701692 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
20:30:20.703832 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
20:30:20.704603 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.02 seconds
20:30:20.707296 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
20:30:20.707762 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
20:30:20.708001 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.01 seconds
20:30:20.704773 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:30:20.709325 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:30:20.709445 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
20:30:20.709557 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
20:30:20.709657 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
20:30:20.711047 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
20:30:20.711345 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
20:30:20.711590 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
20:30:20.712772 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
20:30:20.712888 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
20:30:20.713008 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
20:30:20.713155 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
20:30:20.714131 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
20:30:20.714220 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:30:20.714281 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
20:30:20.714510 [debug] [Thread-10 ]: SQL status: COMMIT in 0.0 seconds
20:30:20.716737 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:30:20.716896 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
20:30:20.716994 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
20:30:20.718201 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
20:30:20.718300 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
20:30:20.718373 [debug] [Thread-8  ]: SQL status: COMMIT in 0.0 seconds
20:30:20.719574 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:30:20.719755 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
20:30:20.720051 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
20:30:20.721127 [debug] [Thread-8  ]: finished collecting timing info
20:30:20.721284 [debug] [Thread-8  ]: On model.first_project.customers: Close
20:30:20.721416 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
20:30:20.722371 [debug] [Thread-6  ]: finished collecting timing info
20:30:20.722519 [debug] [Thread-6  ]: On model.first_project.customers2: Close
20:30:20.723187 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b62a62db-5d9b-43e7-8be3-d59dc5d22285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edc334e80>]}
20:30:20.723437 [info ] [Thread-8  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.07s]
20:30:20.723777 [debug] [Thread-8  ]: Finished running node model.first_project.customers
20:30:20.718477 [debug] [Thread-10 ]: SQL status: DROP VIEW in 0.0 seconds
20:30:20.724726 [debug] [Thread-10 ]: finished collecting timing info
20:30:20.724842 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: Close
20:30:20.725079 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b62a62db-5d9b-43e7-8be3-d59dc5d22285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edec8e5e0>]}
20:30:20.725341 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.08s]
20:30:20.725607 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
20:30:20.726768 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b62a62db-5d9b-43e7-8be3-d59dc5d22285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edc43ff10>]}
20:30:20.727002 [info ] [Thread-10 ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
20:30:20.727235 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
20:30:20.728818 [debug] [MainThread]: Acquiring new postgres connection "master"
20:30:20.728939 [debug] [MainThread]: Using postgres connection "master"
20:30:20.729003 [debug] [MainThread]: On master: BEGIN
20:30:20.729059 [debug] [MainThread]: Opening a new connection, currently in state closed
20:30:20.733329 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:30:20.733556 [debug] [MainThread]: On master: COMMIT
20:30:20.733630 [debug] [MainThread]: Using postgres connection "master"
20:30:20.733688 [debug] [MainThread]: On master: COMMIT
20:30:20.733850 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:30:20.733956 [debug] [MainThread]: On master: Close
20:30:20.735674 [info ] [MainThread]: 
20:30:20.735888 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.34s.
20:30:20.736028 [debug] [MainThread]: Connection 'master' was properly closed.
20:30:20.736192 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
20:30:20.736348 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
20:30:20.736453 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
20:30:20.736513 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
20:30:20.741778 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
20:30:20.741892 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
20:30:20.741955 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
20:30:20.747077 [info ] [MainThread]: 
20:30:20.747565 [info ] [MainThread]: [32mCompleted successfully[0m
20:30:20.747751 [info ] [MainThread]: 
20:30:20.747886 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
20:30:20.748151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edf1cc490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edec99880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3edf1e00d0>]}


============================== 2022-06-04 20:31:17.387723 | 1b6ff498-4571-4d93-88a6-e629bb65234d ==============================
20:31:17.387736 [info ] [MainThread]: Running with dbt=1.1.0
20:31:17.388212 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
20:31:17.388317 [debug] [MainThread]: Tracking: tracking
20:31:17.391564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8e3368b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8e336220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8e336970>]}
20:31:17.416809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:31:17.417171 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:31:17.421401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b6ff498-4571-4d93-88a6-e629bb65234d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8e1eb0d0>]}
20:31:17.431878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b6ff498-4571-4d93-88a6-e629bb65234d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8e2cad90>]}
20:31:17.432236 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:31:17.432427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b6ff498-4571-4d93-88a6-e629bb65234d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8e2cae20>]}
20:31:17.433705 [info ] [MainThread]: 
20:31:17.434092 [debug] [MainThread]: Acquiring new postgres connection "master"
20:31:17.434776 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
20:31:17.441738 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
20:31:17.441868 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
20:31:17.441943 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:31:17.450848 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
20:31:17.452024 [debug] [ThreadPool]: On list_erp_oltp: Close
20:31:17.456214 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
20:31:17.460622 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:31:17.460787 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
20:31:17.460862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:31:17.466627 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:31:17.466859 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:31:17.466936 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:31:17.468598 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
20:31:17.469861 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
20:31:17.470229 [debug] [ThreadPool]: On list_erp_oltp_public: Close
20:31:17.473701 [debug] [MainThread]: Using postgres connection "master"
20:31:17.473819 [debug] [MainThread]: On master: BEGIN
20:31:17.473892 [debug] [MainThread]: Opening a new connection, currently in state init
20:31:17.478196 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:31:17.478628 [debug] [MainThread]: Using postgres connection "master"
20:31:17.478718 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:31:17.490166 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
20:31:17.491377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b6ff498-4571-4d93-88a6-e629bb65234d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8fb0f700>]}
20:31:17.491610 [debug] [MainThread]: On master: ROLLBACK
20:31:17.491889 [debug] [MainThread]: Using postgres connection "master"
20:31:17.492049 [debug] [MainThread]: On master: BEGIN
20:31:17.492370 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:31:17.492480 [debug] [MainThread]: On master: COMMIT
20:31:17.492550 [debug] [MainThread]: Using postgres connection "master"
20:31:17.492610 [debug] [MainThread]: On master: COMMIT
20:31:17.492759 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:31:17.492858 [debug] [MainThread]: On master: Close
20:31:17.493164 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:31:17.493379 [info ] [MainThread]: 
20:31:17.498442 [debug] [Thread-1  ]: Began running node seed.first_project.code-country
20:31:17.498746 [info ] [Thread-1  ]: 1 of 1 START seed file public.code-country ..................................... [RUN]
20:31:17.499269 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.first_project.code-country"
20:31:17.499419 [debug] [Thread-1  ]: Began compiling node seed.first_project.code-country
20:31:17.499513 [debug] [Thread-1  ]: finished collecting timing info
20:31:17.499590 [debug] [Thread-1  ]: Began executing node seed.first_project.code-country
20:31:17.564685 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:31:17.564811 [debug] [Thread-1  ]: On seed.first_project.code-country: BEGIN
20:31:17.564878 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:31:17.570934 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:31:17.571112 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:31:17.571186 [debug] [Thread-1  ]: On seed.first_project.code-country: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "seed.first_project.code-country"} */

    create table "erp_oltp"."public"."code-country" ("Name" text,"Code" text)
  
20:31:17.580313 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.01 seconds
20:31:17.683098 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:31:17.683289 [debug] [Thread-1  ]: On seed.first_project.code-country: 
          insert into "erp_oltp"."public"."code-country" ("Name", "Code") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,...
20:31:17.684866 [debug] [Thread-1  ]: SQL status: INSERT 0 249 in 0.0 seconds
20:31:17.687323 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.first_project.code-country"
20:31:17.693985 [debug] [Thread-1  ]: On seed.first_project.code-country: COMMIT
20:31:17.694122 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:31:17.694188 [debug] [Thread-1  ]: On seed.first_project.code-country: COMMIT
20:31:17.697122 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
20:31:17.697732 [debug] [Thread-1  ]: finished collecting timing info
20:31:17.697861 [debug] [Thread-1  ]: On seed.first_project.code-country: Close
20:31:17.698244 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b6ff498-4571-4d93-88a6-e629bb65234d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8c138a00>]}
20:31:17.698503 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.code-country ................................. [[32mINSERT 249[0m in 0.20s]
20:31:17.698952 [debug] [Thread-1  ]: Finished running node seed.first_project.code-country
20:31:17.700417 [debug] [MainThread]: Acquiring new postgres connection "master"
20:31:17.700683 [debug] [MainThread]: Using postgres connection "master"
20:31:17.700782 [debug] [MainThread]: On master: BEGIN
20:31:17.700844 [debug] [MainThread]: Opening a new connection, currently in state closed
20:31:17.705507 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:31:17.705659 [debug] [MainThread]: On master: COMMIT
20:31:17.705725 [debug] [MainThread]: Using postgres connection "master"
20:31:17.705782 [debug] [MainThread]: On master: COMMIT
20:31:17.705905 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:31:17.706026 [debug] [MainThread]: On master: Close
20:31:17.706314 [info ] [MainThread]: 
20:31:17.706460 [info ] [MainThread]: Finished running 1 seed in 0.27s.
20:31:17.706617 [debug] [MainThread]: Connection 'master' was properly closed.
20:31:17.706670 [debug] [MainThread]: Connection 'seed.first_project.code-country' was properly closed.
20:31:17.710020 [info ] [MainThread]: 
20:31:17.710348 [info ] [MainThread]: [32mCompleted successfully[0m
20:31:17.710665 [info ] [MainThread]: 
20:31:17.710909 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
20:31:17.711162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8e190e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8e190c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b8e169880>]}


============================== 2022-06-04 20:43:41.291027 | 68afe314-5229-41ba-87f8-71ac6565aba5 ==============================
20:43:41.291036 [info ] [MainThread]: Running with dbt=1.1.0
20:43:41.291314 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'est', 'project_name': 'redshit', 'skip_profile_setup': False, 'which': 'init', 'indirect_selection': 'eager'}
20:43:41.291390 [debug] [MainThread]: Tracking: tracking
20:43:41.295020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba3feb3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba3febfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba3feb430>]}
20:43:41.296153 [info ] [MainThread]: Setting up your profile.
20:44:51.291529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba3feb220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba3febfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcba3fd7730>]}


============================== 2022-06-06 22:25:16.120861 | a88e7e55-9ed7-4cff-9927-6bc28306548c ==============================
22:25:16.120874 [info ] [MainThread]: Running with dbt=1.1.0
22:25:16.121718 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
22:25:16.121819 [debug] [MainThread]: Tracking: tracking
22:25:16.124765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de0ade3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de0adefd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2de0ade220>]}
22:25:16.198582 [debug] [MainThread]: Executing "git --help"
22:25:16.201969 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
22:25:16.202251 [debug] [MainThread]: STDERR: "b''"
22:25:16.205821 [debug] [MainThread]: Acquiring new postgres connection "debug"
22:25:16.206290 [debug] [MainThread]: Using postgres connection "debug"
22:25:16.206519 [debug] [MainThread]: On debug: select 1 as id
22:25:16.206642 [debug] [MainThread]: Opening a new connection, currently in state init
22:25:16.239495 [debug] [MainThread]: SQL status: SELECT 1 in 0.03 seconds
22:25:16.240858 [debug] [MainThread]: On debug: Close
22:25:16.241750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ddf269eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ddf253670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ddf2537f0>]}
22:25:17.096472 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-06 22:50:36.300233 | 1773a609-5e1d-4107-87e4-506786ef87a7 ==============================
22:50:36.300249 [info ] [MainThread]: Running with dbt=1.1.0
22:50:36.300731 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
22:50:36.300850 [debug] [MainThread]: Tracking: tracking
22:50:36.303315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d5844730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d5844e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d58446a0>]}
22:50:36.347627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
22:50:36.348153 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
22:50:36.355769 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
22:50:36.418463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1773a609-5e1d-4107-87e4-506786ef87a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d70c2d30>]}
22:50:36.421900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1773a609-5e1d-4107-87e4-506786ef87a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d57d7e50>]}
22:50:36.422140 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
22:50:36.422284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1773a609-5e1d-4107-87e4-506786ef87a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d57d7ee0>]}
22:50:36.423333 [info ] [MainThread]: 
22:50:36.423613 [debug] [MainThread]: Acquiring new postgres connection "master"
22:50:36.424406 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
22:50:36.431239 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:50:36.431412 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
22:50:36.431485 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:50:36.437039 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:50:36.437228 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:50:36.437309 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
22:50:36.465181 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.03 seconds
22:50:36.466519 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
22:50:36.466835 [debug] [ThreadPool]: On list_erp_oltp_public: Close
22:50:36.470207 [debug] [MainThread]: Using postgres connection "master"
22:50:36.470353 [debug] [MainThread]: On master: BEGIN
22:50:36.470480 [debug] [MainThread]: Opening a new connection, currently in state init
22:50:36.474781 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
22:50:36.474906 [debug] [MainThread]: Using postgres connection "master"
22:50:36.474972 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:50:36.491213 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
22:50:36.492346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1773a609-5e1d-4107-87e4-506786ef87a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d57d7b50>]}
22:50:36.492582 [debug] [MainThread]: On master: ROLLBACK
22:50:36.492798 [debug] [MainThread]: On master: Close
22:50:36.493221 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
22:50:36.493440 [info ] [MainThread]: 
22:50:36.499688 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
22:50:36.500102 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
22:50:36.500231 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
22:50:36.500323 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
22:50:36.501931 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
22:50:36.502207 [debug] [Thread-1  ]: finished collecting timing info
22:50:36.502393 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
22:50:36.502500 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
22:50:36.503028 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
22:50:36.503115 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
22:50:36.503188 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
22:50:36.504694 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
22:50:36.504911 [debug] [Thread-2  ]: finished collecting timing info
22:50:36.502573 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
22:50:36.506016 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
22:50:36.506115 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
22:50:36.506184 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
22:50:36.502722 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
22:50:36.507186 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
22:50:36.507278 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
22:50:36.507356 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
22:50:36.506916 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
22:50:36.508445 [debug] [Thread-3  ]: finished collecting timing info
22:50:36.508602 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
22:50:36.508688 [debug] [Thread-3  ]: finished collecting timing info
22:50:36.508092 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
22:50:36.508908 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
22:50:36.502647 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
22:50:36.509693 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
22:50:36.509790 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
22:50:36.509028 [debug] [Thread-5  ]: finished collecting timing info
22:50:36.509866 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
22:50:36.511785 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
22:50:36.512007 [debug] [Thread-4  ]: finished collecting timing info
22:50:36.512111 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
22:50:36.512236 [debug] [Thread-4  ]: finished collecting timing info
22:50:36.510079 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
22:50:36.510438 [debug] [Thread-7  ]: Began running node model.first_project.customers2
22:50:36.516272 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers2"
22:50:36.516417 [debug] [Thread-7  ]: Began compiling node model.first_project.customers2
22:50:36.516499 [debug] [Thread-7  ]: Compiling model.first_project.customers2
22:50:36.515804 [debug] [Thread-5  ]: finished collecting timing info
22:50:36.518553 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers2"
22:50:36.505012 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
22:50:36.519336 [debug] [Thread-2  ]: finished collecting timing info
22:50:36.519665 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
22:50:36.518999 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
22:50:36.512519 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
22:50:36.502823 [debug] [Thread-1  ]: finished collecting timing info
22:50:36.520159 [debug] [Thread-7  ]: finished collecting timing info
22:50:36.520892 [debug] [Thread-7  ]: Began executing node model.first_project.customers2
22:50:36.520785 [debug] [Thread-9  ]: Began running node model.first_project.customers
22:50:36.521184 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers"
22:50:36.521279 [debug] [Thread-9  ]: Began compiling node model.first_project.customers
22:50:36.521341 [debug] [Thread-9  ]: Compiling model.first_project.customers
22:50:36.520443 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
22:50:36.522989 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers"
22:50:36.523906 [debug] [Thread-9  ]: finished collecting timing info
22:50:36.523393 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
22:50:36.524349 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
22:50:36.523607 [debug] [Thread-8  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:50:36.524081 [debug] [Thread-9  ]: Began executing node model.first_project.customers
22:50:36.524443 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
22:50:36.524977 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
22:50:36.523495 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:50:36.527513 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:50:36.527684 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:50:36.527808 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:50:36.527002 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
22:50:36.524658 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:50:36.533277 [debug] [Thread-8  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:50:36.533412 [debug] [Thread-8  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
22:50:36.536997 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:50:36.524856 [debug] [Thread-9  ]: finished collecting timing info
22:50:36.520982 [debug] [Thread-7  ]: finished collecting timing info
22:50:36.539567 [debug] [Thread-7  ]: Finished running node model.first_project.customers2
22:50:36.537317 [debug] [Thread-8  ]: finished collecting timing info
22:50:36.538774 [debug] [Thread-9  ]: Finished running node model.first_project.customers
22:50:36.538077 [debug] [Thread-6  ]: finished collecting timing info
22:50:36.539921 [debug] [Thread-8  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:50:36.540202 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
22:50:36.543130 [debug] [Thread-6  ]: finished collecting timing info
22:50:36.542826 [debug] [Thread-8  ]: finished collecting timing info
22:50:36.543580 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
22:50:36.542539 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:50:36.544052 [debug] [Thread-5  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:50:36.545480 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
22:50:36.544676 [debug] [Thread-4  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:50:36.546067 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
22:50:36.545610 [debug] [Thread-5  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:50:36.544441 [debug] [Thread-8  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:50:36.545831 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:50:36.547254 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:50:36.547377 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:50:36.546302 [debug] [Thread-5  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:50:36.546541 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:50:36.547522 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:50:36.544799 [debug] [Thread-10 ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:50:36.546162 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:50:36.557053 [debug] [Thread-4  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
22:50:36.553363 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:50:36.546783 [debug] [Thread-3  ]: finished collecting timing info
22:50:36.556156 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:50:36.556590 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:50:36.560176 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
22:50:36.560559 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:50:36.562039 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:50:36.560910 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:50:36.561286 [debug] [Thread-10 ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:50:36.561693 [debug] [Thread-2  ]: finished collecting timing info
22:50:36.566453 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:50:36.565350 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:50:36.565789 [debug] [Thread-4  ]: finished collecting timing info
22:50:36.566853 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:50:36.566234 [debug] [Thread-10 ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:50:36.566560 [debug] [Thread-2  ]: finished collecting timing info
22:50:36.573366 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:50:36.567022 [debug] [Thread-4  ]: finished collecting timing info
22:50:36.573749 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
22:50:36.572854 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:50:36.552996 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
22:50:36.566048 [debug] [Thread-3  ]: finished collecting timing info
22:50:36.575014 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:50:36.574414 [debug] [Thread-10 ]: finished collecting timing info
22:50:36.574667 [debug] [Thread-5  ]: finished collecting timing info
22:50:36.575497 [debug] [Thread-5  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:50:36.575300 [debug] [Thread-10 ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:50:36.573894 [debug] [Thread-7  ]: finished collecting timing info
22:50:36.576006 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:50:36.575815 [debug] [Thread-10 ]: finished collecting timing info
22:50:36.575617 [debug] [Thread-5  ]: finished collecting timing info
22:50:36.576803 [debug] [Thread-5  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
22:50:36.576391 [debug] [Thread-10 ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:50:36.576107 [debug] [Thread-7  ]: finished collecting timing info
22:50:36.577363 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:50:36.578724 [debug] [MainThread]: Connection 'master' was properly closed.
22:50:36.578821 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
22:50:36.578883 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
22:50:36.578945 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
22:50:36.578995 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
22:50:36.579046 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
22:50:36.579095 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
22:50:36.579145 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
22:50:36.579191 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
22:50:36.579239 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
22:50:36.579287 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
22:50:36.582984 [info ] [MainThread]: Done.
22:50:36.587937 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
22:50:36.588092 [info ] [MainThread]: Building catalog
22:50:36.589521 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
22:50:36.594557 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:50:36.594875 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
22:50:36.595006 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:50:36.602767 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:50:36.603026 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:50:36.603115 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
22:50:36.623284 [debug] [ThreadPool]: SQL status: SELECT 77 in 0.02 seconds
22:50:36.631786 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
22:50:36.632263 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
22:50:36.638629 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
22:50:36.639000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d5766e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d57661f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0d5766250>]}
22:50:37.724738 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
22:50:37.725089 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-06 22:52:38.719825 | aacbbf9d-4de4-4b15-bc3b-98439738f92c ==============================
22:52:38.719842 [info ] [MainThread]: Running with dbt=1.1.0
22:52:38.720444 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
22:52:38.720571 [debug] [MainThread]: Tracking: tracking
22:52:38.723856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27580b1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27580b1dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f27580b1430>]}
22:52:38.725539 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
22:52:38.725757 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
22:52:38.725991 [info ] [MainThread]: 
22:52:38.726170 [info ] [MainThread]: 
22:52:38.726453 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-06 23:54:23.596152 | 086b03b2-4358-417c-a09b-c3257aa3e760 ==============================
23:54:23.596167 [info ] [MainThread]: Running with dbt=1.1.0
23:54:23.597189 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
23:54:23.597301 [debug] [MainThread]: Tracking: tracking
23:54:23.604390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299b62b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299b62b4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299b62baf0>]}
23:54:23.621659 [info ] [MainThread]: Unable to do partial parsing because profile has changed
23:54:23.621941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '086b03b2-4358-417c-a09b-c3257aa3e760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299b62cb20>]}
23:54:23.640379 [debug] [MainThread]: Parsing macros/catalog.sql
23:54:23.643495 [debug] [MainThread]: Parsing macros/relations.sql
23:54:23.644461 [debug] [MainThread]: Parsing macros/adapters.sql
23:54:23.658557 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
23:54:23.659852 [debug] [MainThread]: Parsing macros/materializations/configs.sql
23:54:23.661214 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
23:54:23.667503 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
23:54:23.673624 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
23:54:23.683297 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
23:54:23.693290 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
23:54:23.695971 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
23:54:23.696866 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
23:54:23.697621 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
23:54:23.699159 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
23:54:23.700697 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
23:54:23.704743 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
23:54:23.708981 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
23:54:23.710796 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
23:54:23.720410 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
23:54:23.724071 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
23:54:23.725085 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
23:54:23.727703 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
23:54:23.728737 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
23:54:23.736289 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
23:54:23.750938 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
23:54:23.757617 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
23:54:23.758958 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
23:54:23.760475 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
23:54:23.761437 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
23:54:23.762336 [debug] [MainThread]: Parsing macros/adapters/columns.sql
23:54:23.768171 [debug] [MainThread]: Parsing macros/adapters/relation.sql
23:54:23.773698 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
23:54:23.775792 [debug] [MainThread]: Parsing macros/adapters/schema.sql
23:54:23.777494 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
23:54:23.779196 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
23:54:23.783520 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
23:54:23.786199 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
23:54:23.786742 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
23:54:23.787248 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
23:54:23.787654 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
23:54:23.788429 [debug] [MainThread]: Parsing macros/etc/datetime.sql
23:54:23.793720 [debug] [MainThread]: Parsing macros/etc/statement.sql
23:54:23.796377 [debug] [MainThread]: Parsing tests/generic/builtin.sql
23:54:23.933094 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers2.sql
23:54:23.940575 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
23:54:23.943314 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
23:54:23.945127 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
23:54:23.946553 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
23:54:23.947937 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
23:54:23.949282 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
23:54:24.016240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '086b03b2-4358-417c-a09b-c3257aa3e760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299b5bc0d0>]}
23:54:24.019890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '086b03b2-4358-417c-a09b-c3257aa3e760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299b62ba00>]}
23:54:24.020166 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
23:54:24.020328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '086b03b2-4358-417c-a09b-c3257aa3e760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299b5acd60>]}
23:54:24.021423 [info ] [MainThread]: 
23:54:24.021742 [debug] [MainThread]: Acquiring new postgres connection "master"
23:54:24.022495 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
23:54:24.028735 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:54:24.028878 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
23:54:24.028987 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:54:24.039081 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:54:24.039275 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:54:24.039395 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
23:54:24.041278 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
23:54:24.042658 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
23:54:24.042943 [debug] [ThreadPool]: On list_erp_oltp_public: Close
23:54:24.045987 [debug] [MainThread]: Using postgres connection "master"
23:54:24.046091 [debug] [MainThread]: On master: BEGIN
23:54:24.046151 [debug] [MainThread]: Opening a new connection, currently in state init
23:54:24.051100 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
23:54:24.051274 [debug] [MainThread]: Using postgres connection "master"
23:54:24.051376 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:54:24.068490 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
23:54:24.069692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '086b03b2-4358-417c-a09b-c3257aa3e760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299e27cbe0>]}
23:54:24.070003 [debug] [MainThread]: On master: ROLLBACK
23:54:24.070396 [debug] [MainThread]: On master: Close
23:54:24.070850 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
23:54:24.071007 [info ] [MainThread]: 
23:54:24.075147 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
23:54:24.075760 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
23:54:24.076041 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
23:54:24.076121 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
23:54:24.077766 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
23:54:24.078040 [debug] [Thread-1  ]: finished collecting timing info
23:54:24.078198 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
23:54:24.078295 [debug] [Thread-1  ]: finished collecting timing info
23:54:24.078681 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
23:54:24.078836 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
23:54:24.079302 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
23:54:24.079415 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
23:54:24.079527 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
23:54:24.081257 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
23:54:24.078949 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
23:54:24.084577 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
23:54:24.084761 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
23:54:24.084851 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
23:54:24.084115 [debug] [Thread-2  ]: finished collecting timing info
23:54:24.086869 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
23:54:24.086952 [debug] [Thread-2  ]: finished collecting timing info
23:54:24.087207 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
23:54:24.079059 [debug] [Thread-1  ]: Began running node model.first_project.stg_orders
23:54:24.087474 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.stg_orders"
23:54:24.087558 [debug] [Thread-1  ]: Began compiling node model.first_project.stg_orders
23:54:24.087623 [debug] [Thread-1  ]: Compiling model.first_project.stg_orders
23:54:24.088372 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.stg_orders"
23:54:24.086612 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
23:54:24.086753 [debug] [Thread-4  ]: Began running node seed.first_project.code-country
23:54:24.089202 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
23:54:24.090661 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
23:54:24.090874 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
23:54:24.089645 [debug] [Thread-3  ]: finished collecting timing info
23:54:24.091359 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
23:54:24.091495 [debug] [Thread-3  ]: finished collecting timing info
23:54:24.091072 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
23:54:24.093723 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
23:54:24.089335 [debug] [Thread-7  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:54:24.091951 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
23:54:24.089878 [debug] [Thread-1  ]: finished collecting timing info
23:54:24.094433 [debug] [Thread-1  ]: Began executing node model.first_project.stg_orders
23:54:24.089445 [debug] [Thread-8  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:54:24.094850 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:54:24.094548 [debug] [Thread-1  ]: finished collecting timing info
23:54:24.095281 [debug] [Thread-1  ]: Finished running node model.first_project.stg_orders
23:54:24.090228 [debug] [Thread-4  ]: Acquiring new postgres connection "seed.first_project.code-country"
23:54:24.094197 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:54:24.095505 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:54:24.095393 [debug] [Thread-4  ]: Began compiling node seed.first_project.code-country
23:54:24.094976 [debug] [Thread-8  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:54:24.095813 [debug] [Thread-8  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
23:54:24.095696 [debug] [Thread-4  ]: Compiling seed.first_project.code-country
23:54:24.095601 [debug] [Thread-7  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:54:24.106085 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:54:24.106245 [debug] [Thread-2  ]: Began running node model.first_project.customers2
23:54:24.101028 [debug] [Thread-10 ]: Began running node model.first_project.customers
23:54:24.106787 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
23:54:24.106481 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers2"
23:54:24.107132 [debug] [Thread-2  ]: Began compiling node model.first_project.customers2
23:54:24.099796 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:54:24.106909 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
23:54:24.107935 [debug] [Thread-10 ]: Compiling model.first_project.customers
23:54:24.107298 [debug] [Thread-2  ]: Compiling model.first_project.customers2
23:54:24.112115 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers2"
23:54:24.107724 [debug] [Thread-8  ]: finished collecting timing info
23:54:24.100586 [debug] [Thread-4  ]: Writing injected SQL for node "seed.first_project.code-country"
23:54:24.112838 [debug] [Thread-4  ]: finished collecting timing info
23:54:24.106987 [debug] [Thread-6  ]: finished collecting timing info
23:54:24.113080 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
23:54:24.112548 [debug] [Thread-2  ]: finished collecting timing info
23:54:24.113286 [debug] [Thread-2  ]: Began executing node model.first_project.customers2
23:54:24.112383 [debug] [Thread-8  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:54:24.112919 [debug] [Thread-4  ]: Began executing node seed.first_project.code-country
23:54:24.113663 [debug] [Thread-4  ]: finished collecting timing info
23:54:24.110519 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
23:54:24.113362 [debug] [Thread-2  ]: finished collecting timing info
23:54:24.112705 [debug] [Thread-7  ]: finished collecting timing info
23:54:24.114683 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:54:24.113189 [debug] [Thread-6  ]: finished collecting timing info
23:54:24.113930 [debug] [Thread-4  ]: Finished running node seed.first_project.code-country
23:54:24.114322 [debug] [Thread-2  ]: Finished running node model.first_project.customers2
23:54:24.114535 [debug] [Thread-10 ]: finished collecting timing info
23:54:24.115302 [debug] [Thread-10 ]: Began executing node model.first_project.customers
23:54:24.115393 [debug] [Thread-10 ]: finished collecting timing info
23:54:24.115622 [debug] [Thread-10 ]: Finished running node model.first_project.customers
23:54:24.114986 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
23:54:24.113539 [debug] [Thread-8  ]: finished collecting timing info
23:54:24.115883 [debug] [Thread-8  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:54:24.114759 [debug] [Thread-7  ]: finished collecting timing info
23:54:24.116259 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:54:24.116737 [debug] [Thread-9  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:54:24.116946 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
23:54:24.117042 [debug] [Thread-9  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:54:24.117126 [debug] [Thread-3  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:54:24.117597 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
23:54:24.117291 [debug] [Thread-9  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:54:24.117405 [debug] [Thread-5  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:54:24.124329 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:54:24.124574 [debug] [Thread-5  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:54:24.124677 [debug] [Thread-5  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:54:24.123957 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
23:54:24.128093 [debug] [Thread-9  ]: finished collecting timing info
23:54:24.117208 [debug] [Thread-1  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:54:24.127701 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:54:24.128705 [debug] [Thread-5  ]: finished collecting timing info
23:54:24.117677 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:54:24.129090 [debug] [Thread-3  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
23:54:24.128481 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:54:24.131591 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:54:24.131698 [debug] [Thread-1  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:54:24.133630 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:54:24.131415 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
23:54:24.128845 [debug] [Thread-5  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:54:24.133891 [debug] [Thread-5  ]: finished collecting timing info
23:54:24.134180 [debug] [Thread-5  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:54:24.117745 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:54:24.134480 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:54:24.134889 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:54:24.134620 [debug] [Thread-3  ]: finished collecting timing info
23:54:24.134808 [debug] [Thread-1  ]: finished collecting timing info
23:54:24.135261 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:54:24.135336 [debug] [Thread-1  ]: finished collecting timing info
23:54:24.135143 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:54:24.135530 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:54:24.128287 [debug] [Thread-9  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:54:24.135794 [debug] [Thread-9  ]: finished collecting timing info
23:54:24.135633 [debug] [Thread-3  ]: finished collecting timing info
23:54:24.136023 [debug] [Thread-9  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:54:24.135029 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:54:24.136288 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:54:24.139192 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:54:24.139683 [debug] [Thread-4  ]: finished collecting timing info
23:54:24.139840 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:54:24.139930 [debug] [Thread-4  ]: finished collecting timing info
23:54:24.140164 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:54:24.141563 [debug] [MainThread]: Connection 'master' was properly closed.
23:54:24.141719 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
23:54:24.141821 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
23:54:24.141922 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
23:54:24.142016 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
23:54:24.142069 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
23:54:24.142121 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
23:54:24.142173 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
23:54:24.142226 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
23:54:24.142279 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
23:54:24.142436 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
23:54:24.145732 [info ] [MainThread]: Done.
23:54:24.147164 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
23:54:24.147278 [info ] [MainThread]: Building catalog
23:54:24.148688 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
23:54:24.154570 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:54:24.154751 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
23:54:24.154812 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:54:24.163495 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:54:24.163725 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:54:24.163796 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
23:54:24.166149 [debug] [ThreadPool]: SQL status: SELECT 100 in 0.0 seconds
23:54:24.174283 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
23:54:24.175018 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
23:54:24.185650 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
23:54:24.186137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299b62b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f297874aeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299b0b39d0>]}
23:54:24.831958 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
23:54:24.832476 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-06 23:54:41.929000 | 4f12f34f-ee11-49d8-a68b-0cf9fc69efe4 ==============================
23:54:41.929016 [info ] [MainThread]: Running with dbt=1.1.0
23:54:41.929388 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
23:54:41.929486 [debug] [MainThread]: Tracking: tracking
23:54:41.932713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ee0afb760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ee0afbe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ee0afb430>]}
23:54:41.934288 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
23:54:41.934564 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
23:54:41.934694 [info ] [MainThread]: 
23:54:41.934855 [info ] [MainThread]: 
23:54:41.935096 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-06 23:57:35.936024 | c1e1b791-1e05-4613-bd4d-a136af17de02 ==============================
23:57:35.936038 [info ] [MainThread]: Running with dbt=1.1.0
23:57:35.936386 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
23:57:35.936526 [debug] [MainThread]: Tracking: tracking
23:57:35.939995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c22f7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c22f7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c22f7640>]}
23:57:35.964142 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
23:57:35.965784 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
23:57:35.966010 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/docs.md
23:57:35.977683 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
23:57:36.049684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1e1b791-1e05-4613-bd4d-a136af17de02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c3b746d0>]}
23:57:36.053655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1e1b791-1e05-4613-bd4d-a136af17de02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c227ce20>]}
23:57:36.053916 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
23:57:36.054133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1e1b791-1e05-4613-bd4d-a136af17de02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c227cf40>]}
23:57:36.055525 [info ] [MainThread]: 
23:57:36.055821 [debug] [MainThread]: Acquiring new postgres connection "master"
23:57:36.056599 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
23:57:36.063595 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:57:36.063766 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
23:57:36.063844 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:57:36.073275 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:57:36.073486 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:57:36.073606 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
23:57:36.075112 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
23:57:36.076293 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
23:57:36.076520 [debug] [ThreadPool]: On list_erp_oltp_public: Close
23:57:36.080169 [debug] [MainThread]: Using postgres connection "master"
23:57:36.080501 [debug] [MainThread]: On master: BEGIN
23:57:36.080613 [debug] [MainThread]: Opening a new connection, currently in state init
23:57:36.085580 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
23:57:36.085779 [debug] [MainThread]: Using postgres connection "master"
23:57:36.085850 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:57:36.099386 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
23:57:36.100436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1e1b791-1e05-4613-bd4d-a136af17de02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c227cb80>]}
23:57:36.100712 [debug] [MainThread]: On master: ROLLBACK
23:57:36.101054 [debug] [MainThread]: On master: Close
23:57:36.101388 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
23:57:36.101545 [info ] [MainThread]: 
23:57:36.107101 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
23:57:36.107455 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
23:57:36.107623 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
23:57:36.107727 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
23:57:36.109387 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
23:57:36.109658 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
23:57:36.109774 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
23:57:36.110289 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
23:57:36.110367 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
23:57:36.110476 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
23:57:36.111190 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
23:57:36.111426 [debug] [Thread-3  ]: finished collecting timing info
23:57:36.111549 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
23:57:36.111650 [debug] [Thread-3  ]: finished collecting timing info
23:57:36.111922 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
23:57:36.109854 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
23:57:36.112467 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
23:57:36.112700 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
23:57:36.113805 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
23:57:36.112907 [debug] [Thread-1  ]: finished collecting timing info
23:57:36.115482 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
23:57:36.115207 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
23:57:36.109915 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
23:57:36.119698 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
23:57:36.119833 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
23:57:36.119908 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
23:57:36.120815 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
23:57:36.120934 [debug] [Thread-5  ]: finished collecting timing info
23:57:36.121047 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
23:57:36.121119 [debug] [Thread-5  ]: finished collecting timing info
23:57:36.121397 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
23:57:36.115802 [debug] [Thread-4  ]: finished collecting timing info
23:57:36.121816 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
23:57:36.122833 [debug] [Thread-4  ]: finished collecting timing info
23:57:36.123286 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
23:57:36.115578 [debug] [Thread-1  ]: finished collecting timing info
23:57:36.121961 [debug] [Thread-7  ]: Began running node model.first_project.customers2
23:57:36.123988 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers2"
23:57:36.124146 [debug] [Thread-7  ]: Began compiling node model.first_project.customers2
23:57:36.123629 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
23:57:36.124255 [debug] [Thread-7  ]: Compiling model.first_project.customers2
23:57:36.110120 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
23:57:36.124646 [debug] [Thread-9  ]: Began running node model.first_project.customers
23:57:36.127683 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers"
23:57:36.127366 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
23:57:36.128139 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
23:57:36.127772 [debug] [Thread-9  ]: Began compiling node model.first_project.customers
23:57:36.128486 [debug] [Thread-9  ]: Compiling model.first_project.customers
23:57:36.127851 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:57:36.128246 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
23:57:36.131478 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
23:57:36.132803 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
23:57:36.133071 [debug] [Thread-6  ]: finished collecting timing info
23:57:36.133165 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
23:57:36.131285 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:57:36.128356 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:57:36.133725 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:57:36.133807 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:57:36.133897 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
23:57:36.133501 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:57:36.138085 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:57:36.133311 [debug] [Thread-6  ]: finished collecting timing info
23:57:36.143987 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
23:57:36.126984 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers2"
23:57:36.137814 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:57:36.130959 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers"
23:57:36.127457 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
23:57:36.143628 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:57:36.144784 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:57:36.144929 [debug] [Thread-5  ]: finished collecting timing info
23:57:36.145205 [debug] [Thread-7  ]: finished collecting timing info
23:57:36.145579 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
23:57:36.145751 [debug] [Thread-9  ]: finished collecting timing info
23:57:36.150314 [debug] [Thread-9  ]: Began executing node model.first_project.customers
23:57:36.146603 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:57:36.147014 [debug] [Thread-7  ]: Began executing node model.first_project.customers2
23:57:36.150916 [debug] [Thread-7  ]: finished collecting timing info
23:57:36.151210 [debug] [Thread-7  ]: Finished running node model.first_project.customers2
23:57:36.146879 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:57:36.145888 [debug] [Thread-1  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:57:36.150489 [debug] [Thread-9  ]: finished collecting timing info
23:57:36.152108 [debug] [Thread-9  ]: Finished running node model.first_project.customers
23:57:36.150730 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:57:36.152837 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:57:36.147252 [debug] [Thread-3  ]: finished collecting timing info
23:57:36.151750 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:57:36.151331 [debug] [Thread-5  ]: finished collecting timing info
23:57:36.155289 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:57:36.156889 [debug] [Thread-4  ]: finished collecting timing info
23:57:36.155645 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:57:36.155898 [debug] [Thread-1  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:57:36.156057 [debug] [Thread-8  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:57:36.157692 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
23:57:36.157783 [debug] [Thread-8  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:57:36.157851 [debug] [Thread-8  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:57:36.157046 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:57:36.163378 [debug] [Thread-4  ]: finished collecting timing info
23:57:36.157179 [debug] [Thread-3  ]: finished collecting timing info
23:57:36.157412 [debug] [Thread-1  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:57:36.156224 [debug] [Thread-10 ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:57:36.167137 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:57:36.167225 [debug] [Thread-10 ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:57:36.167297 [debug] [Thread-10 ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:57:36.156153 [debug] [Thread-6  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:57:36.173128 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
23:57:36.164108 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:57:36.163056 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
23:57:36.156548 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:57:36.163708 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:57:36.166884 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:57:36.149975 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
23:57:36.176445 [debug] [Thread-2  ]: finished collecting timing info
23:57:36.175040 [debug] [Thread-6  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:57:36.175456 [debug] [Thread-8  ]: finished collecting timing info
23:57:36.181408 [debug] [Thread-8  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:57:36.181553 [debug] [Thread-8  ]: finished collecting timing info
23:57:36.182064 [debug] [Thread-8  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:57:36.172880 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:57:36.182470 [debug] [Thread-10 ]: finished collecting timing info
23:57:36.182648 [debug] [Thread-10 ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:57:36.182730 [debug] [Thread-10 ]: finished collecting timing info
23:57:36.181227 [debug] [Thread-6  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
23:57:36.183013 [debug] [Thread-10 ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:57:36.180934 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
23:57:36.186014 [debug] [Thread-2  ]: finished collecting timing info
23:57:36.185772 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
23:57:36.186257 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
23:57:36.176194 [debug] [Thread-1  ]: finished collecting timing info
23:57:36.186638 [debug] [Thread-1  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:57:36.186722 [debug] [Thread-1  ]: finished collecting timing info
23:57:36.186925 [debug] [Thread-1  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:57:36.187173 [debug] [Thread-6  ]: finished collecting timing info
23:57:36.187561 [debug] [Thread-6  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:57:36.187640 [debug] [Thread-6  ]: finished collecting timing info
23:57:36.187844 [debug] [Thread-6  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:57:36.189165 [debug] [MainThread]: Connection 'master' was properly closed.
23:57:36.189301 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
23:57:36.189411 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
23:57:36.189474 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
23:57:36.189535 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
23:57:36.189591 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
23:57:36.189648 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
23:57:36.189711 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
23:57:36.189767 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
23:57:36.189822 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
23:57:36.189878 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
23:57:36.194053 [info ] [MainThread]: Done.
23:57:36.195982 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
23:57:36.196319 [info ] [MainThread]: Building catalog
23:57:36.198212 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
23:57:36.202767 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:57:36.202887 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
23:57:36.202957 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:57:36.211395 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:57:36.211603 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:57:36.211676 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
23:57:36.215635 [debug] [ThreadPool]: SQL status: SELECT 100 in 0.0 seconds
23:57:36.224964 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
23:57:36.225506 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
23:57:36.237247 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
23:57:36.238204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c22f7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c21f3eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f04c04a9e20>]}
23:57:36.926859 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
23:57:36.927406 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-06 23:57:45.757756 | 24b0193c-27df-4572-9ca2-1d39a57140c2 ==============================
23:57:45.757771 [info ] [MainThread]: Running with dbt=1.1.0
23:57:45.758188 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
23:57:45.758303 [debug] [MainThread]: Tracking: tracking
23:57:45.762376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd10640370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd10640550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd10640ee0>]}
23:57:45.764191 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
23:57:45.764438 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
23:57:45.764601 [info ] [MainThread]: 
23:57:45.764723 [info ] [MainThread]: 
23:57:45.764840 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-07 00:06:07.928058 | 1408bb56-5a5c-4792-9ed7-c054035eaa50 ==============================
00:06:07.928076 [info ] [MainThread]: Running with dbt=1.1.0
00:06:07.928662 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
00:06:07.928783 [debug] [MainThread]: Tracking: tracking
00:06:07.932821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa60d37c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa60d34c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa60d39d0>]}
00:06:07.953471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
00:06:07.953811 [debug] [MainThread]: Partial parsing: added file: first_project://models/overview.md
00:06:07.967321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1408bb56-5a5c-4792-9ed7-c054035eaa50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa5f9e0d0>]}
00:06:07.971416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1408bb56-5a5c-4792-9ed7-c054035eaa50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa6059eb0>]}
00:06:07.971680 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
00:06:07.971869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1408bb56-5a5c-4792-9ed7-c054035eaa50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa6059f40>]}
00:06:07.973031 [info ] [MainThread]: 
00:06:07.973336 [debug] [MainThread]: Acquiring new postgres connection "master"
00:06:07.974167 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:06:07.980701 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:06:07.980867 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:06:07.980943 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:06:07.986580 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:06:07.986824 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:06:07.986898 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:06:07.989506 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
00:06:07.994022 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:06:07.994619 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:06:07.999762 [debug] [MainThread]: Using postgres connection "master"
00:06:07.999944 [debug] [MainThread]: On master: BEGIN
00:06:08.000013 [debug] [MainThread]: Opening a new connection, currently in state init
00:06:08.003987 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:06:08.004144 [debug] [MainThread]: Using postgres connection "master"
00:06:08.004214 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:06:08.017113 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
00:06:08.018352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1408bb56-5a5c-4792-9ed7-c054035eaa50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa60d51c0>]}
00:06:08.018639 [debug] [MainThread]: On master: ROLLBACK
00:06:08.018940 [debug] [MainThread]: On master: Close
00:06:08.019324 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:06:08.019492 [info ] [MainThread]: 
00:06:08.024556 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:06:08.024855 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:06:08.024957 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:06:08.025081 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:06:08.027015 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:06:08.027336 [debug] [Thread-1  ]: finished collecting timing info
00:06:08.027497 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
00:06:08.028453 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:06:08.027705 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
00:06:08.027576 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
00:06:08.028123 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:06:08.028559 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:06:08.027889 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
00:06:08.069504 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
00:06:08.069609 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
00:06:08.068400 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:06:08.069121 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
00:06:08.069683 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
00:06:08.069909 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
00:06:08.068872 [debug] [Thread-1  ]: finished collecting timing info
00:06:08.071972 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:06:08.073001 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
00:06:08.074054 [debug] [Thread-5  ]: finished collecting timing info
00:06:08.073286 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
00:06:08.073771 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:06:08.074154 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
00:06:08.075428 [debug] [Thread-5  ]: finished collecting timing info
00:06:08.074367 [debug] [Thread-2  ]: finished collecting timing info
00:06:08.076313 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
00:06:08.076394 [debug] [Thread-2  ]: finished collecting timing info
00:06:08.028888 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:06:08.076091 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
00:06:08.077190 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:06:08.077284 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
00:06:08.075706 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
00:06:08.076639 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
00:06:08.075159 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:06:08.076832 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
00:06:08.077364 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
00:06:08.076252 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:06:08.076187 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:06:08.077843 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
00:06:08.079372 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:06:08.079753 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:06:08.080064 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:06:08.082138 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:06:08.082216 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:06:08.081337 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:06:08.091364 [debug] [Thread-4  ]: finished collecting timing info
00:06:08.091547 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
00:06:08.080227 [debug] [Thread-3  ]: finished collecting timing info
00:06:08.091759 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
00:06:08.092847 [debug] [Thread-3  ]: finished collecting timing info
00:06:08.081826 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:06:08.093357 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
00:06:08.082015 [debug] [Thread-7  ]: finished collecting timing info
00:06:08.098014 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
00:06:08.098307 [debug] [Thread-7  ]: finished collecting timing info
00:06:08.097519 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:06:08.091634 [debug] [Thread-4  ]: finished collecting timing info
00:06:08.098924 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
00:06:08.093172 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
00:06:08.090936 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:06:08.099770 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
00:06:08.099993 [debug] [Thread-9  ]: finished collecting timing info
00:06:08.100521 [debug] [Thread-6  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:06:08.100694 [debug] [Thread-1  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:06:08.101758 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:06:08.101394 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:06:08.101102 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:06:08.101876 [debug] [Thread-1  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:06:08.103202 [debug] [Thread-1  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:06:08.105530 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:06:08.102855 [debug] [Thread-6  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:06:08.105918 [debug] [Thread-6  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:06:08.105721 [debug] [Thread-1  ]: finished collecting timing info
00:06:08.102490 [debug] [Thread-5  ]: Began running node model.first_project.customers2
00:06:08.108641 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customers2"
00:06:08.108740 [debug] [Thread-5  ]: Began compiling node model.first_project.customers2
00:06:08.108117 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:06:08.109118 [debug] [Thread-6  ]: finished collecting timing info
00:06:08.109237 [debug] [Thread-6  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:06:08.108369 [debug] [Thread-1  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:06:08.109488 [debug] [Thread-1  ]: finished collecting timing info
00:06:08.109730 [debug] [Thread-1  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:06:08.108814 [debug] [Thread-5  ]: Compiling model.first_project.customers2
00:06:08.109353 [debug] [Thread-6  ]: finished collecting timing info
00:06:08.111865 [debug] [Thread-6  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:06:08.102949 [debug] [Thread-7  ]: Began running node model.first_project.customers
00:06:08.103107 [debug] [Thread-9  ]: finished collecting timing info
00:06:08.113284 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:06:08.111418 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customers2"
00:06:08.112966 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers"
00:06:08.113534 [debug] [Thread-7  ]: Began compiling node model.first_project.customers
00:06:08.113632 [debug] [Thread-7  ]: Compiling model.first_project.customers
00:06:08.102663 [debug] [Thread-8  ]: finished collecting timing info
00:06:08.115196 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers"
00:06:08.115427 [debug] [Thread-5  ]: finished collecting timing info
00:06:08.116090 [debug] [Thread-5  ]: Began executing node model.first_project.customers2
00:06:08.115904 [debug] [Thread-7  ]: finished collecting timing info
00:06:08.116202 [debug] [Thread-5  ]: finished collecting timing info
00:06:08.116795 [debug] [Thread-5  ]: Finished running node model.first_project.customers2
00:06:08.115595 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:06:08.116402 [debug] [Thread-7  ]: Began executing node model.first_project.customers
00:06:08.116914 [debug] [Thread-8  ]: finished collecting timing info
00:06:08.117235 [debug] [Thread-7  ]: finished collecting timing info
00:06:08.117606 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:06:08.118063 [debug] [Thread-7  ]: Finished running node model.first_project.customers
00:06:08.118785 [debug] [Thread-3  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:06:08.118983 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:06:08.119069 [debug] [Thread-3  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:06:08.119153 [debug] [Thread-3  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:06:08.124705 [debug] [Thread-4  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:06:08.125146 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:06:08.125296 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:06:08.125385 [debug] [Thread-4  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
00:06:08.125505 [debug] [Thread-2  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:06:08.135756 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:06:08.136358 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:06:08.137378 [debug] [Thread-2  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:06:08.137521 [debug] [Thread-2  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:06:08.136961 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:06:08.144365 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:06:08.145263 [debug] [Thread-4  ]: finished collecting timing info
00:06:08.145835 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:06:08.145947 [debug] [Thread-4  ]: finished collecting timing info
00:06:08.145664 [debug] [Thread-3  ]: finished collecting timing info
00:06:08.146638 [debug] [Thread-3  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:06:08.146753 [debug] [Thread-3  ]: finished collecting timing info
00:06:08.147079 [debug] [Thread-3  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:06:08.146304 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:06:08.147586 [debug] [Thread-2  ]: finished collecting timing info
00:06:08.147778 [debug] [Thread-2  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:06:08.147882 [debug] [Thread-2  ]: finished collecting timing info
00:06:08.148210 [debug] [Thread-2  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:06:08.149774 [debug] [MainThread]: Connection 'master' was properly closed.
00:06:08.149903 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:06:08.149962 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
00:06:08.150013 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
00:06:08.150060 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
00:06:08.150108 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
00:06:08.150156 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
00:06:08.150205 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
00:06:08.150253 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
00:06:08.150344 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
00:06:08.154286 [info ] [MainThread]: Done.
00:06:08.156120 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
00:06:08.156313 [info ] [MainThread]: Building catalog
00:06:08.158003 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
00:06:08.163078 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:06:08.163191 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
00:06:08.163258 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:06:08.170502 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:06:08.170709 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:06:08.170813 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
00:06:08.174102 [debug] [ThreadPool]: SQL status: SELECT 100 in 0.0 seconds
00:06:08.183713 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
00:06:08.186626 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
00:06:08.196082 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
00:06:08.196506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa7997a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa7997b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfa7997b50>]}
00:06:08.935342 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
00:06:08.935804 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-07 00:06:14.007186 | f23ca21d-d04a-4e82-a1b6-fab004c32397 ==============================
00:06:14.007202 [info ] [MainThread]: Running with dbt=1.1.0
00:06:14.008039 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
00:06:14.008162 [debug] [MainThread]: Tracking: tracking
00:06:14.011407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89e6d2370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89e6d2550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe89e6d2ee0>]}
00:06:14.013088 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
00:06:14.013341 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
00:06:14.013536 [info ] [MainThread]: 
00:06:14.013708 [info ] [MainThread]: 
00:06:14.013832 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-07 00:32:11.076093 | 254ea2c9-eba7-42a4-b760-0053f1b92cd1 ==============================
00:32:11.076109 [info ] [MainThread]: Running with dbt=1.1.0
00:32:11.076564 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:32:11.076686 [debug] [MainThread]: Tracking: tracking
00:32:11.079502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c7c8af730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c7c8afeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c7c8af6a0>]}
00:32:11.104613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:32:11.105084 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
00:32:11.112107 [debug] [MainThread]: 1603: static parser failed on erp/customers.sql
00:32:11.124200 [debug] [MainThread]: 1602: parser fallback to jinja rendering on erp/customers.sql
00:32:11.183253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '254ea2c9-eba7-42a4-b760-0053f1b92cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c7e12ad30>]}
00:32:11.188143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '254ea2c9-eba7-42a4-b760-0053f1b92cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c7c8b3820>]}
00:32:11.188441 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
00:32:11.188675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '254ea2c9-eba7-42a4-b760-0053f1b92cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c7c79e520>]}
00:32:11.189886 [info ] [MainThread]: 
00:32:11.190282 [debug] [MainThread]: Acquiring new postgres connection "master"
00:32:11.191178 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
00:32:11.198112 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
00:32:11.198277 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
00:32:11.198411 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:32:11.205282 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
00:32:11.206278 [debug] [ThreadPool]: On list_erp_oltp: Close
00:32:11.211011 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:32:11.215805 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:32:11.216000 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:32:11.216066 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:32:11.221327 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:32:11.221539 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:32:11.221648 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:32:11.223703 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
00:32:11.228137 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:32:11.228668 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:32:11.232982 [debug] [MainThread]: Using postgres connection "master"
00:32:11.233143 [debug] [MainThread]: On master: BEGIN
00:32:11.233218 [debug] [MainThread]: Opening a new connection, currently in state init
00:32:11.238472 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:32:11.238685 [debug] [MainThread]: Using postgres connection "master"
00:32:11.238762 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:32:11.253941 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
00:32:11.255168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '254ea2c9-eba7-42a4-b760-0053f1b92cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c7c8b3520>]}
00:32:11.255489 [debug] [MainThread]: On master: ROLLBACK
00:32:11.256771 [debug] [MainThread]: Using postgres connection "master"
00:32:11.256880 [debug] [MainThread]: On master: BEGIN
00:32:11.257386 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:32:11.257507 [debug] [MainThread]: On master: COMMIT
00:32:11.257612 [debug] [MainThread]: Using postgres connection "master"
00:32:11.257691 [debug] [MainThread]: On master: COMMIT
00:32:11.257917 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:32:11.258031 [debug] [MainThread]: On master: Close
00:32:11.258376 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:32:11.258560 [info ] [MainThread]: 
00:32:11.264226 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:32:11.264582 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
00:32:11.265034 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:32:11.265137 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:32:11.265216 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:32:11.266887 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:32:11.267126 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
00:32:11.267371 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
00:32:11.267785 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:32:11.268033 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:32:11.268185 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
00:32:11.269612 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:32:11.269841 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
00:32:11.270090 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
00:32:11.271141 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:32:11.271247 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
00:32:11.271327 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
00:32:11.271927 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:32:11.272159 [debug] [Thread-3  ]: finished collecting timing info
00:32:11.272308 [debug] [Thread-2  ]: finished collecting timing info
00:32:11.272559 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
00:32:11.273296 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
00:32:11.273552 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:32:11.272984 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
00:32:11.273674 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
00:32:11.286612 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
00:32:11.287697 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:32:11.288140 [debug] [Thread-4  ]: finished collecting timing info
00:32:11.288348 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
00:32:11.272671 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
00:32:11.311750 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
00:32:11.272763 [debug] [Thread-1  ]: finished collecting timing info
00:32:11.319998 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:32:11.312119 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
00:32:11.313712 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
00:32:11.319595 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
00:32:11.333079 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
00:32:11.339771 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
00:32:11.339973 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
00:32:11.341230 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
00:32:11.341316 [debug] [Thread-4  ]: Opening a new connection, currently in state init
00:32:11.341034 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
00:32:11.341500 [debug] [Thread-2  ]: Opening a new connection, currently in state init
00:32:11.340099 [debug] [Thread-3  ]: Opening a new connection, currently in state init
00:32:11.340895 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
00:32:11.343114 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
00:32:11.343282 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
00:32:11.343348 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:32:11.348568 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
00:32:11.348761 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
00:32:11.348833 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
   select
     codigo_cliente as customer_id,
     nome as first_name,
     sobrenome as last_name,
     codigo_regiao as region_code,
     estado as state
   from erp_oltp.public.clientes
)

select * from customers
  );
00:32:11.357774 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
00:32:11.362102 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
00:32:11.362265 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
00:32:11.362792 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
00:32:11.363512 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
00:32:11.363794 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
)

select * from orders
  );
00:32:11.363651 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
00:32:11.365033 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
00:32:11.364017 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:32:11.365329 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
00:32:11.365408 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
00:32:11.365165 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
00:32:11.367144 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
00:32:11.367293 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
00:32:11.363403 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
00:32:11.367923 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
00:32:11.369717 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
00:32:11.370058 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
00:32:11.369977 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
00:32:11.369868 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
00:32:11.371467 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
00:32:11.373315 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
00:32:11.373623 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
00:32:11.375555 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
00:32:11.375666 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
00:32:11.373853 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
00:32:11.373530 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
00:32:11.373738 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
00:32:11.381656 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
00:32:11.381902 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
00:32:11.383621 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
00:32:11.386968 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
00:32:11.386207 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
00:32:11.387156 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
00:32:11.386461 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
00:32:11.387942 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
00:32:11.388083 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
00:32:11.388377 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:32:11.393051 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
00:32:11.393243 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
00:32:11.393323 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
00:32:11.388472 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
00:32:11.393420 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
00:32:11.386774 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
00:32:11.393928 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
00:32:11.389294 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
00:32:11.394035 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
00:32:11.395785 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
00:32:11.396013 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
00:32:11.396289 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
00:32:11.400170 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
00:32:11.400648 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
00:32:11.400889 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
00:32:11.400297 [debug] [Thread-4  ]: SQL status: COMMIT in 0.0 seconds
00:32:11.404971 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
00:32:11.405264 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
00:32:11.402959 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
00:32:11.405727 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
00:32:11.405411 [debug] [Thread-2  ]: SQL status: COMMIT in 0.0 seconds
00:32:11.407395 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
00:32:11.407516 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
00:32:11.407685 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
00:32:11.408972 [debug] [Thread-3  ]: finished collecting timing info
00:32:11.409241 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
00:32:11.409885 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
00:32:11.410616 [debug] [Thread-2  ]: finished collecting timing info
00:32:11.409084 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
00:32:11.411630 [debug] [Thread-4  ]: finished collecting timing info
00:32:11.411740 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
00:32:11.412015 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '254ea2c9-eba7-42a4-b760-0053f1b92cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c7868beb0>]}
00:32:11.412252 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.14s]
00:32:11.412553 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
00:32:11.411001 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '254ea2c9-eba7-42a4-b760-0053f1b92cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c7c8a4610>]}
00:32:11.412851 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.14s]
00:32:11.409160 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
00:32:11.410727 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
00:32:11.413654 [debug] [Thread-1  ]: finished collecting timing info
00:32:11.414422 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
00:32:11.414194 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '254ea2c9-eba7-42a4-b760-0053f1b92cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c7c72cc70>]}
00:32:11.413823 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
00:32:11.416671 [debug] [Thread-6  ]: Began running node model.first_project.customers
00:32:11.416844 [info ] [Thread-6  ]: 5 of 7 START view model public.customers ....................................... [RUN]
00:32:11.417087 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers"
00:32:11.415956 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.15s]
00:32:11.417166 [debug] [Thread-6  ]: Began compiling node model.first_project.customers
00:32:11.417306 [debug] [Thread-7  ]: Began running node model.first_project.customers2
00:32:11.416295 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '254ea2c9-eba7-42a4-b760-0053f1b92cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c7c726130>]}
00:32:11.418132 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
00:32:11.418368 [debug] [Thread-6  ]: Compiling model.first_project.customers
00:32:11.418882 [info ] [Thread-7  ]: 6 of 7 START table model public.customers2 ..................................... [RUN]
00:32:11.419514 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.15s]
00:32:11.421889 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers"
00:32:11.422440 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers2"
00:32:11.422790 [debug] [Thread-7  ]: Began compiling node model.first_project.customers2
00:32:11.422873 [debug] [Thread-7  ]: Compiling model.first_project.customers2
00:32:11.424414 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers2"
00:32:11.424739 [debug] [Thread-7  ]: finished collecting timing info
00:32:11.424894 [debug] [Thread-7  ]: Began executing node model.first_project.customers2
00:32:11.426888 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.customers2"
00:32:11.427141 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
00:32:11.427223 [debug] [Thread-7  ]: On model.first_project.customers2: BEGIN
00:32:11.427315 [debug] [Thread-7  ]: Opening a new connection, currently in state init
00:32:11.428106 [debug] [Thread-6  ]: finished collecting timing info
00:32:11.428272 [debug] [Thread-6  ]: Began executing node model.first_project.customers
00:32:11.429677 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers"
00:32:11.429969 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
00:32:11.430056 [debug] [Thread-6  ]: On model.first_project.customers: BEGIN
00:32:11.430116 [debug] [Thread-6  ]: Opening a new connection, currently in state init
00:32:11.434849 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:32:11.435783 [debug] [Thread-7  ]: SQL status: BEGIN in 0.01 seconds
00:32:11.436239 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
00:32:11.436340 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
00:32:11.436757 [debug] [Thread-9  ]: Began running node model.first_project.my_second_dbt_model
00:32:11.436976 [info ] [Thread-9  ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
00:32:11.437356 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:32:11.437481 [debug] [Thread-9  ]: Began compiling node model.first_project.my_second_dbt_model
00:32:11.437596 [debug] [Thread-9  ]: Compiling model.first_project.my_second_dbt_model
00:32:11.442147 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:32:11.442664 [debug] [Thread-9  ]: finished collecting timing info
00:32:11.442824 [debug] [Thread-9  ]: Began executing node model.first_project.my_second_dbt_model
00:32:11.443038 [debug] [Thread-7  ]: SQL status: SELECT 100 in 0.01 seconds
00:32:11.445711 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
00:32:11.447471 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
00:32:11.447758 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
00:32:11.450891 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
00:32:11.455129 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
00:32:11.455312 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
00:32:11.455578 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
00:32:11.455716 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
00:32:11.455807 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    

with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
  WHERE customer_id != 63
)

select * from final
  );
00:32:11.455908 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
00:32:11.456910 [debug] [Thread-7  ]: On model.first_project.customers2: COMMIT
00:32:11.457004 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
00:32:11.457074 [debug] [Thread-7  ]: On model.first_project.customers2: COMMIT
00:32:11.457362 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
00:32:11.457536 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: BEGIN
00:32:11.457610 [debug] [Thread-9  ]: Opening a new connection, currently in state init
00:32:11.458730 [debug] [Thread-7  ]: SQL status: COMMIT in 0.0 seconds
00:32:11.459743 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
00:32:11.459834 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
00:32:11.460296 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
00:32:11.461869 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
00:32:11.462007 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
00:32:11.462291 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
00:32:11.463529 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
00:32:11.463668 [debug] [Thread-7  ]: SQL status: DROP TABLE in 0.0 seconds
00:32:11.463831 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
00:32:11.464716 [debug] [Thread-7  ]: finished collecting timing info
00:32:11.465046 [debug] [Thread-7  ]: On model.first_project.customers2: Close
00:32:11.465351 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
00:32:11.466208 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
00:32:11.466317 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
00:32:11.466443 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
00:32:11.466929 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '254ea2c9-eba7-42a4-b760-0053f1b92cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c7862b430>]}
00:32:11.467314 [info ] [Thread-7  ]: 6 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.04s]
00:32:11.467829 [debug] [Thread-7  ]: Finished running node model.first_project.customers2
00:32:11.468043 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
00:32:11.473094 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
00:32:11.473320 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
00:32:11.473766 [debug] [Thread-9  ]: SQL status: BEGIN in 0.02 seconds
00:32:11.473933 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
00:32:11.474013 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
00:32:11.475448 [debug] [Thread-9  ]: SQL status: CREATE VIEW in 0.0 seconds
00:32:11.477310 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
00:32:11.477676 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
00:32:11.477811 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.0 seconds
00:32:11.478960 [debug] [Thread-6  ]: finished collecting timing info
00:32:11.479086 [debug] [Thread-6  ]: On model.first_project.customers: Close
00:32:11.479174 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
00:32:11.480174 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
00:32:11.480261 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
00:32:11.480322 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
00:32:11.486733 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '254ea2c9-eba7-42a4-b760-0053f1b92cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c7c74cb50>]}
00:32:11.487586 [info ] [Thread-6  ]: 5 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.07s]
00:32:11.487983 [debug] [Thread-9  ]: SQL status: COMMIT in 0.01 seconds
00:32:11.489574 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
00:32:11.489812 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
00:32:11.490110 [debug] [Thread-6  ]: Finished running node model.first_project.customers
00:32:11.490766 [debug] [Thread-9  ]: SQL status: DROP VIEW in 0.0 seconds
00:32:11.491830 [debug] [Thread-9  ]: finished collecting timing info
00:32:11.491959 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: Close
00:32:11.492976 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '254ea2c9-eba7-42a4-b760-0053f1b92cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c78633e80>]}
00:32:11.493239 [info ] [Thread-9  ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
00:32:11.493479 [debug] [Thread-9  ]: Finished running node model.first_project.my_second_dbt_model
00:32:11.495117 [debug] [MainThread]: Acquiring new postgres connection "master"
00:32:11.495258 [debug] [MainThread]: Using postgres connection "master"
00:32:11.495326 [debug] [MainThread]: On master: BEGIN
00:32:11.495385 [debug] [MainThread]: Opening a new connection, currently in state closed
00:32:11.499278 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:32:11.499419 [debug] [MainThread]: On master: COMMIT
00:32:11.499488 [debug] [MainThread]: Using postgres connection "master"
00:32:11.499550 [debug] [MainThread]: On master: COMMIT
00:32:11.499676 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:32:11.499769 [debug] [MainThread]: On master: Close
00:32:11.500227 [info ] [MainThread]: 
00:32:11.500534 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.31s.
00:32:11.500711 [debug] [MainThread]: Connection 'master' was properly closed.
00:32:11.500813 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
00:32:11.500907 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
00:32:11.501099 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
00:32:11.501249 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
00:32:11.501376 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
00:32:11.501486 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
00:32:11.501595 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
00:32:11.506943 [info ] [MainThread]: 
00:32:11.507187 [info ] [MainThread]: [32mCompleted successfully[0m
00:32:11.507339 [info ] [MainThread]: 
00:32:11.507443 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
00:32:11.507622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c7c83bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c7c70ad90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c7e0c7a00>]}


============================== 2022-06-07 00:32:17.339744 | 847caeb0-ce7f-42e0-a313-d2b7cabba71b ==============================
00:32:17.339770 [info ] [MainThread]: Running with dbt=1.1.0
00:32:17.340617 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
00:32:17.340770 [debug] [MainThread]: Tracking: tracking
00:32:17.355206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73d7a4f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73d7a4fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73d7a4f6a0>]}
00:32:17.382769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:32:17.382969 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:32:17.389921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '847caeb0-ce7f-42e0-a313-d2b7cabba71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73d79060d0>]}
00:32:17.394063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '847caeb0-ce7f-42e0-a313-d2b7cabba71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73d79552b0>]}
00:32:17.394399 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
00:32:17.394724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '847caeb0-ce7f-42e0-a313-d2b7cabba71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73d7955190>]}
00:32:17.395999 [info ] [MainThread]: 
00:32:17.396305 [debug] [MainThread]: Acquiring new postgres connection "master"
00:32:17.397122 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:32:17.405252 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:32:17.405441 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:32:17.405550 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:32:17.413859 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:32:17.414224 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:32:17.414374 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:32:17.416711 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
00:32:17.418670 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:32:17.419226 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:32:17.422555 [debug] [MainThread]: Using postgres connection "master"
00:32:17.422708 [debug] [MainThread]: On master: BEGIN
00:32:17.422771 [debug] [MainThread]: Opening a new connection, currently in state init
00:32:17.426946 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:32:17.427099 [debug] [MainThread]: Using postgres connection "master"
00:32:17.427170 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:32:17.441387 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
00:32:17.442739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '847caeb0-ce7f-42e0-a313-d2b7cabba71b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73d79dbf10>]}
00:32:17.442995 [debug] [MainThread]: On master: ROLLBACK
00:32:17.443250 [debug] [MainThread]: On master: Close
00:32:17.443660 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:32:17.443858 [info ] [MainThread]: 
00:32:17.448255 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:32:17.448646 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:32:17.448750 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:32:17.448837 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:32:17.450893 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:32:17.451082 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
00:32:17.451822 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:32:17.452044 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:32:17.452223 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
00:32:17.453979 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:32:17.451405 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
00:32:17.451313 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
00:32:17.460444 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:32:17.459353 [debug] [Thread-1  ]: finished collecting timing info
00:32:17.460142 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
00:32:17.461106 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
00:32:17.461227 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
00:32:17.460850 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:32:17.451186 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
00:32:17.463162 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:32:17.463256 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
00:32:17.462891 [debug] [Thread-1  ]: finished collecting timing info
00:32:17.463324 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
00:32:17.460567 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
00:32:17.501924 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
00:32:17.502685 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:32:17.501445 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:32:17.501728 [debug] [Thread-2  ]: finished collecting timing info
00:32:17.462665 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
00:32:17.463644 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:32:17.503063 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
00:32:17.503205 [debug] [Thread-4  ]: finished collecting timing info
00:32:17.504162 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
00:32:17.504261 [debug] [Thread-4  ]: finished collecting timing info
00:32:17.503875 [debug] [Thread-2  ]: finished collecting timing info
00:32:17.503413 [debug] [Thread-5  ]: finished collecting timing info
00:32:17.505800 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
00:32:17.505902 [debug] [Thread-5  ]: finished collecting timing info
00:32:17.506118 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
00:32:17.504826 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:32:17.506343 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:32:17.505564 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
00:32:17.504689 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:32:17.506867 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:32:17.506959 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:32:17.507028 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:32:17.504588 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
00:32:17.506460 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:32:17.505160 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
00:32:17.503520 [debug] [Thread-3  ]: finished collecting timing info
00:32:17.516383 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:32:17.515970 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:32:17.516617 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
00:32:17.517024 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
00:32:17.522680 [debug] [Thread-3  ]: finished collecting timing info
00:32:17.517278 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
00:32:17.522973 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
00:32:17.522333 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:32:17.523188 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
00:32:17.523861 [debug] [Thread-9  ]: finished collecting timing info
00:32:17.525462 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:32:17.525597 [debug] [Thread-6  ]: Began running node model.first_project.customers
00:32:17.526249 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers"
00:32:17.525772 [debug] [Thread-1  ]: Began running node model.first_project.customers2
00:32:17.526653 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers2"
00:32:17.526754 [debug] [Thread-1  ]: Began compiling node model.first_project.customers2
00:32:17.526822 [debug] [Thread-1  ]: Compiling model.first_project.customers2
00:32:17.526394 [debug] [Thread-6  ]: Began compiling node model.first_project.customers
00:32:17.528154 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers2"
00:32:17.528807 [debug] [Thread-1  ]: finished collecting timing info
00:32:17.528931 [debug] [Thread-1  ]: Began executing node model.first_project.customers2
00:32:17.528366 [debug] [Thread-6  ]: Compiling model.first_project.customers
00:32:17.531275 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers"
00:32:17.529018 [debug] [Thread-1  ]: finished collecting timing info
00:32:17.532227 [debug] [Thread-1  ]: Finished running node model.first_project.customers2
00:32:17.525891 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:32:17.532401 [debug] [Thread-9  ]: finished collecting timing info
00:32:17.532639 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:32:17.525676 [debug] [Thread-8  ]: finished collecting timing info
00:32:17.528515 [debug] [Thread-7  ]: finished collecting timing info
00:32:17.532757 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:32:17.533110 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
00:32:17.533591 [debug] [Thread-7  ]: finished collecting timing info
00:32:17.533397 [debug] [Thread-8  ]: finished collecting timing info
00:32:17.533890 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
00:32:17.533278 [debug] [Thread-6  ]: finished collecting timing info
00:32:17.534493 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:32:17.534817 [debug] [Thread-6  ]: Began executing node model.first_project.customers
00:32:17.535109 [debug] [Thread-5  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:32:17.535302 [debug] [Thread-2  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:32:17.535814 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:32:17.536234 [debug] [Thread-5  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:32:17.536110 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:32:17.536314 [debug] [Thread-5  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:32:17.535630 [debug] [Thread-6  ]: finished collecting timing info
00:32:17.536486 [debug] [Thread-2  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:32:17.538839 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:32:17.539370 [debug] [Thread-2  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:32:17.541712 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:32:17.539627 [debug] [Thread-5  ]: finished collecting timing info
00:32:17.539260 [debug] [Thread-6  ]: Finished running node model.first_project.customers
00:32:17.542005 [debug] [Thread-2  ]: finished collecting timing info
00:32:17.542854 [debug] [Thread-5  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:32:17.543019 [debug] [Thread-2  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:32:17.543253 [debug] [Thread-5  ]: finished collecting timing info
00:32:17.543514 [debug] [Thread-2  ]: finished collecting timing info
00:32:17.544941 [debug] [Thread-2  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:32:17.543620 [debug] [Thread-3  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:32:17.543885 [debug] [Thread-10 ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:32:17.544566 [debug] [Thread-1  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:32:17.544347 [debug] [Thread-5  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:32:17.545214 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:32:17.545475 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:32:17.545813 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:32:17.546499 [debug] [Thread-1  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:32:17.546302 [debug] [Thread-10 ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:32:17.546596 [debug] [Thread-1  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:32:17.546110 [debug] [Thread-3  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:32:17.546720 [debug] [Thread-10 ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
00:32:17.553037 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:32:17.553389 [debug] [Thread-3  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:32:17.556044 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:32:17.564927 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:32:17.565584 [debug] [Thread-10 ]: finished collecting timing info
00:32:17.565782 [debug] [Thread-10 ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:32:17.565876 [debug] [Thread-10 ]: finished collecting timing info
00:32:17.566163 [debug] [Thread-10 ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:32:17.566418 [debug] [Thread-1  ]: finished collecting timing info
00:32:17.566614 [debug] [Thread-1  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:32:17.566691 [debug] [Thread-1  ]: finished collecting timing info
00:32:17.566784 [debug] [Thread-3  ]: finished collecting timing info
00:32:17.567166 [debug] [Thread-1  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:32:17.567369 [debug] [Thread-3  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:32:17.567689 [debug] [Thread-3  ]: finished collecting timing info
00:32:17.567965 [debug] [Thread-3  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:32:17.569329 [debug] [MainThread]: Connection 'master' was properly closed.
00:32:17.569419 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
00:32:17.569476 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:32:17.569530 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
00:32:17.569578 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
00:32:17.569625 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
00:32:17.569673 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
00:32:17.569720 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
00:32:17.569766 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
00:32:17.569812 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
00:32:17.569859 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
00:32:17.572835 [info ] [MainThread]: Done.
00:32:17.574361 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
00:32:17.577902 [info ] [MainThread]: Building catalog
00:32:17.579634 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
00:32:17.592033 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:32:17.592306 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
00:32:17.592439 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:32:17.597177 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
00:32:17.597399 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:32:17.597476 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
00:32:17.603050 [debug] [ThreadPool]: SQL status: SELECT 101 in 0.01 seconds
00:32:17.610054 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
00:32:17.610504 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
00:32:17.621132 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
00:32:17.622548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73b4febc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73b4febe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73b4febf40>]}
00:32:18.287167 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
00:32:18.287593 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-07 00:32:23.051163 | 249b3e83-8a81-43d9-8787-9d06d4519b4c ==============================
00:32:23.051183 [info ] [MainThread]: Running with dbt=1.1.0
00:32:23.051710 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
00:32:23.051965 [debug] [MainThread]: Tracking: tracking
00:32:23.055788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fee9e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fee9ee80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7fee9e460>]}
00:32:23.057375 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
00:32:23.057601 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
00:32:23.057750 [info ] [MainThread]: 
00:32:23.057853 [info ] [MainThread]: 
00:32:23.058107 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-07 00:36:13.850202 | cd1ff9ef-d01c-43d5-ab08-01247d0d6b27 ==============================
00:36:13.850218 [info ] [MainThread]: Running with dbt=1.1.0
00:36:13.850649 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:36:13.850756 [debug] [MainThread]: Tracking: tracking
00:36:13.860595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bbc51760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bbc51490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bbc51100>]}
00:36:13.883386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:36:13.883787 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
00:36:13.896193 [debug] [MainThread]: 1603: static parser failed on erp/customers.sql
00:36:13.908540 [debug] [MainThread]: 1602: parser fallback to jinja rendering on erp/customers.sql
00:36:13.968482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd1ff9ef-d01c-43d5-ab08-01247d0d6b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bd4c2d60>]}
00:36:13.973035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd1ff9ef-d01c-43d5-ab08-01247d0d6b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bbb8f550>]}
00:36:13.973399 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
00:36:13.973631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd1ff9ef-d01c-43d5-ab08-01247d0d6b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bbb36550>]}
00:36:13.974904 [info ] [MainThread]: 
00:36:13.975285 [debug] [MainThread]: Acquiring new postgres connection "master"
00:36:13.976127 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
00:36:13.983673 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
00:36:13.983857 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
00:36:13.983957 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:36:13.990685 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
00:36:13.991803 [debug] [ThreadPool]: On list_erp_oltp: Close
00:36:13.996725 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:36:14.007866 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:36:14.008127 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:36:14.008211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:36:14.012499 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
00:36:14.012699 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:36:14.012772 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:36:14.014471 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
00:36:14.015675 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:36:14.015879 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:36:14.018805 [debug] [MainThread]: Using postgres connection "master"
00:36:14.018913 [debug] [MainThread]: On master: BEGIN
00:36:14.019027 [debug] [MainThread]: Opening a new connection, currently in state init
00:36:14.024205 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:36:14.024498 [debug] [MainThread]: Using postgres connection "master"
00:36:14.024604 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:36:14.040215 [debug] [MainThread]: SQL status: SELECT 7 in 0.02 seconds
00:36:14.041276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd1ff9ef-d01c-43d5-ab08-01247d0d6b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bbbcae20>]}
00:36:14.041533 [debug] [MainThread]: On master: ROLLBACK
00:36:14.042618 [debug] [MainThread]: Using postgres connection "master"
00:36:14.042715 [debug] [MainThread]: On master: BEGIN
00:36:14.042889 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:36:14.042975 [debug] [MainThread]: On master: COMMIT
00:36:14.043037 [debug] [MainThread]: Using postgres connection "master"
00:36:14.043089 [debug] [MainThread]: On master: COMMIT
00:36:14.043200 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:36:14.043292 [debug] [MainThread]: On master: Close
00:36:14.043648 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:36:14.043859 [info ] [MainThread]: 
00:36:14.049190 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:36:14.049404 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
00:36:14.049675 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
00:36:14.050609 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:36:14.050751 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:36:14.050078 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
00:36:14.049913 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
00:36:14.051382 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
00:36:14.051671 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:36:14.051185 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:36:14.051850 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:36:14.051931 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
00:36:14.049832 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
00:36:14.054205 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
00:36:14.051757 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
00:36:14.054707 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
00:36:14.050847 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:36:14.057360 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:36:14.056026 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:36:14.054615 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:36:14.053943 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:36:14.057698 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
00:36:14.057870 [debug] [Thread-4  ]: finished collecting timing info
00:36:14.058181 [debug] [Thread-1  ]: finished collecting timing info
00:36:14.058286 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
00:36:14.058419 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
00:36:14.058525 [debug] [Thread-2  ]: finished collecting timing info
00:36:14.059441 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:36:14.082385 [debug] [Thread-3  ]: finished collecting timing info
00:36:14.077661 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
00:36:14.084299 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
00:36:14.082569 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
00:36:14.081800 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
00:36:14.086082 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
00:36:14.058744 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:36:14.086552 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
00:36:14.092942 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
00:36:14.093075 [debug] [Thread-2  ]: Opening a new connection, currently in state init
00:36:14.087109 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
00:36:14.105258 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
00:36:14.105673 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
00:36:14.106535 [debug] [Thread-4  ]: Opening a new connection, currently in state init
00:36:14.105894 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
00:36:14.107711 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
00:36:14.107582 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
00:36:14.107787 [debug] [Thread-3  ]: Opening a new connection, currently in state init
00:36:14.106007 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
00:36:14.108282 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
00:36:14.108360 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
 select * from "erp_oltp"."public"."clientes"
),
final as (
 select * from source_customers
)
select * from final
  );
00:36:14.107895 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
00:36:14.108627 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:36:14.110355 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
00:36:14.118864 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
00:36:14.119194 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
00:36:14.120218 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
00:36:14.124185 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
00:36:14.125654 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
00:36:14.125821 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
00:36:14.125959 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
00:36:14.126547 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
00:36:14.126763 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
00:36:14.126157 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
00:36:14.126927 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
00:36:14.127026 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
)

select * from orders
  );
00:36:14.126286 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
00:36:14.127174 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
   select
     codigo_cliente as customer_id,
     nome as first_name,
     sobrenome as last_name,
     codigo_regiao as region_code,
     estado as state
   from erp_oltp.public.clientes
)

select * from customers
  );
00:36:14.127297 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
00:36:14.127929 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
00:36:14.132927 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
00:36:14.133200 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
00:36:14.138277 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
00:36:14.135203 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
00:36:14.133307 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
00:36:14.141306 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
00:36:14.141411 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
00:36:14.139284 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
00:36:14.139005 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
00:36:14.141953 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
00:36:14.143119 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
00:36:14.143245 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
00:36:14.144665 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
00:36:14.144783 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
00:36:14.143356 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
00:36:14.145613 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
00:36:14.144972 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:36:14.146864 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
00:36:14.148607 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
00:36:14.148680 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
00:36:14.135594 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
00:36:14.148430 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
00:36:14.148790 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
00:36:14.147076 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
00:36:14.148906 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
00:36:14.149731 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
00:36:14.149957 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
00:36:14.150047 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
00:36:14.150220 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:36:14.155533 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
00:36:14.155781 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
00:36:14.155897 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
00:36:14.159955 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
00:36:14.156076 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
00:36:14.155972 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
00:36:14.161068 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
00:36:14.161160 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
00:36:14.160181 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
00:36:14.160056 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
00:36:14.159078 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
00:36:14.162886 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
00:36:14.163461 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.0 seconds
00:36:14.165427 [debug] [Thread-2  ]: finished collecting timing info
00:36:14.165898 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
00:36:14.165708 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
00:36:14.167321 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
00:36:14.165575 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
00:36:14.167421 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
00:36:14.167808 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd1ff9ef-d01c-43d5-ab08-01247d0d6b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bbb2e940>]}
00:36:14.169948 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.12s]
00:36:14.168608 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
00:36:14.171510 [debug] [Thread-3  ]: finished collecting timing info
00:36:14.168520 [debug] [Thread-4  ]: finished collecting timing info
00:36:14.172277 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
00:36:14.172913 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
00:36:14.173724 [debug] [Thread-1  ]: finished collecting timing info
00:36:14.174134 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd1ff9ef-d01c-43d5-ab08-01247d0d6b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bbb2e790>]}
00:36:14.174714 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.12s]
00:36:14.175025 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
00:36:14.172176 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
00:36:14.174413 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
00:36:14.175576 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd1ff9ef-d01c-43d5-ab08-01247d0d6b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bbc4d0a0>]}
00:36:14.175864 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.13s]
00:36:14.176117 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:36:14.176421 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
00:36:14.176609 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
00:36:14.176906 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:36:14.176993 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
00:36:14.177072 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
00:36:14.172059 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
00:36:14.178740 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:36:14.179044 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd1ff9ef-d01c-43d5-ab08-01247d0d6b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bbb61670>]}
00:36:14.179602 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.12s]
00:36:14.179874 [debug] [Thread-6  ]: finished collecting timing info
00:36:14.180059 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
00:36:14.180202 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
00:36:14.180648 [debug] [Thread-8  ]: Began running node model.first_project.customers
00:36:14.183817 [info ] [Thread-8  ]: 6 of 7 START view model public.customers ....................................... [RUN]
00:36:14.184113 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
00:36:14.184241 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
00:36:14.184330 [debug] [Thread-8  ]: Compiling model.first_project.customers
00:36:14.183604 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
00:36:14.180741 [debug] [Thread-9  ]: Began running node model.first_project.customers2
00:36:14.191004 [info ] [Thread-9  ]: 7 of 7 START table model public.customers2 ..................................... [RUN]
00:36:14.187190 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
00:36:14.191535 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers2"
00:36:14.192881 [debug] [Thread-9  ]: Began compiling node model.first_project.customers2
00:36:14.191727 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
00:36:14.193007 [debug] [Thread-9  ]: Compiling model.first_project.customers2
00:36:14.186772 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
00:36:14.195665 [debug] [Thread-8  ]: finished collecting timing info
00:36:14.195776 [debug] [Thread-8  ]: Began executing node model.first_project.customers
00:36:14.195322 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers2"
00:36:14.200251 [debug] [Thread-9  ]: finished collecting timing info
00:36:14.200392 [debug] [Thread-9  ]: Began executing node model.first_project.customers2
00:36:14.199864 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
00:36:14.193136 [debug] [Thread-6  ]: Opening a new connection, currently in state init
00:36:14.203657 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.customers2"
00:36:14.205131 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
00:36:14.208047 [debug] [Thread-9  ]: On model.first_project.customers2: BEGIN
00:36:14.208234 [debug] [Thread-9  ]: Opening a new connection, currently in state init
00:36:14.208534 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
00:36:14.209421 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
00:36:14.209556 [debug] [Thread-8  ]: Opening a new connection, currently in state init
00:36:14.217200 [debug] [Thread-9  ]: SQL status: BEGIN in 0.01 seconds
00:36:14.217492 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
00:36:14.217608 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select
   numero_pedidos as order_id,
   codigo_cliente as customer_id,
   data_pedido as order_date
 from erp_oltp.public.pedidos
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  from customers
  left join customer_orders using (customer_id)
)

select * from final
  );
00:36:14.218089 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
00:36:14.218259 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
00:36:14.218359 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
00:36:14.218588 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
00:36:14.218690 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
00:36:14.218753 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    


with customers as (
 select * from "erp_oltp"."public"."stg_customers"
),
orders as (
 select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
 select
   customer_id,
   min(order_date) as first_order_date,
   max(order_date) as most_recent_order_date,
   count(order_id) as number_of_orders
 from orders
 group by 1
),
final as (
  select
    customers.customer_id,
    
    customers.first_name,
    
    customers.last_name,
    
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
  from customers
  left join customer_orders using (customer_id)
  WHERE customer_id != 63
)

select * from final
  );
00:36:14.219594 [debug] [Thread-9  ]: SQL status: SELECT 100 in 0.0 seconds
00:36:14.223383 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
00:36:14.223564 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
00:36:14.223724 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
00:36:14.225330 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
00:36:14.225616 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
00:36:14.225448 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.01 seconds
00:36:14.226864 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
00:36:14.226955 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
00:36:14.227163 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
00:36:14.228252 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
00:36:14.228351 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
00:36:14.228618 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
00:36:14.229706 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
00:36:14.229832 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
00:36:14.229953 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
00:36:14.228433 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
00:36:14.230122 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
00:36:14.231343 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
00:36:14.233520 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
00:36:14.233738 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
00:36:14.234233 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
00:36:14.234124 [debug] [Thread-6  ]: SQL status: COMMIT in 0.0 seconds
00:36:14.234001 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
00:36:14.235523 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
00:36:14.235711 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
00:36:14.235947 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
00:36:14.236643 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
00:36:14.238245 [debug] [Thread-6  ]: finished collecting timing info
00:36:14.238377 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
00:36:14.238810 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd1ff9ef-d01c-43d5-ab08-01247d0d6b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bbb2ed00>]}
00:36:14.239079 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
00:36:14.239394 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
00:36:14.240603 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
00:36:14.240708 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
00:36:14.240945 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
00:36:14.241725 [debug] [Thread-8  ]: finished collecting timing info
00:36:14.241844 [debug] [Thread-8  ]: On model.first_project.customers: Close
00:36:14.242125 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd1ff9ef-d01c-43d5-ab08-01247d0d6b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bbb2e5e0>]}
00:36:14.242328 [info ] [Thread-8  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.06s]
00:36:14.242837 [debug] [Thread-9  ]: SQL status: COMMIT in 0.01 seconds
00:36:14.243968 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
00:36:14.244230 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
00:36:14.244431 [debug] [Thread-8  ]: Finished running node model.first_project.customers
00:36:14.244537 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
00:36:14.247201 [debug] [Thread-9  ]: SQL status: DROP TABLE in 0.0 seconds
00:36:14.248117 [debug] [Thread-9  ]: finished collecting timing info
00:36:14.248256 [debug] [Thread-9  ]: On model.first_project.customers2: Close
00:36:14.248620 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd1ff9ef-d01c-43d5-ab08-01247d0d6b27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5b815cdc0>]}
00:36:14.254576 [info ] [Thread-9  ]: 7 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.06s]
00:36:14.255347 [debug] [Thread-9  ]: Finished running node model.first_project.customers2
00:36:14.256925 [debug] [MainThread]: Acquiring new postgres connection "master"
00:36:14.257077 [debug] [MainThread]: Using postgres connection "master"
00:36:14.257186 [debug] [MainThread]: On master: BEGIN
00:36:14.257275 [debug] [MainThread]: Opening a new connection, currently in state closed
00:36:14.263639 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:36:14.263920 [debug] [MainThread]: On master: COMMIT
00:36:14.264023 [debug] [MainThread]: Using postgres connection "master"
00:36:14.264132 [debug] [MainThread]: On master: COMMIT
00:36:14.264415 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:36:14.264545 [debug] [MainThread]: On master: Close
00:36:14.264980 [info ] [MainThread]: 
00:36:14.267060 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.29s.
00:36:14.267295 [debug] [MainThread]: Connection 'master' was properly closed.
00:36:14.267362 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
00:36:14.267414 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
00:36:14.267464 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
00:36:14.267513 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
00:36:14.267579 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
00:36:14.267651 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
00:36:14.267710 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
00:36:14.273323 [info ] [MainThread]: 
00:36:14.273697 [info ] [MainThread]: [32mCompleted successfully[0m
00:36:14.273995 [info ] [MainThread]: 
00:36:14.274242 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
00:36:14.274604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bbb4de20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bbc4a7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5bd45ea60>]}


============================== 2022-06-07 00:36:19.222838 | c0be3504-7101-4b30-b4c3-9a6e35710dc5 ==============================
00:36:19.222859 [info ] [MainThread]: Running with dbt=1.1.0
00:36:19.223415 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
00:36:19.223548 [debug] [MainThread]: Tracking: tracking
00:36:19.227150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc22bab9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc22bab9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc22bab96a0>]}
00:36:19.259744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:36:19.259963 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:36:19.266467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0be3504-7101-4b30-b4c3-9a6e35710dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc22b96f0d0>]}
00:36:19.271788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0be3504-7101-4b30-b4c3-9a6e35710dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc22b9bf2e0>]}
00:36:19.272190 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
00:36:19.272388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0be3504-7101-4b30-b4c3-9a6e35710dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc22b9bf1c0>]}
00:36:19.273779 [info ] [MainThread]: 
00:36:19.274242 [debug] [MainThread]: Acquiring new postgres connection "master"
00:36:19.275230 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:36:19.287916 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:36:19.288162 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:36:19.288296 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:36:19.294617 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:36:19.294823 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:36:19.294899 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:36:19.296466 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
00:36:19.297886 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:36:19.298281 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:36:19.301540 [debug] [MainThread]: Using postgres connection "master"
00:36:19.301686 [debug] [MainThread]: On master: BEGIN
00:36:19.301754 [debug] [MainThread]: Opening a new connection, currently in state init
00:36:19.311799 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:36:19.312038 [debug] [MainThread]: Using postgres connection "master"
00:36:19.312316 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:36:19.326889 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
00:36:19.328069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0be3504-7101-4b30-b4c3-9a6e35710dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc22ba45f40>]}
00:36:19.328327 [debug] [MainThread]: On master: ROLLBACK
00:36:19.328583 [debug] [MainThread]: On master: Close
00:36:19.328917 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:36:19.329077 [info ] [MainThread]: 
00:36:19.333717 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:36:19.334138 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:36:19.334278 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:36:19.334427 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:36:19.338170 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:36:19.338484 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
00:36:19.339145 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:36:19.339271 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:36:19.339348 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
00:36:19.340987 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:36:19.338640 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
00:36:19.347114 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:36:19.347295 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
00:36:19.347379 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
00:36:19.348886 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:36:19.338572 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
00:36:19.349475 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:36:19.349591 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
00:36:19.349707 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
00:36:19.338709 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
00:36:19.394558 [debug] [Thread-4  ]: finished collecting timing info
00:36:19.396147 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
00:36:19.395558 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
00:36:19.396400 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
00:36:19.396481 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
00:36:19.396274 [debug] [Thread-4  ]: finished collecting timing info
00:36:19.397597 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
00:36:19.395141 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:36:19.396010 [debug] [Thread-1  ]: finished collecting timing info
00:36:19.397832 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:36:19.397919 [debug] [Thread-1  ]: finished collecting timing info
00:36:19.398137 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:36:19.395898 [debug] [Thread-2  ]: finished collecting timing info
00:36:19.398351 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
00:36:19.398476 [debug] [Thread-2  ]: finished collecting timing info
00:36:19.398673 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
00:36:19.397148 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
00:36:19.398930 [debug] [Thread-5  ]: finished collecting timing info
00:36:19.399015 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
00:36:19.399079 [debug] [Thread-5  ]: finished collecting timing info
00:36:19.399172 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
00:36:19.399880 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:36:19.399976 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
00:36:19.399601 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
00:36:19.399398 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:36:19.400439 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:36:19.400532 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:36:19.400599 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
00:36:19.399303 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:36:19.409308 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:36:19.408423 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:36:19.409517 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:36:19.410016 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:36:19.409677 [debug] [Thread-3  ]: finished collecting timing info
00:36:19.400043 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
00:36:19.410163 [debug] [Thread-9  ]: finished collecting timing info
00:36:19.416475 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:36:19.416767 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
00:36:19.418227 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:36:19.418492 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:36:19.419182 [debug] [Thread-9  ]: finished collecting timing info
00:36:19.419659 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:36:19.418871 [debug] [Thread-3  ]: finished collecting timing info
00:36:19.420021 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
00:36:19.420434 [debug] [Thread-6  ]: Began running node model.first_project.customers
00:36:19.420616 [debug] [Thread-7  ]: finished collecting timing info
00:36:19.420791 [debug] [Thread-4  ]: Began running node model.first_project.customers2
00:36:19.421579 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.customers2"
00:36:19.421322 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
00:36:19.421818 [debug] [Thread-7  ]: finished collecting timing info
00:36:19.421698 [debug] [Thread-4  ]: Began compiling node model.first_project.customers2
00:36:19.422248 [debug] [Thread-4  ]: Compiling model.first_project.customers2
00:36:19.422091 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
00:36:19.421180 [debug] [Thread-8  ]: finished collecting timing info
00:36:19.423927 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.customers2"
00:36:19.421036 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers"
00:36:19.424351 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:36:19.424826 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:36:19.424997 [debug] [Thread-10 ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:36:19.426116 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:36:19.426205 [debug] [Thread-10 ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:36:19.425832 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:36:19.426442 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:36:19.426274 [debug] [Thread-10 ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:36:19.428860 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:36:19.429102 [debug] [Thread-10 ]: finished collecting timing info
00:36:19.429399 [debug] [Thread-10 ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:36:19.429527 [debug] [Thread-10 ]: finished collecting timing info
00:36:19.425139 [debug] [Thread-6  ]: Began compiling node model.first_project.customers
00:36:19.429837 [debug] [Thread-6  ]: Compiling model.first_project.customers
00:36:19.426562 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:36:19.434219 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:36:19.425574 [debug] [Thread-8  ]: finished collecting timing info
00:36:19.429746 [debug] [Thread-10 ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:36:19.431910 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers"
00:36:19.425350 [debug] [Thread-4  ]: finished collecting timing info
00:36:19.434775 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:36:19.435071 [debug] [Thread-2  ]: finished collecting timing info
00:36:19.440186 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:36:19.439234 [debug] [Thread-6  ]: finished collecting timing info
00:36:19.440356 [debug] [Thread-2  ]: finished collecting timing info
00:36:19.441164 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:36:19.439670 [debug] [Thread-4  ]: Began executing node model.first_project.customers2
00:36:19.440563 [debug] [Thread-6  ]: Began executing node model.first_project.customers
00:36:19.441380 [debug] [Thread-4  ]: finished collecting timing info
00:36:19.441535 [debug] [Thread-6  ]: finished collecting timing info
00:36:19.441965 [debug] [Thread-4  ]: Finished running node model.first_project.customers2
00:36:19.442279 [debug] [Thread-6  ]: Finished running node model.first_project.customers
00:36:19.443017 [debug] [Thread-9  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:36:19.443208 [debug] [Thread-3  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:36:19.443301 [debug] [Thread-1  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:36:19.443772 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:36:19.444294 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:36:19.444055 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:36:19.444462 [debug] [Thread-3  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
00:36:19.447505 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:36:19.444614 [debug] [Thread-1  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:36:19.443573 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:36:19.447784 [debug] [Thread-1  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:36:19.448052 [debug] [Thread-9  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:36:19.453712 [debug] [Thread-9  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:36:19.453320 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:36:19.448145 [debug] [Thread-3  ]: finished collecting timing info
00:36:19.463481 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:36:19.463620 [debug] [Thread-3  ]: finished collecting timing info
00:36:19.464019 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:36:19.463209 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:36:19.464370 [debug] [Thread-1  ]: finished collecting timing info
00:36:19.464589 [debug] [Thread-1  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:36:19.464694 [debug] [Thread-1  ]: finished collecting timing info
00:36:19.464974 [debug] [Thread-1  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:36:19.466043 [debug] [Thread-9  ]: finished collecting timing info
00:36:19.466164 [debug] [Thread-9  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:36:19.466249 [debug] [Thread-9  ]: finished collecting timing info
00:36:19.466553 [debug] [Thread-9  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:36:19.467533 [debug] [MainThread]: Connection 'master' was properly closed.
00:36:19.467623 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
00:36:19.467681 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
00:36:19.467732 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
00:36:19.467782 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
00:36:19.467830 [debug] [MainThread]: Connection 'seed.first_project.code-country' was properly closed.
00:36:19.467878 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
00:36:19.467926 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
00:36:19.467974 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
00:36:19.468020 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
00:36:19.468067 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:36:19.471601 [info ] [MainThread]: Done.
00:36:19.474328 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
00:36:19.474556 [info ] [MainThread]: Building catalog
00:36:19.476002 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
00:36:19.480448 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:36:19.480560 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
00:36:19.480625 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:36:19.485047 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
00:36:19.485244 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:36:19.485359 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
00:36:19.487957 [debug] [ThreadPool]: SQL status: SELECT 101 in 0.0 seconds
00:36:19.501376 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
00:36:19.501803 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
00:36:19.518467 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
00:36:19.519195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc22b9d4e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc22b9d4a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc22b9d4df0>]}
00:36:20.215804 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
00:36:20.216206 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-07 00:36:25.012186 | 5d8cf755-8b1a-4a41-a538-0ac5c05c5207 ==============================
00:36:25.012201 [info ] [MainThread]: Running with dbt=1.1.0
00:36:25.012851 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
00:36:25.013004 [debug] [MainThread]: Tracking: tracking
00:36:25.016831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfe01c7c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfe01c7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdfe01c7130>]}
00:36:25.018518 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
00:36:25.018828 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
00:36:25.019364 [info ] [MainThread]: 
00:36:25.019540 [info ] [MainThread]: 
00:36:25.019758 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-07 00:41:34.799714 | d72ccb63-4e10-408e-ac61-f731ab31a810 ==============================
00:41:34.799731 [info ] [MainThread]: Running with dbt=1.1.0
00:41:34.800170 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
00:41:34.800259 [debug] [MainThread]: Tracking: tracking
00:41:34.803369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b81d67850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b81d67b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b81d67640>]}
00:41:34.822984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:41:34.823423 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
00:41:34.831011 [debug] [MainThread]: 1603: static parser failed on erp/customers.sql
00:41:34.842156 [debug] [MainThread]: 1602: parser fallback to jinja rendering on erp/customers.sql
00:41:34.905065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd72ccb63-4e10-408e-ac61-f731ab31a810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b835e36d0>]}
00:41:34.908622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd72ccb63-4e10-408e-ac61-f731ab31a810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b81d6c190>]}
00:41:34.908838 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
00:41:34.908990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd72ccb63-4e10-408e-ac61-f731ab31a810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b81c584c0>]}
00:41:34.910004 [info ] [MainThread]: 
00:41:34.910289 [debug] [MainThread]: Acquiring new postgres connection "master"
00:41:34.911102 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:41:34.919183 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:41:34.920309 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:41:34.920421 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:41:34.926070 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:41:34.926271 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:41:34.926370 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:41:34.927869 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
00:41:34.929206 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:41:34.929827 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:41:34.934414 [debug] [MainThread]: Using postgres connection "master"
00:41:34.934683 [debug] [MainThread]: On master: BEGIN
00:41:34.934819 [debug] [MainThread]: Opening a new connection, currently in state init
00:41:34.939750 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:41:34.939950 [debug] [MainThread]: Using postgres connection "master"
00:41:34.940022 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:41:34.954288 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
00:41:34.955432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd72ccb63-4e10-408e-ac61-f731ab31a810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b81cecdc0>]}
00:41:34.955678 [debug] [MainThread]: On master: ROLLBACK
00:41:34.955879 [debug] [MainThread]: On master: Close
00:41:34.956283 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:41:34.956606 [info ] [MainThread]: 
00:41:34.961938 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:41:34.962679 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:41:34.962888 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
00:41:34.963191 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:41:34.964364 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:41:34.963514 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
00:41:34.970828 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:41:34.970969 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
00:41:34.971050 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
00:41:34.971888 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:41:34.972157 [debug] [Thread-4  ]: finished collecting timing info
00:41:34.972292 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
00:41:34.972497 [debug] [Thread-4  ]: finished collecting timing info
00:41:34.972818 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
00:41:34.964083 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:41:34.973202 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:41:34.973281 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
00:41:34.963622 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
00:41:34.975547 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
00:41:34.975827 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
00:41:34.975002 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:41:34.963378 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
00:41:34.967269 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:41:34.975979 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
00:41:34.976665 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:41:34.978352 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
00:41:34.979243 [debug] [Thread-5  ]: finished collecting timing info
00:41:34.978961 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
00:41:34.979446 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
00:41:34.979342 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
00:41:34.980427 [debug] [Thread-5  ]: finished collecting timing info
00:41:34.980189 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:41:34.980981 [debug] [Thread-3  ]: finished collecting timing info
00:41:34.980742 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
00:41:34.978806 [debug] [Thread-1  ]: finished collecting timing info
00:41:34.981080 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
00:41:34.981424 [debug] [Thread-3  ]: finished collecting timing info
00:41:34.981243 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:41:34.979042 [debug] [Thread-2  ]: finished collecting timing info
00:41:34.982120 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
00:41:34.981926 [debug] [Thread-1  ]: finished collecting timing info
00:41:34.981707 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
00:41:34.983644 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:41:34.982961 [debug] [Thread-2  ]: finished collecting timing info
00:41:34.984321 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
00:41:34.985280 [debug] [Thread-7  ]: Began running node model.first_project.customers
00:41:34.985582 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers"
00:41:34.985673 [debug] [Thread-7  ]: Began compiling node model.first_project.customers
00:41:34.985746 [debug] [Thread-7  ]: Compiling model.first_project.customers
00:41:34.988014 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers"
00:41:34.988253 [debug] [Thread-8  ]: Began running node model.first_project.customers2
00:41:34.988568 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers2"
00:41:34.988695 [debug] [Thread-8  ]: Began compiling node model.first_project.customers2
00:41:34.988831 [debug] [Thread-8  ]: Compiling model.first_project.customers2
00:41:34.990919 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers2"
00:41:34.991283 [debug] [Thread-9  ]: Began running node model.first_project.my_second_dbt_model
00:41:34.991621 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:41:34.991739 [debug] [Thread-9  ]: Began compiling node model.first_project.my_second_dbt_model
00:41:34.991826 [debug] [Thread-9  ]: Compiling model.first_project.my_second_dbt_model
00:41:34.993738 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:41:34.994041 [debug] [Thread-10 ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:41:34.994384 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:41:34.994514 [debug] [Thread-10 ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:41:34.994610 [debug] [Thread-10 ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:41:35.000224 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:41:35.000616 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:41:35.000733 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:41:35.000831 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
00:41:35.005615 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:41:35.006158 [debug] [Thread-8  ]: finished collecting timing info
00:41:35.006320 [debug] [Thread-8  ]: Began executing node model.first_project.customers2
00:41:35.006468 [debug] [Thread-8  ]: finished collecting timing info
00:41:35.006785 [debug] [Thread-8  ]: Finished running node model.first_project.customers2
00:41:35.006947 [debug] [Thread-9  ]: finished collecting timing info
00:41:35.007089 [debug] [Thread-9  ]: Began executing node model.first_project.my_second_dbt_model
00:41:35.007179 [debug] [Thread-9  ]: finished collecting timing info
00:41:35.007417 [debug] [Thread-9  ]: Finished running node model.first_project.my_second_dbt_model
00:41:35.007511 [debug] [Thread-7  ]: finished collecting timing info
00:41:35.007582 [debug] [Thread-7  ]: Began executing node model.first_project.customers
00:41:35.007676 [debug] [Thread-6  ]: finished collecting timing info
00:41:35.008212 [debug] [Thread-5  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:41:35.009009 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:41:35.009122 [debug] [Thread-5  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:41:35.009192 [debug] [Thread-5  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:41:35.008707 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:41:35.008303 [debug] [Thread-3  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:41:35.011885 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:41:35.011999 [debug] [Thread-3  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:41:35.012067 [debug] [Thread-3  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:41:35.011583 [debug] [Thread-6  ]: finished collecting timing info
00:41:35.008074 [debug] [Thread-7  ]: finished collecting timing info
00:41:35.015156 [debug] [Thread-7  ]: Finished running node model.first_project.customers
00:41:35.014243 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:41:35.011344 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:41:35.014773 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:41:35.008516 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:41:35.015624 [debug] [Thread-2  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:41:35.016019 [debug] [Thread-4  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:41:35.017668 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:41:35.017859 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:41:35.017294 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:41:35.016154 [debug] [Thread-8  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:41:35.018765 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:41:35.018884 [debug] [Thread-8  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:41:35.018984 [debug] [Thread-8  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:41:35.018422 [debug] [Thread-2  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:41:35.018008 [debug] [Thread-4  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
00:41:35.016378 [debug] [Thread-3  ]: finished collecting timing info
00:41:35.018184 [debug] [Thread-5  ]: finished collecting timing info
00:41:35.024371 [debug] [Thread-10 ]: finished collecting timing info
00:41:35.024527 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:41:35.024698 [debug] [Thread-2  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:41:35.026914 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:41:35.027161 [debug] [Thread-3  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:41:35.027333 [debug] [Thread-5  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:41:35.027543 [debug] [Thread-10 ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:41:35.037088 [debug] [Thread-10 ]: finished collecting timing info
00:41:35.037402 [debug] [Thread-10 ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:41:35.033466 [debug] [Thread-3  ]: finished collecting timing info
00:41:35.036923 [debug] [Thread-5  ]: finished collecting timing info
00:41:35.037963 [debug] [Thread-5  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:41:35.036759 [debug] [Thread-4  ]: finished collecting timing info
00:41:35.038082 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:41:35.038171 [debug] [Thread-4  ]: finished collecting timing info
00:41:35.037660 [debug] [Thread-3  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:41:35.036519 [debug] [Thread-8  ]: finished collecting timing info
00:41:35.038698 [debug] [Thread-8  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:41:35.038426 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:41:35.038786 [debug] [Thread-8  ]: finished collecting timing info
00:41:35.039166 [debug] [Thread-8  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:41:35.036234 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:41:35.039474 [debug] [Thread-2  ]: finished collecting timing info
00:41:35.039566 [debug] [Thread-2  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:41:35.039693 [debug] [Thread-2  ]: finished collecting timing info
00:41:35.039873 [debug] [Thread-2  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:41:35.040919 [debug] [MainThread]: Connection 'master' was properly closed.
00:41:35.041017 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
00:41:35.041080 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
00:41:35.041152 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
00:41:35.041206 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
00:41:35.041257 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:41:35.041308 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
00:41:35.041359 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
00:41:35.041430 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
00:41:35.041488 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
00:41:35.041538 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
00:41:35.045114 [info ] [MainThread]: Done.
00:41:35.045517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b8353e6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b83c0bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b83c0bdf0>]}


============================== 2022-06-07 00:41:44.202070 | a09364a3-e0c6-4821-9e3c-c1b4b55c7406 ==============================
00:41:44.202085 [info ] [MainThread]: Running with dbt=1.1.0
00:41:44.202515 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
00:41:44.202627 [debug] [MainThread]: Tracking: tracking
00:41:44.205780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d7da4760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d7da4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d7da46a0>]}
00:41:44.227932 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:41:44.228154 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:41:44.237767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a09364a3-e0c6-4821-9e3c-c1b4b55c7406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d7c5a0d0>]}
00:41:44.242482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a09364a3-e0c6-4821-9e3c-c1b4b55c7406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d7caa2b0>]}
00:41:44.242867 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
00:41:44.243061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a09364a3-e0c6-4821-9e3c-c1b4b55c7406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d7caa190>]}
00:41:44.244589 [info ] [MainThread]: 
00:41:44.244926 [debug] [MainThread]: Acquiring new postgres connection "master"
00:41:44.245810 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:41:44.254523 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:41:44.254728 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:41:44.254805 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:41:44.262840 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:41:44.263070 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:41:44.263162 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:41:44.264912 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
00:41:44.270405 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:41:44.271111 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:41:44.276224 [debug] [MainThread]: Using postgres connection "master"
00:41:44.276487 [debug] [MainThread]: On master: BEGIN
00:41:44.276570 [debug] [MainThread]: Opening a new connection, currently in state init
00:41:44.281381 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:41:44.281572 [debug] [MainThread]: Using postgres connection "master"
00:41:44.281644 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:41:44.297392 [debug] [MainThread]: SQL status: SELECT 7 in 0.02 seconds
00:41:44.298527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a09364a3-e0c6-4821-9e3c-c1b4b55c7406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d7d30f10>]}
00:41:44.298882 [debug] [MainThread]: On master: ROLLBACK
00:41:44.299087 [debug] [MainThread]: On master: Close
00:41:44.299627 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:41:44.299915 [info ] [MainThread]: 
00:41:44.309603 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:41:44.309962 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:41:44.310088 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:41:44.310218 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:41:44.311951 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:41:44.312135 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
00:41:44.312902 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
00:41:44.314234 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:41:44.314394 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
00:41:44.313913 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:41:44.313003 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
00:41:44.314849 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:41:44.314934 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
00:41:44.314603 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:41:44.313116 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
00:41:44.315506 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
00:41:44.315607 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
00:41:44.315696 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
00:41:44.315184 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
00:41:44.316807 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
00:41:44.314998 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
00:41:44.314489 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
00:41:44.401770 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:41:44.319641 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:41:44.319853 [debug] [Thread-5  ]: finished collecting timing info
00:41:44.402619 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
00:41:44.402748 [debug] [Thread-5  ]: finished collecting timing info
00:41:44.403127 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
00:41:44.315077 [debug] [Thread-1  ]: finished collecting timing info
00:41:44.403293 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:41:44.403423 [debug] [Thread-1  ]: finished collecting timing info
00:41:44.403767 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:41:44.402260 [debug] [Thread-3  ]: finished collecting timing info
00:41:44.403962 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
00:41:44.404108 [debug] [Thread-3  ]: finished collecting timing info
00:41:44.404531 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
00:41:44.404780 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
00:41:44.405252 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:41:44.405368 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
00:41:44.405461 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
00:41:44.407106 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:41:44.407315 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:41:44.407521 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:41:44.407614 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:41:44.407690 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:41:44.413671 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:41:44.413868 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:41:44.419680 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:41:44.419792 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:41:44.419893 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
00:41:44.418695 [debug] [Thread-6  ]: Began running node model.first_project.customers2
00:41:44.418339 [debug] [Thread-2  ]: finished collecting timing info
00:41:44.426115 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
00:41:44.426239 [debug] [Thread-2  ]: finished collecting timing info
00:41:44.426603 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
00:41:44.425902 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
00:41:44.418968 [debug] [Thread-7  ]: finished collecting timing info
00:41:44.427159 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
00:41:44.427325 [debug] [Thread-7  ]: finished collecting timing info
00:41:44.426905 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
00:41:44.428521 [debug] [Thread-6  ]: Compiling model.first_project.customers2
00:41:44.430158 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
00:41:44.434597 [debug] [Thread-6  ]: finished collecting timing info
00:41:44.434871 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
00:41:44.434966 [debug] [Thread-6  ]: finished collecting timing info
00:41:44.435358 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
00:41:44.427650 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
00:41:44.435765 [debug] [Thread-1  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:41:44.436006 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:41:44.436107 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:41:44.436178 [debug] [Thread-1  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:41:44.438574 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:41:44.438814 [debug] [Thread-1  ]: finished collecting timing info
00:41:44.438954 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:41:44.439048 [debug] [Thread-1  ]: finished collecting timing info
00:41:44.439258 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:41:44.425487 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:41:44.439356 [debug] [Thread-1  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:41:44.439642 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:41:44.439732 [debug] [Thread-1  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:41:44.439801 [debug] [Thread-1  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:41:44.441753 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:41:44.442020 [debug] [Thread-1  ]: finished collecting timing info
00:41:44.417673 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:41:44.442583 [debug] [Thread-8  ]: finished collecting timing info
00:41:44.442761 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:41:44.442868 [debug] [Thread-8  ]: finished collecting timing info
00:41:44.443146 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:41:44.442278 [debug] [Thread-9  ]: finished collecting timing info
00:41:44.444612 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:41:44.444718 [debug] [Thread-9  ]: finished collecting timing info
00:41:44.442147 [debug] [Thread-1  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:41:44.446108 [debug] [Thread-1  ]: finished collecting timing info
00:41:44.446383 [debug] [Thread-1  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:41:44.445226 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:41:44.428396 [debug] [Thread-4  ]: finished collecting timing info
00:41:44.447820 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
00:41:44.447942 [debug] [Thread-4  ]: finished collecting timing info
00:41:44.448215 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
00:41:44.450031 [debug] [Thread-10 ]: Began running node model.first_project.customers
00:41:44.450563 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
00:41:44.450711 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
00:41:44.450810 [debug] [Thread-10 ]: Compiling model.first_project.customers
00:41:44.454290 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
00:41:44.454815 [debug] [Thread-10 ]: finished collecting timing info
00:41:44.454998 [debug] [Thread-10 ]: Began executing node model.first_project.customers
00:41:44.455088 [debug] [Thread-10 ]: finished collecting timing info
00:41:44.455484 [debug] [Thread-10 ]: Finished running node model.first_project.customers
00:41:44.455970 [debug] [Thread-2  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:41:44.456192 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:41:44.456274 [debug] [Thread-2  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:41:44.456343 [debug] [Thread-2  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:41:44.463698 [debug] [Thread-7  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:41:44.463985 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:41:44.464087 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:41:44.464164 [debug] [Thread-7  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
00:41:44.466804 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:41:44.467067 [debug] [Thread-6  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:41:44.467380 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:41:44.467499 [debug] [Thread-6  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:41:44.467592 [debug] [Thread-6  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:41:44.474147 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:41:44.474491 [debug] [Thread-7  ]: finished collecting timing info
00:41:44.474801 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:41:44.474897 [debug] [Thread-7  ]: finished collecting timing info
00:41:44.475176 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:41:44.475368 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:41:44.475568 [debug] [Thread-2  ]: finished collecting timing info
00:41:44.475670 [debug] [Thread-2  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:41:44.475757 [debug] [Thread-2  ]: finished collecting timing info
00:41:44.476222 [debug] [Thread-2  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:41:44.476377 [debug] [Thread-6  ]: finished collecting timing info
00:41:44.476632 [debug] [Thread-6  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:41:44.476724 [debug] [Thread-6  ]: finished collecting timing info
00:41:44.476968 [debug] [Thread-6  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:41:44.478795 [debug] [MainThread]: Connection 'master' was properly closed.
00:41:44.478908 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:41:44.478969 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
00:41:44.479028 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
00:41:44.479077 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
00:41:44.479127 [debug] [MainThread]: Connection 'seed.first_project.code-country' was properly closed.
00:41:44.479175 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
00:41:44.479225 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
00:41:44.479273 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
00:41:44.479321 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
00:41:44.479369 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
00:41:44.482845 [info ] [MainThread]: Done.
00:41:44.485417 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
00:41:44.485712 [info ] [MainThread]: Building catalog
00:41:44.487334 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
00:41:44.491940 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:41:44.492941 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
00:41:44.493045 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:41:44.497902 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
00:41:44.498072 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:41:44.498145 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
00:41:44.500755 [debug] [ThreadPool]: SQL status: SELECT 101 in 0.0 seconds
00:41:44.513425 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
00:41:44.514008 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
00:41:44.522254 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
00:41:44.522794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d435c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d9c5ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f51d9f05f70>]}
00:41:45.186284 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
00:41:45.186791 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-07 00:41:52.490328 | 2c402ee0-b12c-4f27-8290-89a245fd73bc ==============================
00:41:52.490371 [info ] [MainThread]: Running with dbt=1.1.0
00:41:52.490807 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
00:41:52.490929 [debug] [MainThread]: Tracking: tracking
00:41:52.495211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f851e4a5760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f851e4a5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f851e4a5430>]}
00:41:52.496914 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
00:41:52.497148 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
00:41:52.497278 [info ] [MainThread]: 
00:41:52.497390 [info ] [MainThread]: 
00:41:52.497553 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-07 00:47:29.627512 | 10397d58-d7cb-4833-81a3-1e175c86146a ==============================
00:47:29.627528 [info ] [MainThread]: Running with dbt=1.1.0
00:47:29.628071 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
00:47:29.628337 [debug] [MainThread]: Tracking: tracking
00:47:29.631369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d357f730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d357feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d357f6a0>]}
00:47:29.652980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:47:29.653360 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
00:47:29.662351 [debug] [MainThread]: 1603: static parser failed on erp/customers.sql
00:47:29.672965 [debug] [MainThread]: 1602: parser fallback to jinja rendering on erp/customers.sql
00:47:29.731477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10397d58-d7cb-4833-81a3-1e175c86146a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d4dfad30>]}
00:47:29.735560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '10397d58-d7cb-4833-81a3-1e175c86146a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d3583820>]}
00:47:29.735907 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
00:47:29.736149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10397d58-d7cb-4833-81a3-1e175c86146a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d346f520>]}
00:47:29.737256 [info ] [MainThread]: 
00:47:29.737604 [debug] [MainThread]: Acquiring new postgres connection "master"
00:47:29.738640 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:47:29.747807 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:47:29.748008 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:47:29.748083 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:47:29.755894 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:47:29.756112 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:47:29.756189 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:47:29.757876 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
00:47:29.759417 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:47:29.759938 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:47:29.764224 [debug] [MainThread]: Using postgres connection "master"
00:47:29.764447 [debug] [MainThread]: On master: BEGIN
00:47:29.764522 [debug] [MainThread]: Opening a new connection, currently in state init
00:47:29.772325 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:47:29.772563 [debug] [MainThread]: Using postgres connection "master"
00:47:29.772649 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:47:29.785888 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
00:47:29.787075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '10397d58-d7cb-4833-81a3-1e175c86146a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d35834f0>]}
00:47:29.787318 [debug] [MainThread]: On master: ROLLBACK
00:47:29.787619 [debug] [MainThread]: On master: Close
00:47:29.787968 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:47:29.788193 [info ] [MainThread]: 
00:47:29.795004 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:47:29.795728 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:47:29.795908 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:47:29.796005 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:47:29.797698 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:47:29.797979 [debug] [Thread-1  ]: finished collecting timing info
00:47:29.798149 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:47:29.798255 [debug] [Thread-1  ]: finished collecting timing info
00:47:29.798672 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:47:29.798784 [debug] [Thread-1  ]: Began running node model.first_project.postgres_sample_source_customers
00:47:29.798996 [debug] [Thread-2  ]: Began running node model.first_project.stg_customers
00:47:29.799369 [debug] [Thread-3  ]: Began running node model.first_project.stg_orders
00:47:29.800291 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:47:29.800378 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_orders
00:47:29.800445 [debug] [Thread-3  ]: Compiling model.first_project.stg_orders
00:47:29.801153 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:47:29.801367 [debug] [Thread-3  ]: finished collecting timing info
00:47:29.800030 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:47:29.801499 [debug] [Thread-3  ]: Began executing node model.first_project.stg_orders
00:47:29.801810 [debug] [Thread-3  ]: finished collecting timing info
00:47:29.802180 [debug] [Thread-3  ]: Finished running node model.first_project.stg_orders
00:47:29.799722 [debug] [Thread-8  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:47:29.802966 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:47:29.803060 [debug] [Thread-8  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:47:29.801616 [debug] [Thread-2  ]: Began compiling node model.first_project.stg_customers
00:47:29.803128 [debug] [Thread-8  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
00:47:29.799659 [debug] [Thread-7  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:47:29.799440 [debug] [Thread-4  ]: Began running node seed.first_project.code-country
00:47:29.799589 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
00:47:29.813555 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:47:29.803230 [debug] [Thread-2  ]: Compiling model.first_project.stg_customers
00:47:29.812033 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:47:29.813047 [debug] [Thread-4  ]: Acquiring new postgres connection "seed.first_project.code-country"
00:47:29.813697 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
00:47:29.816503 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
00:47:29.814811 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:47:29.818160 [debug] [Thread-2  ]: finished collecting timing info
00:47:29.816112 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:47:29.816329 [debug] [Thread-4  ]: Began compiling node seed.first_project.code-country
00:47:29.817744 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:47:29.818955 [debug] [Thread-6  ]: finished collecting timing info
00:47:29.818363 [debug] [Thread-2  ]: Began executing node model.first_project.stg_customers
00:47:29.819257 [debug] [Thread-2  ]: finished collecting timing info
00:47:29.818531 [debug] [Thread-7  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:47:29.818723 [debug] [Thread-4  ]: Compiling seed.first_project.code-country
00:47:29.819089 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
00:47:29.827168 [debug] [Thread-6  ]: finished collecting timing info
00:47:29.819684 [debug] [Thread-2  ]: Finished running node model.first_project.stg_customers
00:47:29.815900 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:47:29.826150 [debug] [Thread-4  ]: Writing injected SQL for node "seed.first_project.code-country"
00:47:29.828525 [debug] [Thread-4  ]: finished collecting timing info
00:47:29.828635 [debug] [Thread-4  ]: Began executing node seed.first_project.code-country
00:47:29.827537 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
00:47:29.827968 [debug] [Thread-10 ]: Began running node model.first_project.customers
00:47:29.829085 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
00:47:29.828723 [debug] [Thread-4  ]: finished collecting timing info
00:47:29.829478 [debug] [Thread-4  ]: Finished running node seed.first_project.code-country
00:47:29.799268 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:47:29.829180 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
00:47:29.829839 [debug] [Thread-10 ]: Compiling model.first_project.customers
00:47:29.829596 [debug] [Thread-1  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:47:29.832564 [debug] [Thread-1  ]: Compiling model.first_project.postgres_sample_source_customers
00:47:29.832035 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
00:47:29.828100 [debug] [Thread-5  ]: Began running node model.first_project.customers2
00:47:29.834670 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customers2"
00:47:29.832340 [debug] [Thread-2  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:47:29.835160 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:47:29.835281 [debug] [Thread-2  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:47:29.835370 [debug] [Thread-2  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:47:29.834765 [debug] [Thread-5  ]: Began compiling node model.first_project.customers2
00:47:29.837597 [debug] [Thread-5  ]: Compiling model.first_project.customers2
00:47:29.837380 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:47:29.839873 [debug] [Thread-2  ]: finished collecting timing info
00:47:29.840025 [debug] [Thread-2  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:47:29.840126 [debug] [Thread-2  ]: finished collecting timing info
00:47:29.832161 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:47:29.838970 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customers2"
00:47:29.839544 [debug] [Thread-10 ]: finished collecting timing info
00:47:29.840972 [debug] [Thread-10 ]: Began executing node model.first_project.customers
00:47:29.841077 [debug] [Thread-10 ]: finished collecting timing info
00:47:29.841289 [debug] [Thread-10 ]: Finished running node model.first_project.customers
00:47:29.840535 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:47:29.841396 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:47:29.841465 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:47:29.840769 [debug] [Thread-5  ]: finished collecting timing info
00:47:29.843766 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:47:29.840363 [debug] [Thread-2  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:47:29.844820 [debug] [Thread-2  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:47:29.845084 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:47:29.845202 [debug] [Thread-2  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:47:29.844167 [debug] [Thread-5  ]: Began executing node model.first_project.customers2
00:47:29.845831 [debug] [Thread-5  ]: finished collecting timing info
00:47:29.844448 [debug] [Thread-4  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:47:29.846931 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:47:29.847020 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:47:29.847086 [debug] [Thread-4  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
00:47:29.849389 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:47:29.844315 [debug] [Thread-6  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:47:29.826888 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:47:29.846630 [debug] [Thread-5  ]: Finished running node model.first_project.customers2
00:47:29.834205 [debug] [Thread-8  ]: finished collecting timing info
00:47:29.833978 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:47:29.850741 [debug] [Thread-1  ]: finished collecting timing info
00:47:29.850855 [debug] [Thread-1  ]: Began executing node model.first_project.postgres_sample_source_customers
00:47:29.849693 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:47:29.850003 [debug] [Thread-7  ]: finished collecting timing info
00:47:29.851316 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:47:29.850439 [debug] [Thread-8  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:47:29.850941 [debug] [Thread-1  ]: finished collecting timing info
00:47:29.852022 [debug] [Thread-1  ]: Finished running node model.first_project.postgres_sample_source_customers
00:47:29.846154 [debug] [Thread-3  ]: finished collecting timing info
00:47:29.852323 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:47:29.852437 [debug] [Thread-3  ]: finished collecting timing info
00:47:29.852710 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:47:29.851591 [debug] [Thread-8  ]: finished collecting timing info
00:47:29.845288 [debug] [Thread-2  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:47:29.851415 [debug] [Thread-7  ]: finished collecting timing info
00:47:29.858458 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:47:29.851107 [debug] [Thread-6  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:47:29.858690 [debug] [Thread-6  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:47:29.850131 [debug] [Thread-4  ]: finished collecting timing info
00:47:29.858144 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:47:29.853091 [debug] [Thread-8  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:47:29.865347 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:47:29.865701 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:47:29.866210 [debug] [Thread-2  ]: finished collecting timing info
00:47:29.866474 [debug] [Thread-4  ]: finished collecting timing info
00:47:29.866662 [debug] [Thread-2  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:47:29.867106 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:47:29.867189 [debug] [Thread-6  ]: finished collecting timing info
00:47:29.867327 [debug] [Thread-2  ]: finished collecting timing info
00:47:29.867557 [debug] [Thread-6  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:47:29.867911 [debug] [Thread-2  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:47:29.868089 [debug] [Thread-6  ]: finished collecting timing info
00:47:29.868619 [debug] [Thread-6  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:47:29.869712 [debug] [MainThread]: Connection 'master' was properly closed.
00:47:29.869806 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
00:47:29.869863 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
00:47:29.869914 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
00:47:29.869962 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
00:47:29.870009 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
00:47:29.870057 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
00:47:29.870103 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
00:47:29.870171 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
00:47:29.870220 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
00:47:29.873809 [info ] [MainThread]: Done.
00:47:29.874186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d033d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d033d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6d0346dc0>]}


============================== 2022-06-07 00:47:35.367149 | b5407a81-13bb-4382-aa0f-f070c6a03d55 ==============================
00:47:35.367166 [info ] [MainThread]: Running with dbt=1.1.0
00:47:35.367536 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
00:47:35.367628 [debug] [MainThread]: Tracking: tracking
00:47:35.393096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccd3c5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccd3c5eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccd3c56a0>]}
00:47:35.435738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:47:35.435907 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:47:35.440212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5407a81-13bb-4382-aa0f-f070c6a03d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccd27b0d0>]}
00:47:35.444647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5407a81-13bb-4382-aa0f-f070c6a03d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccd2cb2e0>]}
00:47:35.445008 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
00:47:35.445288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5407a81-13bb-4382-aa0f-f070c6a03d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccd2cb1c0>]}
00:47:35.446924 [info ] [MainThread]: 
00:47:35.447275 [debug] [MainThread]: Acquiring new postgres connection "master"
00:47:35.448407 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:47:35.456588 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:47:35.456767 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:47:35.456844 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:47:35.466662 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:47:35.466978 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:47:35.467079 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:47:35.468671 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.0 seconds
00:47:35.469873 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:47:35.470158 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:47:35.474263 [debug] [MainThread]: Using postgres connection "master"
00:47:35.474488 [debug] [MainThread]: On master: BEGIN
00:47:35.474565 [debug] [MainThread]: Opening a new connection, currently in state init
00:47:35.483376 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:47:35.483615 [debug] [MainThread]: Using postgres connection "master"
00:47:35.483694 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:47:35.496700 [debug] [MainThread]: SQL status: SELECT 7 in 0.01 seconds
00:47:35.497791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5407a81-13bb-4382-aa0f-f070c6a03d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccd351f40>]}
00:47:35.498069 [debug] [MainThread]: On master: ROLLBACK
00:47:35.498391 [debug] [MainThread]: On master: Close
00:47:35.498765 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:47:35.498952 [info ] [MainThread]: 
00:47:35.505706 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:47:35.506138 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:47:35.506257 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:47:35.506340 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:47:35.506496 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
00:47:35.508294 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
00:47:35.508981 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:47:35.509081 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
00:47:35.509152 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
00:47:35.508650 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:47:35.509777 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:47:35.510182 [debug] [Thread-3  ]: finished collecting timing info
00:47:35.510384 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
00:47:35.510565 [debug] [Thread-3  ]: finished collecting timing info
00:47:35.509896 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:47:35.511597 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
00:47:35.508438 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
00:47:35.514875 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
00:47:35.514989 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
00:47:35.515070 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
00:47:35.514521 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:47:35.508371 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
00:47:35.511064 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
00:47:35.508151 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:47:35.547576 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:47:35.549142 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
00:47:35.548779 [debug] [Thread-2  ]: finished collecting timing info
00:47:35.548960 [debug] [Thread-1  ]: finished collecting timing info
00:47:35.549739 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:47:35.549817 [debug] [Thread-1  ]: finished collecting timing info
00:47:35.549402 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
00:47:35.549573 [debug] [Thread-7  ]: Began running node model.first_project.customers2
00:47:35.550504 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers2"
00:47:35.550615 [debug] [Thread-7  ]: Began compiling node model.first_project.customers2
00:47:35.550708 [debug] [Thread-7  ]: Compiling model.first_project.customers2
00:47:35.550220 [debug] [Thread-2  ]: finished collecting timing info
00:47:35.552280 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers2"
00:47:35.549223 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
00:47:35.554104 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:47:35.550058 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:47:35.553197 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
00:47:35.554359 [debug] [Thread-4  ]: finished collecting timing info
00:47:35.555423 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
00:47:35.555554 [debug] [Thread-4  ]: finished collecting timing info
00:47:35.555025 [debug] [Thread-7  ]: finished collecting timing info
00:47:35.556063 [debug] [Thread-7  ]: Began executing node model.first_project.customers2
00:47:35.556171 [debug] [Thread-7  ]: finished collecting timing info
00:47:35.555844 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
00:47:35.554851 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
00:47:35.556704 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:47:35.556792 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
00:47:35.555191 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:47:35.557119 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:47:35.556425 [debug] [Thread-7  ]: Finished running node model.first_project.customers2
00:47:35.557220 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:47:35.556860 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
00:47:35.558843 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:47:35.548271 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
00:47:35.555264 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:47:35.559009 [debug] [Thread-3  ]: Began running node model.first_project.customers
00:47:35.559764 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.customers"
00:47:35.559837 [debug] [Thread-3  ]: Began compiling node model.first_project.customers
00:47:35.559239 [debug] [Thread-10 ]: finished collecting timing info
00:47:35.560010 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
00:47:35.559899 [debug] [Thread-3  ]: Compiling model.first_project.customers
00:47:35.562580 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.customers"
00:47:35.563048 [debug] [Thread-3  ]: finished collecting timing info
00:47:35.563240 [debug] [Thread-3  ]: Began executing node model.first_project.customers
00:47:35.559406 [debug] [Thread-5  ]: finished collecting timing info
00:47:35.560107 [debug] [Thread-10 ]: finished collecting timing info
00:47:35.563622 [debug] [Thread-3  ]: finished collecting timing info
00:47:35.564438 [debug] [Thread-3  ]: Finished running node model.first_project.customers
00:47:35.557319 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:47:35.564174 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
00:47:35.572916 [debug] [Thread-10 ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:47:35.573255 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:47:35.572535 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:47:35.563836 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
00:47:35.573355 [debug] [Thread-10 ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:47:35.574111 [debug] [Thread-10 ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:47:35.573577 [debug] [Thread-1  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:47:35.573817 [debug] [Thread-6  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:47:35.580374 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:47:35.580669 [debug] [Thread-6  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:47:35.580760 [debug] [Thread-6  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:47:35.579593 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:47:35.586822 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:47:35.586933 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:47:35.573926 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:47:35.574029 [debug] [Thread-5  ]: finished collecting timing info
00:47:35.592084 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
00:47:35.587006 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:47:35.579993 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:47:35.596832 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:47:35.590645 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:47:35.591664 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:47:35.597549 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:47:35.597644 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:47:35.596433 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:47:35.559621 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:47:35.596958 [debug] [Thread-1  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
00:47:35.599983 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:47:35.586407 [debug] [Thread-2  ]: finished collecting timing info
00:47:35.604273 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:47:35.604423 [debug] [Thread-2  ]: finished collecting timing info
00:47:35.600486 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:47:35.604864 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
00:47:35.603873 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:47:35.600315 [debug] [Thread-7  ]: finished collecting timing info
00:47:35.604676 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:47:35.607965 [debug] [Thread-1  ]: finished collecting timing info
00:47:35.608083 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:47:35.607036 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:47:35.607291 [debug] [Thread-4  ]: finished collecting timing info
00:47:35.608402 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:47:35.608208 [debug] [Thread-1  ]: finished collecting timing info
00:47:35.608827 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:47:35.600586 [debug] [Thread-10 ]: finished collecting timing info
00:47:35.608504 [debug] [Thread-4  ]: finished collecting timing info
00:47:35.609359 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:47:35.591386 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:47:35.609818 [debug] [Thread-6  ]: finished collecting timing info
00:47:35.609471 [debug] [Thread-9  ]: finished collecting timing info
00:47:35.610102 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:47:35.609914 [debug] [Thread-6  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:47:35.610467 [debug] [Thread-6  ]: finished collecting timing info
00:47:35.610202 [debug] [Thread-9  ]: finished collecting timing info
00:47:35.611117 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:47:35.607585 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:47:35.609013 [debug] [Thread-10 ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:47:35.611547 [debug] [Thread-10 ]: finished collecting timing info
00:47:35.611298 [debug] [Thread-7  ]: finished collecting timing info
00:47:35.611863 [debug] [Thread-10 ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:47:35.610771 [debug] [Thread-6  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:47:35.614178 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:47:35.615852 [debug] [MainThread]: Connection 'master' was properly closed.
00:47:35.615945 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
00:47:35.616003 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
00:47:35.616055 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
00:47:35.616105 [debug] [MainThread]: Connection 'seed.first_project.code-country' was properly closed.
00:47:35.616155 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
00:47:35.616204 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:47:35.616252 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
00:47:35.616301 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
00:47:35.616348 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
00:47:35.619455 [info ] [MainThread]: Done.
00:47:35.621067 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
00:47:35.621213 [info ] [MainThread]: Building catalog
00:47:35.623235 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
00:47:35.627516 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:47:35.627880 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
00:47:35.627954 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:47:35.633762 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:47:35.633955 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:47:35.634069 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
00:47:35.636466 [debug] [ThreadPool]: SQL status: SELECT 101 in 0.0 seconds
00:47:35.648429 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
00:47:35.648850 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
00:47:35.660458 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
00:47:35.661102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccd3c5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccd2ab040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ccd2abb50>]}
00:47:36.412934 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
00:47:36.413504 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-07 00:47:40.724743 | 191f4a80-92e5-40d2-9977-d01b510175aa ==============================
00:47:40.724758 [info ] [MainThread]: Running with dbt=1.1.0
00:47:40.725145 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
00:47:40.725241 [debug] [MainThread]: Tracking: tracking
00:47:40.728782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0840b73370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0840b733a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0840b73ee0>]}
00:47:40.731155 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
00:47:40.731465 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
00:47:40.731579 [info ] [MainThread]: 
00:47:40.731686 [info ] [MainThread]: 
00:47:40.731820 [info ] [MainThread]: Press Ctrl+C to exit.
